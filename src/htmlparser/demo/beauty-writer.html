<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>KISSY Html Beautifier</title>
</head>
<body>
<script src="../../../build/kissy.js"></script>
<label>前：
    <textarea id="before" style="width:80%;height: 300px;">
        <div id="name">
            <!--测试 comment-->
            <span>test</span>
        </div>
    </textarea>
</label>
<br/>
<button id="start">beautify</button>
<br/>
<label>后：
    <textarea id="after" style="width:80%;height: 300px;"></textarea>
</label>
<script>

    KISSY.Config.base = "../../";

    KISSY.use("htmlparser", function(S, HtmlParser) {
        var $ = S.all;
        var start = $("#start");
        start.on("click", function() {
            var writer = new HtmlParser.BeautifyWriter(),
                    filter = new HtmlParser.Filter(),
                    before = S.trim($("#before").val()),
                    nodes = new HtmlParser.Parser(before).parse();

            filter.addRules({
                tags:{
                    $:function(el) {
                        console.log(el.tagName);
                    }
                },
                texts:function(v) {
                    console.log(v);
                },
                comments:function(v) {
                    console.log(v);
                }
            });

            S.each(nodes, function(n) {
                debugger
                n.writeHtml(writer, filter);
            });

            $("#after").val(writer.getHtml());
        });
    });
</script>
</body>
</html>