<?xml version="1.0"?>
<!--
build file for kissy sync
@author yiminghe@gmail.com
-->
<project name="kissy-sync"
         default="sync"
         xmlns:ac="antlib:net.sf.antcontrib">

    <target name="sync">
        <input addproperty="git.commit.message">
            git commit message :
        </input>
        <ac:if>

            <not>
                <equals arg1="${git.commit.message}" arg2="">
                </equals>
            </not>

            <ac:then>

                <exec executable="cmd"
                      failonerror="true">
                    <arg line="/c git add ."/>
                </exec>
                <exec executable="cmd" failonerror="true">
                    <arg line="/c git commit -am '${git.commit.message}'"/>
                </exec>


                <exec executable="cmd" failonerror="true">
                    <arg line="/c git push ${git.origin} ${git.master}:${git.master}"/>
                </exec>

                <exec executable="cmd" failonerror="true">
                    <arg line="/c git push ${git.remote} ${git.master}:${git.master}"/>
                </exec>

                <!--push master to gh-pages also-->
                <exec executable="cmd" failonerror="true">
                    <arg line="/c git push ${git.origin} ${git.master}:${git.gh-pages}"/>
                </exec>

                <exec executable="cmd" failonerror="true">
                    <arg line="/c git push ${git.remote} ${git.master}:${git.gh-pages}"/>
                </exec>

            </ac:then>
        </ac:if>
    </target>
</project>