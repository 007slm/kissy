<?xml version="1.0"?>
<!--
    extract-dependency
    @author yiminghe@gmail.com
-->
<project name="extract-dependency.build" default="build" basedir=".">
    <description>KISSY extract-dependency Build File</description>

    <import file="../common.xml"/>

    <target name="build">
        <java classname="com.taobao.f2e.ExtractDependency">
            <arg value="-baseUrls"/>
            <arg value="${kissy.src.dir}"/>

            <arg value="-encodings"/>
            <arg value="${charset}"/>

            <arg value="-includeReg"/>
            <!--换行被转成空格 xml spec http://stackoverflow.com/questions/2004386/how-to-save-newlines-in-xml-attribute-->
            <arg value="(
            ajax|anim|base|button|calendar|combobox|component|
            cookie|datalazyload|dd|dom|event|flash|htmlparser|imagezoom|
            input-selection|json|menu|menubutton|mvc|node|overlay|
            resizable|separator|sizzle|
            split-button|stylesheet|suggest|switchable|
            template|toolbar|tree|ua|validation|waterfall|editor
            )(?:/.*)"/>

            <arg value="-excludeReg"/>
            <!--换行被转成空格 xml spec http://stackoverflow.com/questions/2004386/how-to-save-newlines-in-xml-attribute-->
            <arg value="(
            editor/plugin/.*
            )(?:/.*)"/>

            <arg value="-nameMap"/>
            <arg value="([\w-]+)(?:/.*)?||$1"/>

            <arg value="-outputEncoding"/>
            <arg value="utf-8"/>
            <arg value="-output"/>
            <arg value="${kissy.src.dir}/seed/src/dependency.js"/>
            <classpath>
                <pathelement path="${kissy-tools.dir}/module-compiler/module-compiler.jar"/>
                <pathelement path="${java.class.path}"/>
            </classpath>
        </java>
    </target>

</project>
