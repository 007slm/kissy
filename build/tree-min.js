/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Aug 17 18:37
*/
KISSY.add("tree/base",function(g,c,e,f,a){return e.extend([a],{expandAll:function(){return e.prototype.expandAll.apply(this,arguments)}},{ATTRS:{xrender:{value:f}}},{xclass:"tree",priority:30})},{requires:["component","./basenode","./treeRender","./treemgr"]});
KISSY.add("tree/basenode",function(g,c,e,f){function a(d,b,h,c){d[h](b);void 0!==c&&b.set("depth",c);g.each(b.get("children"),function(b){b.isController&&(c?a(d,b,h,c+1):a(d,b,h))})}function b(d){var a=d.get("parent"),a=(a=a&&a.get("children"))&&a[a.length-1];return!a||a==d}function h(d){var a=d.get("isLeaf");return!(!1===a||void 0===a&&d.get("children").length)}function m(d){var a=d.get("children");return!d.get("expanded")||!a.length?d:m(a[a.length-1])}function k(d){d.get&&d.get("view")&&d.get("view").refreshCss(b(d),
h(d))}function j(d){var a=d.get("children"),b=d.get("children").length;k(d);g.each(a,function(d,a){if(d.get){k(d);var h=d.get("el");h.attr("aria-posinset",a+1);h.attr("aria-setsize",b)}})}var l=c.all,i=c.KeyCodes,n=e.Container.extend({bindUI:function(){this.publish("click expand collapse",{bubbles:1})},syncUI:function(){k(this)},_keyNav:function(d){var a=!0,b=this.get("tree"),h=this.get("expanded"),c,g=this.get("isLeaf"),e=this.get("children");switch(d.keyCode){case i.HOME:c=b;break;case i.END:c=
m(b);break;case i.UP:c=d=(d=this.prev())?m(d):this.get("parent");break;case i.DOWN:d=this.get("children");if(this.get("expanded")&&d.length)c=d[0];else{d=this.next();for(b=this;!d&&(b=b.get("parent"));)d=b.next();c=d}break;case i.LEFT:h&&(e.length||!1===g)?this.set("expanded",!1):c=this.get("parent");break;case i.RIGHT:if(e.length||!1===g)h?c=e[0]:this.set("expanded",!0);break;default:a=!1}c&&c.select();return a},next:function(){var d=this.get("parent"),a;if(!d)return null;d=d.get("children");a=g.indexOf(this,
d);return a==d.length-1?null:d[a+1]},prev:function(){var d=this.get("parent"),a;if(!d)return null;d=d.get("children");a=g.indexOf(this,d);return 0===a?null:d[a-1]},select:function(){this.get("tree").set("selectedItem",this)},performActionInternal:function(a){var b=l(a.target),a=a.type,h=this.get("expanded");this.get("tree").get("el")[0].focus();b.equals(this.get("expandIconEl"))?"dblclick"!=a&&this.set("expanded",!h):"dblclick"==a?this.set("expanded",!h):(this.select(),this.fire("click"))},decorateChildrenInternal:function(a,
b){this.addChild(new a({srcNode:b,prefixCls:this.get("prefixCls")}))},addChild:function(){var d,b=this.get("tree");d=n.superclass.addChild.apply(this,g.makeArray(arguments));a(b,d,"_register",this.get("depth")+1);j(this);return d},removeChild:function(d){var b=this.get("tree");a(b,d,"_unRegister");n.superclass.removeChild.apply(this,g.makeArray(arguments));j(this);return d},_uiSetExpanded:function(a){this.get("tree");this.get("rendered")&&(k(this),this.fire(a?"expand":"collapse"))},expandAll:function(){this.set("expanded",
!0);g.each(this.get("children"),function(a){a.expandAll()})},collapseAll:function(){this.set("expanded",!1);g.each(this.get("children"),function(a){a.collapseAll()})}},{ATTRS:{delegateChildren:{value:!1},xrender:{value:f},handleMouseEvents:{value:!1},isLeaf:{view:1},expandIconEl:{view:1},iconEl:{view:1},selected:{view:1},expanded:{view:1},collapsed:{getter:function(){return!this.get("expanded")},setter:function(a){this.set("expanded",!a)}},tooltip:{view:1},tree:{getter:function(){for(var a=this;a&&
!a.isTree;)a=a.get("parent");return a}},depth:{view:1},focusable:{value:!1},decorateChildCls:{value:"ks-tree-children"}}},{xclass:"treeitem",priority:10});return n},{requires:["node","component","./basenodeRender"]});
KISSY.add("tree/basenodeRender",function(g,c,e){var f=c.all;return e.Render.extend({refreshCss:function(a,b){var h=this.get("expanded"),c=this.get("iconEl"),e,f=this.get("expandIconEl"),l=this.get("childrenEl");b?(h="ks-tree-icon ks-tree-file-icon",e="ks-tree-icon ks-tree-expand-icon ks-tree-expand-icon-{t}"):h?(h="ks-tree-icon ks-tree-expanded-folder-icon",e="ks-tree-icon ks-tree-expand-icon ks-tree-expand-icon-{t}minus"):(h="ks-tree-icon ks-tree-collapsed-folder-icon",e="ks-tree-icon ks-tree-expand-icon ks-tree-expand-icon-{t}plus");
c.attr("class",h);f.attr("class",g.substitute(e,{t:a?"l":"t"}));l&&l.attr("class",a?"ks-tree-lchildren":"ks-tree-children")},createDom:function(){var a=this.get("el"),b,h,c,e,j=this.get("contentEl");h=f("<div class='ks-treeitem-row'/>");(b=j.attr("id"))||j.attr("id",b=g.guid("ks-treeitem"));c=f("<div>").appendTo(h);e=f("<div>").appendTo(h);j.appendTo(h);a.attr({role:"treeitem","aria-labelledby":b}).prepend(h);this.__set("rowEl",h);this.__set("expandIconEl",c);this.__set("iconEl",e)},_uiSetExpanded:function(a){var b=
this.get("childrenEl");if(b)b[a?"show":"hide"]();this.get("el").attr("aria-expanded",a)},_uiSetSelected:function(a){this.get("rowEl")[a?"addClass":"removeClass"]("ks-treeitem-selected");this.get("el").attr("aria-selected",a)},_uiSetDepth:function(a){this.get("el").attr("aria-level",a)},_uiSetTooltip:function(a){this.get("el").attr("title",a)},getContentElement:function(){var a;if(a=this.get("childrenEl"))return a;a=f("<div "+(this.get("expanded")?"":"style='display:none'")+" role='group'></div>").appendTo(this.get("el"));
this.__set("childrenEl",a);return a}},{ATTRS:{childrenEl:{},expandIconEl:{},tooltip:{},iconEl:{},expanded:{value:!1},rowEl:{},depth:{value:0},contentEl:{valueFn:function(){return f("<span id='"+g.guid("ks-treeitem")+"' class='ks-treeitem-content'/>")}},isLeaf:{},selected:{}},HTML_PARSER:{childrenEl:function(a){return a.children(".ks-tree-children")},contentEl:function(a){return a.children(".ks-treeitem-content")},isLeaf:function(a){if(a.hasClass(this.getCssClassWithPrefix("treeitem-leaf")))return!0;
if(a.hasClass(this.getCssClassWithPrefix("treeitem-folder")))return!1},expanded:function(a){a=a.one(".ks-tree-children");return!a?!1:"none"!=a.css("display")}}})},{requires:["node","component"]});
KISSY.add("tree/checknode",function(g,c,e,f){var a=c.all,b=e.extend({expandAll:function(){return b.superclass.expandAll.apply(this,arguments)},performActionInternal:function(b){var c=this.get("expanded"),e=this.get("expandIconEl"),g=this.get("tree"),f=a(b.target);g.get("el")[0].focus();if("dblclick"==b.type){if(f.equals(e)||f.equals(this.get("checkIconEl")))return;this.set("expanded",!c)}f.equals(e)?this.set("expanded",!c):(b=this.get("checkState"),this.set("checkState",1==b?0:1),this.fire("click"))},
_uiSetCheckState:function(a){var b=this.get("parent"),c,e,f,i;(1==a||0==a)&&g.each(this.get("children"),function(b){b.set("checkState",a)});if(b){c=0;i=b.get("children");for(e=0;e<i.length;e++){f=i[e];f=f.get("checkState");if(2==f){b.set("checkState",2);return}1==f&&c++}0===c?b.set("checkState",0):c==i.length?b.set("checkState",1):b.set("checkState",2)}}},{ATTRS:{checkIconEl:{view:1},checkState:{view:1},xrender:{value:f}}},{xclass:"check-treeitem",priority:20});g.mix(b,{PARTIAL_CHECK:2,CHECK:1,EMPTY:0});
return b},{requires:["node","./basenode","./checknodeRender"]});
KISSY.add("tree/checknodeRender",function(g,c,e){var f=c.all;return e.extend({createDom:function(){var a=this.get("expandIconEl");this.__set("checkIconEl",f("<div class='ks-tree-icon'/>").insertAfter(a))},_uiSetCheckState:function(a){this.get("checkIconEl").removeClass("ks-treeitem-checked0 ks-treeitem-checked1 ks-treeitem-checked2").addClass("ks-treeitem-checked"+a)}},{ATTRS:{checkIconEl:{},checkState:{value:0}}})},{requires:["node","./basenodeRender"]});
KISSY.add("tree/checktree",function(g,c,e,f,a){var b=e.extend([a],{expandAll:function(){return b.superclass.expandAll.apply(this,arguments)},_uiSetFocused:function(){}},{ATTRS:{xrender:{value:f}}},{xclass:"check-tree",priority:40});return b},{requires:["component","./checknode","./checktreeRender","./treemgr"]});KISSY.add("tree/checktreeRender",function(g,c,e){return c.extend([e])},{requires:["./checknodeRender","./treemgrRender"]});
KISSY.add("tree",function(g,c,e,f,a){c.Node=e;c.CheckNode=f;c.CheckTree=a;return c},{requires:["tree/base","tree/basenode","tree/checknode","tree/checktree"]});KISSY.add("tree/treeRender",function(g,c,e){return c.extend([e])},{requires:["./basenodeRender","./treemgrRender"]});
KISSY.add("tree/treemgr",function(g,c){function e(){}function f(a){var a=a.get("el"),c=a.attr("id");c||a.attr("id",c=g.guid("tree-node"));return c}function a(a){a._allNodes||(a._allNodes={});return a._allNodes}e.ATTRS={delegateChildren:{value:!0},showRootNode:{value:!0,view:1},selectedItem:{},focusable:{value:!0}};g.augment(e,{isTree:1,_register:function(b){a(this)[f(b)]=b},_unRegister:function(b){delete a(this)[f(b)]},handleKeyEventInternal:function(a){var e=this.get("selectedItem");return a.keyCode==
c.KeyCodes.ENTER?e.performActionInternal(a):e._keyNav(a)},getOwnerControl:function(b){for(var c,e=a(this),f=this.get("el")[0];b&&b!==f;){if(c=e[b.id])return c;b=b.parentNode}return this},_uiSetSelectedItem:function(a,c){c.prevVal&&c.prevVal.set("selected",!1);a.set("selected",!0)},_uiSetFocused:function(a){a&&!this.get("selectedItem")&&this.select()}});return e},{requires:["event"]});
KISSY.add("tree/treemgrRender",function(g){function c(){}c.ATTRS={showRootNode:{}};g.augment(c,{__renderUI:function(){this.get("el").attr("role","tree");this.get("rowEl").addClass("ks-tree-row")},_uiSetShowRootNode:function(c){this.get("rowEl")[c?"show":"hide"]()}});return c});
