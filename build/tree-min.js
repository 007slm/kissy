/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Aug 1 21:33
*/
KISSY.add("tree/basenode",function(g,f,b,e,i){var d=f.all,j=b.create(e.ModelControl,{_keyNav:function(a){var c=true,h,k=this.get("children");switch(a.keyCode){case 36:h=this.get("tree");break;case 35:h=this.get("tree").getLastVisibleDescendant();break;case 38:h=this.getPreviousVisibleNode();break;case 40:h=this.getNextVisibleNode();break;case 37:if(this.get("expanded")&&k.length)this.set("expanded",false);else h=this.get("parent");break;case 39:if(k.length)this.get("expanded")?k[0].select():this.set("expanded",
true);break;default:c=false}h&&h.select();return c},getLastVisibleDescendant:function(){var a=this.get("children");if(!this.get("expanded")||!a.length)return this;return a[a.length-1].getLastVisibleDescendant()},getNextVisibleNode:function(){var a=this.get("children"),c=this.get("parent");if(this.get("expanded")&&a.length)return a[0];for(a=this.next();c&&!a;){a=c.next();c=c.get("parent")}return a},getPreviousVisibleNode:function(){var a=this.prev();return a=a?a.getLastVisibleDescendant():this.get("parent")},
next:function(){var a=this.get("parent");if(!a)return null;a=a.get("children");var c=g.indexOf(this,a);if(c==a.length-1)return null;return a[c+1]},prev:function(){var a=this.get("parent");if(!a)return null;a=a.get("children");var c=g.indexOf(this,a);if(c==0)return null;return a[c-1]},select:function(){this.get("tree").set("selectedItem",this)},_performInternal:function(a){var c=d(a.target),h=this.get("tree");h.get("el")[0].focus();if(c.hasClass(this.getCls("tree-expand-icon"))||a.type=="dblclick")this.set("expanded",
!this.get("expanded"));else{this.select();h.fire("click",{target:this})}},addChild:function(a){var c=this.get("tree");a.set("tree",c);a.set("depth",this.get("depth")+1);j.superclass.addChild.call(this,a);this._updateRecursive();c._register(a);g.each(a.get("children"),function(h){c._register(h)})},_computeClass:function(a){this.get("view")._computeClass(this.get("children"),this.get("parent"),a)},_updateRecursive:function(){var a=this.get("children").length;this._computeClass("_updateRecursive");g.each(this.get("children"),
function(c,h){c._computeClass("_updateRecursive_children");c.get("view").set("ariaPosInSet",h+1);c.get("view").set("ariaSize",a)})},removeChild:function(a){var c=this.get("tree");c._unregister(a);g.each(a.get("children"),function(h){c._unregister(h)});j.superclass.removeChild.apply(this,g.makeArray(arguments));this._updateRecursive()},_uiSetExpanded:function(a){this._computeClass("expanded-"+a)},expandAll:function(){this.set("expanded",true);g.each(this.get("children"),function(a){a.set("expanded",
true)})},collapseAll:function(){this.set("expanded",false);g.each(this.get("children"),function(a){a.set("expanded",false)})}},{DefaultRender:i,ATTRS:{handleMouseEvents:{value:false},id:{getter:function(){var a=this.get("el").attr("id");a||this.get("el").attr("id",a=g.guid("tree-node"));return a}},content:{view:true},selected:{view:true},expanded:{value:false,view:true},tooltip:{view:true},tree:{},depth:{value:0,view:true},focusable:{value:false}},HTML_PARSER:{expanded:function(a){a=a.one("."+this.getCls("tree-children"));
if(!a)return false;return a.css("display")!="none"}}});return j},{requires:["node","uibase","component","./basenoderender"]});
KISSY.add("tree/basenoderender",function(g,f,b,e){var i=f.all;return b.create(e.Render,{renderUI:function(){this.get("el").addClass(this.getCls("tree-item"))},_computeClass:function(d,j){var a=this.get("expanded"),c="inline-block tree-icon tree-expand-icon ",h=this.getCls("inline-block tree-icon tree-file-icon "),k=this.getCls(["inline-block tree-icon",a?"tree-expanded-folder-icon":"tree-collapsed-folder-icon",""].join(" ")),l=!j||j.get("children")[j.get("children").length-1].get("view")==this;if(d.length){this.set("iconElCls",
k);c+=a?"tree-expand-icon-{t}minus":"tree-expand-icon-{t}plus";this.set("expandIconElCls",this.getCls(g.substitute(c,{t:l?"l":"t"})))}else{this.set("iconElCls",h);this.set("expandIconElCls",this.getCls(g.substitute(c+"tree-expand-icon-{t}",{t:l?"l":"t"})))}this.set("childrenElCls",this.getCls(l?"tree-lchildren":"tree-children"))},_uiSetChildrenElCls:function(d){this.get("childrenEl")&&this.get("childrenEl").attr("class",d)},_uiSetExpandIconElCls:function(d){this.get("expandIconEl").attr("class",d)},
_uiSetIconElCls:function(d){this.get("iconEl").attr("class",d)},createDom:function(){var d=this.get("el"),j=d.children(),a=i("<div class='"+this.getCls("tree-row")+"'/>"),c=g.guid("tree-item"),h=i("<div/>").appendTo(a),k=i("<div />").appendTo(a),l=i("<span id='"+c+"' class='"+this.getCls("tree-item-label")+"'/>").appendTo(a);j.length&&l.append(j);d.attr({role:"treeitem","aria-labelledby":c}).append(a);this.set("labelEl",l);this.set("expandIconEl",h);this.set("iconEl",k);this.set("rowEl",a)},_uiSetExpanded:function(d){var j=
this.get("childrenEl");if(j)if(d)d&&j.show();else j.hide();this.get("el").attr("aria-expanded",d)},_uiSetContent:function(d){this.get("labelEl").html(d)},_uiSetDepth:function(d){this.get("el").attr("aria-level",d)},_uiSetAriaSize:function(d){this.get("el").attr("aria-setsize",d)},_uiSetAriaPosInSet:function(d){this.get("el").attr("aria-posinset",d)},_uiSetSelected:function(d){this.get("rowEl")[d?"addClass":"removeClass"](this.getCls("tree-item-selected"))},_uiSetTooltip:function(d){this.get("el").attr("title",
d)},getContentElement:function(){if(this.get("childrenEl"))return this.get("childrenEl");var d=i("<div "+(!this.get("expanded")?"style='display:none'":"")+" role='group'></div>").appendTo(this.get("el"));this.set("childrenEl",d);return d}},{ATTRS:{childrenElCls:{},expandIconElCls:{},iconElCls:{},ariaSize:{},ariaPosInSet:{},childrenEl:{},expandIconEl:{},tooltip:{},iconEl:{},rowEl:{},selected:{},expanded:{},depth:{},labelEl:{},content:{}}})},{requires:["node","uibase","component"]});
KISSY.add("tree/checknode",function(g,f,b,e,i,d){var j=f.all;return b.create(i,{_performInternal:function(a){this.get("tree").get("el")[0].focus();var c=j(a.target),h=this.get("tree");if(c.hasClass(this.getCls("tree-expand-icon"))||a.type=="dblclick")this.set("expanded",!this.get("expanded"));else{a=this.get("checkState");a=a==1?0:1;this.set("checkState",a);h.fire("click",{target:this})}},_uiSetCheckState:function(a){if(a==1||a==0)g.each(this.get("children"),function(n){n.set("checkState",a)});var c=
this.get("parent");if(c){for(var h=0,k=c.get("children"),l=0;l<k.length;l++){var m=k[l].get("checkState");if(m==2){c.set("checkState",2);return}else m==1&&h++}if(h==k.length)c.set("checkState",1);else h==0?c.set("checkState",0):c.set("checkState",2)}}},{ATTRS:{checkState:{view:true,value:0}},DefaultRender:d,PARTIAL_CHECK:2,CHECK:1,EMPTY:0})},{requires:["node","uibase","component","./basenode","./checknoderender"]});
KISSY.add("tree/checknoderender",function(g,f,b,e,i){var d=f.all;return b.create(i,{createDom:function(){var j=this.get("expandIconEl");this.set("checkEl",d("<div class='"+this.getCls("inline-block  tree-icon")+"'/>").insertAfter(j))},_uiSetCheckState:function(j){this.get("checkEl").removeClass(this.getCls("tree-item-checked0 tree-item-checked1 tree-item-checked2")).addClass(this.getCls("tree-item-checked"+j))}},{ATTRS:{checkEl:{},checkState:{}}})},{requires:["node","uibase","component","./basenoderender"]});
KISSY.add("tree/checktree",function(g,f,b,e,i,d){return f.create(e,[d],{},{DefaultRender:i})},{requires:["uibase","component","./checknode","./checktreerender","./treemgr"]});KISSY.add("tree/checktreerender",function(g,f,b,e,i){return f.create(e,[i])},{requires:["uibase","component","./checknoderender","./treemgrrender"]});KISSY.add("tree/tree",function(g,f,b,e,i,d){return f.create(e,[d],{},{DefaultRender:i})},{requires:["uibase","component","./basenode","./treerender","./treemgr"]});
KISSY.add("tree/treemgr",function(g){function f(){this._allNodes={}}f.ATTRS={showRootNode:{view:true},selectedItem:{},tree:{valueFn:function(){return this}},focusable:{value:true}};g.augment(f,{__renderUI:function(){this.get("children").length||this._computeClass("root_renderUI")},_register:function(b){this._allNodes[b.get("id")]=b},_unregister:function(b){delete this._allNodes[b.get("id")]},__bindUI:function(){this.get("el").on("mousedown mouseup mouseover mouseout dblclick",this._handleChildMouseEvents,
this)},_handleChildMouseEvents:function(b){var e=this._getOwnerNode(g.one(b.target)[0]);if(e)switch(b.type){case "mousedown":e._handleMouseDown(b);break;case "mouseup":e._handleMouseUp(b);break;case "mouseover":e._handleMouseOver(b);break;case "mouseout":e._handleMouseOut(b);break;case "dblclick":e._handleDblClick(b)}},_handleKeyEventInternal:function(b){var e=this.get("selectedItem");if(b.keyCode==13)return e._performInternal(b);return e._keyNav(b)},_getOwnerNode:function(b){for(var e,i=this.get("el")[0];b&&
b!==i;){if(e=this._allNodes[b.id])return e;b=b.parentNode}return this},_uiSetSelectedItem:function(b,e){e.prevVal&&e.prevVal.set("selected",false);b.set("selected",true)},_uiSetFocused:function(b){if(b)this.get("selectedItem")||this.select()}});return f});
KISSY.add("tree/treemgrrender",function(g){function f(){}f.ATTRS={showRootNode:{}};g.augment(f,{__renderUI:function(){this.get("el").addClass(this.getCls("tree-root")).attr("role","tree")[0].hideFocus=true;this.get("rowEl").addClass(this.getCls("tree-root-row"))},_uiSetShowRootNode:function(b){this.get("rowEl")[b?"show":"hide"]()},_uiSetFocused:function(b){this.get("el")[b?"addClass":"removeClass"](this.getCls("tree-item-focused"))}});return f});
KISSY.add("tree/treerender",function(g,f,b,e,i){return f.create(e,[i])},{requires:["uibase","component","./basenoderender","./treemgrrender"]});KISSY.add("tree",function(g,f,b,e,i){f.Node=b;f.CheckNode=e;f.CheckTree=i;return f},{requires:["tree/tree","tree/basenode","tree/checknode","tree/checktree"]});
