/*
Copyright 2010, KISSY UI Library v1.1.2dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("event",function(d,k){function i(a,b,e,h,g){if(d.isString(b))b=d.query(b);if(d.isArray(b)){d.each(b,function(j){t[a](j,e,h,g)});return true}if((e=d.trim(e))&&e.indexOf(x)>0){d.each(e.split(x),function(j){t[a](b,j,h,g)});return true}}function m(a){return f(a)?a[v]:-1}function l(a,b){if(!f(a))return d.error("Text or comment node is not valid event target.");try{a[v]=b}catch(e){d.error(e)}}function c(a){try{a[v]=k;delete a[v]}catch(b){}}function f(a){return a&&a.nodeType!==3&&a.nodeType!==
8}var q=document,r=q.addEventListener?function(a,b,e,h){a.addEventListener&&a.addEventListener(b,e,!!h)}:function(a,b,e){a.attachEvent&&a.attachEvent("on"+b,e)},y=q.removeEventListener?function(a,b,e,h){a.removeEventListener&&a.removeEventListener(b,e,!!h)}:function(a,b,e){a.detachEvent&&a.detachEvent("on"+b,e)},v="ksEventTargetId",x=" ",A=d.now(),w={},t={EVENT_GUID:v,special:{},add:function(a,b,e,h){if(!i("add",a,b,e,h)){var g=m(a),j,o,p,u,s;if(!(g===-1||!b||!d.isFunction(e))){if(!g){l(a,g=A++);
w[g]={target:a,events:{}}}o=w[g].events;if(!o[b]){j=((g=!a.isCustomEventTarget)||a._supportSpecialEvent)&&t.special[b]||{};p=function(n,z){if(!n||!n.fixed){n=new d.EventObject(a,n,b);d.isPlainObject(z)&&d.mix(n,z)}j.setup&&j.setup(n);return(j.handle||t._handle)(a,n,o[b].listeners,h)};o[b]={handle:p,listeners:[]};u=j.fix||b;s=j.capture;if(g)r(a,u,p,s);else a._addEvent&&a._addEvent(u,p,s)}o[b].listeners.push({fn:e,scope:h})}}},remove:function(a,b,e){if(!i("remove",a,b,e)){var h=m(a),g,j,o,p,u,s,n;if(h!==
-1)if(h&&(g=w[h]))if(g.target===a){g=g.events||{};if(j=g[b]){o=j.listeners;s=o.length;if(d.isFunction(e)&&s){u=p=0;for(n=[];p<s;++p)if(e!==o[p].fn)n[u++]=o[p];j.listeners=n;s=n.length}if(e===k||s===0){if(a.isCustomEventTarget)a._addEvent&&a._removeEvent(b,j.handle);else y(a,b,j.handle);delete g[b]}}if(b===k||d.isEmptyObject(g)){for(b in g)t.remove(a,b);delete w[h];c(a)}}}},_handle:function(a,b,e){e=e.slice(0);for(var h,g=0,j=e.length;g<j;++g){h=e[g];h=h.fn.call(h.scope||a,b);if(h===false&&a.isCustomEventTarget||
b.isImmediatePropagationStopped)break}return h},_getCache:function(a){return w[a]},_simpleAdd:r,_simpleRemove:y};t.on=t.add;d.Event=t});
KISSY.add("event-object",function(d,k){function i(c,f,q){this.currentTarget=c;this.originalEvent=f||{};if(f){this.type=f.type;this._fix()}else{this.type=q;this.target=c}this.currentTarget=c;this.fixed=true}var m=document,l="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");d.augment(i,
{_fix:function(){var c=this.originalEvent,f=l.length,q,r=this.currentTarget;for(r=r.nodeType===9?r:r.ownerDocument||m;f;){q=l[--f];this[q]=c[q]}if(!this.target)this.target=this.srcElement||m;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===k&&this.clientX!==k){c=r.documentElement;f=r.body;this.pageX=this.clientX+(c&&c.scrollLeft||f&&f.scrollLeft||
0)-(c&&c.clientLeft||f&&f.clientLeft||0);this.pageY=this.clientY+(c&&c.scrollTop||f&&f.scrollTop||0)-(c&&c.clientTop||f&&f.clientTop||0)}if(this.which===k)this.which=this.charCode!==k?this.charCode:this.keyCode;if(this.metaKey===k)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==k)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var c=this.originalEvent;if(c.preventDefault)c.preventDefault();else c.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var c=
this.originalEvent;if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var c=this.originalEvent;c.stopImmediatePropagation?c.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(c){c?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});d.EventObject=i});
KISSY.add("event-target",function(d,k){var i=d.Event,m=i.EVENT_GUID;d.EventTarget={isCustomEventTarget:true,fire:function(l,c){if((l=((i._getCache(this[m]||-1)||{}).events||{})[l])&&d.isFunction(l.handle))return l.handle(k,c);return this},on:function(l,c,f){i.add(this,l,c,f);return this},detach:function(l,c){i.remove(this,l,c);return this}}});
KISSY.add("event-mouseenter",function(d){var k=d.Event;d.UA.ie||d.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(i){k.special[i.name]={fix:i.fix,setup:function(m){m.type=i.name},handle:function(m,l,c){var f=l.relatedTarget;try{for(;f&&f!==m;)f=f.parentNode;f!==m&&k._handle(m,l,c)}catch(q){}}}})});
KISSY.add("event-focusin",function(d){var k=d.Event;document.addEventListener&&d.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(i){k.special[i.name]={fix:i.fix,capture:true,setup:function(m){m.type=i.name}}})});
