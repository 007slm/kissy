/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("event/base",function(n,d,l,j){function m(a,b,i){if((i=n.trim(i))&&i.indexOf(v)>0){var q=n.makeArray(arguments);n.each(i.split(v),function(o){var h=n.clone(q);h.splice(0,3,b,o);p[a].apply(p,h)});return true}return j}function c(a){return a&&a.nodeType!==3&&a.nodeType!==8}var k=document,f=k.addEventListener?function(a,b,i,q){a.addEventListener&&a.addEventListener(b,i,!!q)}:function(a,b,i){a.attachEvent&&a.attachEvent("on"+b,i)},g=k.removeEventListener?function(a,b,i,q){a.removeEventListener&&
a.removeEventListener(b,i,!!q)}:function(a,b,i){a.detachEvent&&a.detachEvent("on"+b,i)},v=" ",t="",u="trigger-none-"+n.now(),e="ksEventTargetId"+n.now(),p={_data:function(){var a=n.makeArray(arguments);a.splice(1,0,e);return d.data.apply(d,a)},_removeData:function(){var a=n.makeArray(arguments);a.splice(1,0,e);return d.removeData.apply(d,a)},special:{},add:function(a,b,i,q,o){if(m("add",a,b,i,q,o))return a;d.query(a).each(function(h){var r=!h.isCustomEventTarget,s,y,w;if(!(!h||!b||!n.isFunction(i)||
r&&!c(h))){(s=p._data(h))||p._data(h,s={});y=s.events=s.events||{};w=s.handler;if(!w){w=s.handler=function(x,z){if(!(x&&x.type==t)){var C=w.target;if(!x||!x.fixed)x=new l(C,x);n.isPlainObject(z)&&n.mix(x,z);return p._handle(C,x)}};w.target=h}var A=y[b];s=p.special[b]||{};if(!A){A=y[b]=[];if((!s.setup||s.setup.call(h)===false)&&r)f(h,b,w)}r={fn:i,scope:q||h,data:o};s.add&&s.add.call(h,r);A.push(r);h=null}});return a},__getListeners:function(a,b){return(p.__getEvents(a)||{})[b]||[]},__getEvents:function(a){return(a=
p._data(a))&&a.events},remove:function(a,b,i,q,o){if(m("remove",a,b,i,q))return a;d.query(a).each(function(h){var r=p._data(h),s=r&&r.events,y,w,A,x,z,C=!h.isCustomEventTarget,E=C&&p.special[b]||{};if(!(!h||!C&&!c(h)||!s))if(b===j)for(b in s)p.remove(h,b);else{q=q||h;if(y=s[b]){w=y.length;if(n.isFunction(i)&&w){x=A=0;for(z=[];A<w;++A){var F=false,B=y[A];if(i!==B.fn||q!==B.scope){z[x++]=B;F=true}else if(o!==D){var D=B.data;if(!o&&D||D&&!o){z[x++]=B;F=true}else if(o&&D)if(!o.equals||!D.equals)n.error("no equals in data");
else if(!o.equals(D)){z[x++]=B;F=true}}!F&&E.remove&&E.remove.call(h,B)}s[b]=z;w=z.length}if(i===j||w===0){if(C)if(!E.tearDown||E.tearDown.call(h)===false)g(h,b,r.handler);delete s[b]}}if(n.isEmptyObject(s)){r.handler.target=null;delete r.handler;delete r.events;p._removeData(h)}}});return a},_handle:function(a,b){for(var i=p.__getListeners(a,b.type).slice(0),q,o,h=0,r=i.length;h<r;++h){q=i[h];q=q.fn.call(q.scope,b,q.data);if(q!==j)if(q===false){o=q;b.halt()}if(b.isImmediatePropagationStopped)break}return o},
fire:function(a,b,i){if(!m("fire",a,b,i)){var q;d.query(a).each(function(o){var h=!o.isCustomEventTarget;i=i||{};i.type=b;if(h){if(c(o)){h=new l(o,i);var r=h.target=o,s="on"+b;do{var y=(p._data(r)||{}).handler;h.currentTarget=r;y&&y.call(r,h);if(r[s]&&r[s].call(r)===false){q=false;h.preventDefault()}r=r.parentNode||r.ownerDocument||r===o.ownerDocument&&window}while(r&&!h.isPropagationStopped);if(!h.isDefaultPrevented)if(!(b==="click"&&o.nodeName.toLowerCase()=="a")){var w;try{if(s&&o[b]){if(w=o[s])o[s]=
null;t=b;o[b]()}}catch(A){}if(w)o[s]=w;t=u}}}else if((o=p._data(o))&&n.isFunction(o.handler))q=o.handler(j,i)});return q}},_batchForType:m,_simpleAdd:f,_simpleRemove:g};p.on=p.add;p.detach=p.remove;return p},{requires:["dom","event/object"]});
KISSY.add("event/delegate",function(n,d,l){function j(f){return this.fn==f.fn&&this.selector==f.selector&&this.scope==f.scope}function m(f,g){var v,t=d.closest(f.target,[g.selector],this);if(t)for(var u=0;u<t.length;u++){f.currentTarget=t[u];var e=g.fn.call(g.scope||this,f);if(e===false||f.isPropagationStopped||f.isImmediatePropagationStopped){if(e===false)v=e;if(f.isPropagationStopped||f.isImmediatePropagationStopped)break}}return v}var c=l._batchForType,k={focus:"focusin",blur:"focusout"};n.mix(l,
{delegate:function(f,g,v,t,u){if(c("delegate",f,g,v,t,u))return f;d.query(f).each(function(e){if(!e.isCustomEventTarget){g=k[g]||g;l.on(e,g,m,e,{fn:t,selector:v,scope:u,equals:j})}});return f},undelegate:function(f,g,v,t,u){if(c("undelegate",f,g,v,t,u))return f;d.query(f).each(function(e){if(!e.isCustomEventTarget){g=k[g]||g;l.remove(e,g,m,e,{fn:t,selector:v,scope:u,equals:j})}})}});return l},{requires:["dom","./base"]});
KISSY.add("event/focusin",function(n,d,l){d.ie||n.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(j){function m(k){return l.fire(k.target,j.name)}var c=0;l.special[j.name]={setup:function(){c++===0&&document.addEventListener(j.fix,m,true)},tearDown:function(){--c===0&&document.removeEventListener(j.fix,m,true)}}});return l},{requires:["ua","./base"]});
KISSY.add("event/hashchange",function(n,d,l,j){j=document.documentMode||j.ie;if(!("onhashchange"in window)||j<8){var m,c=[],k=u();d.special.hashchange={setup:function(){-1===n.indexOf(this,c)&&c.push(this);m||f()},tearDown:function(){var e=n.indexOf(this,c);e>=0&&c.splice(e,1);if(c.length===0){m&&clearTimeout(m);m=null}}};var f=function(){g()},g=function(){var e=u();if(e!==k){v(e);k=e}m=setTimeout(g,50)},v=function(e){t(e)},t=function(){for(var e=0;e<c.length;e++)d._handle(c[e],{type:"hashchange"})},
u=function(){return"#"+location.href.replace(/^[^#]*#?(.*)$/,"$1")};j<8&&function(){var e;f=function(){if(!e){e=l.create('<iframe style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');l.prepend(e,document.documentElement);d.add(e,"load",function(){d.remove(e,"load");v(u());d.add(e,"load",p);g()});var p=function(){var a=n.trim(e.contentWindow.document.body.innerHTML),b=u();if(a!=b)k=location.hash=a;t(a)}}};v=function(p){p="<html><body>"+p+"</body></html>";var a=e.contentWindow.document;
try{a.open();a.write(p);a.close();return true}catch(b){return false}}}()}},{requires:["./base","dom","ua"]});
KISSY.add("event/mouseenter",function(n,d,l,j){j.ie||n.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(m){function c(k){var f=this,g=k.relatedTarget;k.type=m.name;try{if(!(g&&g!==document&&!g.parentNode)){g=l.closest(g,function(t){return t==f});g!==f&&d._handle(f,k)}}catch(v){}}d.special[m.name]={setup:function(){d.add(this,m.fix,c)},tearDown:function(){d.remove(this,m.fix,c)}}});return d},{requires:["./base","dom","ua"]});
KISSY.add("event/object",function(n,d){function l(c,k,f){this.currentTarget=c;this.originalEvent=k||{};if(k){this.type=k.type;this._fix()}else{this.type=f;this.target=c}this.currentTarget=c;this.fixed=true}var j=document,m="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
n.augment(l,{_fix:function(){var c=this.originalEvent,k=m.length,f,g=this.currentTarget;for(g=g.nodeType===9?g:g.ownerDocument||j;k;){f=m[--k];this[f]=c[f]}if(!this.target)this.target=this.srcElement||j;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===d&&this.clientX!==d){c=g.documentElement;k=g.body;this.pageX=this.clientX+(c&&c.scrollLeft||k&&k.scrollLeft||
0)-(c&&c.clientLeft||k&&k.clientLeft||0);this.pageY=this.clientY+(c&&c.scrollTop||k&&k.scrollTop||0)-(c&&c.clientTop||k&&k.clientTop||0)}if(this.which===d)this.which=this.charCode!==d?this.charCode:this.keyCode;if(this.metaKey===d)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==d)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var c=this.originalEvent;if(c.preventDefault)c.preventDefault();else c.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var c=
this.originalEvent;if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var c=this.originalEvent;c.stopImmediatePropagation?c.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(c){c?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return l});
KISSY.add("event/target",function(n,d){return{isCustomEventTarget:true,fire:function(l,j){return d.fire(this,l,j)},on:function(l,j,m){d.add(this,l,j,m);return this},detach:function(l,j,m){d.remove(this,l,j,m);return this}}},{requires:["event/base","dom"]});
KISSY.add("event/valuechange",function(n,d,l){function j(a){var b=l.data(a,t);if(!b){b=+new Date;l.data(a,t,b)}return b}function m(a){a=j(a);delete u[a];if(e[a]){clearTimeout(e[a]);delete e[a]}}function c(a){m(a.target)}function k(a){var b=j(a);e[b]||(e[b]=setTimeout(function(){var i=a.value;if(i!==u[b]){d._handle(a,{type:v,prevVal:u[b],newVal:i});u[b]=i}e[b]=setTimeout(arguments.callee,p)},p))}function f(a){var b=a.target;if(a.type=="focus"){a=j(b);u[a]=b.value}k(b)}function g(a){m(a);d.remove(a,
"blur",c);d.remove(a,"mousedown keyup keydown focus",f);l.removeData(a,t)}var v="valueChange",t="event/valuechange",u={},e={},p=50;d.special[v]={fix:false,setup:function(){var a=this.nodeName.toLowerCase();if("input"==a||"textarea"==a){g(this);d.on(this,"blur",c);d.on(this,"mousedown keyup keydown focus",f)}},tearDown:function(){g(this)}};return d},{requires:["./base","dom"]});
KISSY.add("event",function(n,d,l){d.Target=l;return d},{requires:["event/base","event/target","event/object","event/focusin","event/hashchange","event/valuechange","event/delegate","event/mouseenter"]});
