/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("event/base",function(j,g,o,m){function n(a,b,f,i,k){if(j.isString(b))b=g.query(b);if(j.isArray(b)||q(b)){j.each(b,function(l){e[a](l,f,i,k)});return true}if((f=j.trim(f))&&f.indexOf(u)>0){j.each(f.split(u),function(l){e[a](b,l,i,k)});return true}return m}function c(a){return a&&a.nodeType!==3&&a.nodeType!==8?g.data(a,t):-1}function h(a,b){a&&a.nodeType!==3&&a.nodeType!==8&&g.data(a,t,b)}var p=document,q=g._isNodeList,B=p.addEventListener?function(a,b,f,i){a.addEventListener&&a.addEventListener(b,
f,!!i)}:function(a,b,f){a.attachEvent&&a.attachEvent("on"+b,f)},A=p.removeEventListener?function(a,b,f,i){a.removeEventListener&&a.removeEventListener(b,f,!!i)}:function(a,b,f){a.detachEvent&&a.detachEvent("on"+b,f)},t="ksEventTargetId",u=" ",C=j.now(),d={},e={EVENT_GUID:t,special:{},add:function(a,b,f,i){if(!n("add",a,b,f,i)){var k=c(a),l,s,v,x,w;if(!(k===-1||!b||!j.isFunction(f))){if(!k){h(a,k=C++);d[k]={target:a,events:{}}}s=d[k].events;if(!s[b]){l=(k=!a.isCustomEventTarget)&&e.special[b]||{};
v=function(r,y){if(!r||!r.fixed)r=new o(a,r,b);if(j.isPlainObject(y)){var z=r.type;j.mix(r,y);r.type=z}l.setup&&l.setup(r);return(l.handle||e._handle)(a,r)};s[b]={handle:v,listeners:[]};x=l.fix||b;w=l.capture;l.init&&l.init.apply(null,j.makeArray(arguments));k&&l.fix!==false&&B(a,x,v,w)}s[b].listeners.push({fn:f,scope:i||a})}}},__getListeners:function(a,b){var f,i=[];if(f=(e.__getEvents(a)||{})[b])i=f.listeners;return i},__getEvents:function(a){var b=c(a),f;if(b!==-1)if(b&&(f=d[b]))if(f.target===
a)return f.events||{}},remove:function(a,b,f,i){if(!n("remove",a,b,f,i)){var k=e.__getEvents(a),l=c(a),s,v,x,w,r,y,z=!a.isCustomEventTarget&&e.special[b]||{};if(k!==m){i=i||a;if(s=k[b]){v=s.listeners;x=v.length;if(j.isFunction(f)&&x){r=w=0;for(y=[];w<x;++w)if(f!==v[w].fn||i!==v[w].scope)y[r++]=v[w];s.listeners=y;x=y.length}if(f===m||x===0){if(!a.isCustomEventTarget){z=e.special[b]||{};if(z.fix!==false)A(a,z.fix||b,s.handle)}delete k[b]}}z.destroy&&z.destroy.apply(null,j.makeArray(arguments));if(b===
m||j.isEmptyObject(k)){for(b in k)e.remove(a,b);delete d[l];g.removeData(a,t)}}}},_handle:function(a,b){var f=e.__getListeners(a,b.type);f=f.slice(0);for(var i,k,l=0,s=f.length;l<s;++l){i=f[l];i=i.fn.call(i.scope,b);if(k!==false)k=i;i!==m&&i===false&&b.halt();if(b.isImmediatePropagationStopped)break}return k},_getCache:function(a){return d[a]},__getID:c,_simpleAdd:B,_simpleRemove:A};e.on=e.add;e.detach=e.remove;return e},{requires:["dom","event/object"]});
KISSY.add("event/focusin",function(j,g){document.addEventListener&&j.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(o){g.special[o.name]={fix:o.fix,capture:true,setup:function(m){m.type=o.name}}})},{requires:["event/base"]});
KISSY.add("event/mouseenter",function(j,g,o,m){m.ie||j.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(n){g.special[n.name]={fix:n.fix,setup:function(c){c.type=n.name},handle:function(c,h){var p=h.relatedTarget;try{for(;p&&p!==c;)p=p.parentNode;p!==c&&g._handle(c,h)}catch(q){}}}})},{requires:["event/base","dom","ua"]});
KISSY.add("event/object",function(j,g){function o(c,h,p){this.currentTarget=c;this.originalEvent=h||{};if(h){this.type=h.type;this._fix()}else{this.type=p;this.target=c}this.currentTarget=c;this.fixed=true}var m=document,n="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
j.augment(o,{_fix:function(){var c=this.originalEvent,h=n.length,p,q=this.currentTarget;for(q=q.nodeType===9?q:q.ownerDocument||m;h;){p=n[--h];this[p]=c[p]}if(!this.target)this.target=this.srcElement||m;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===g&&this.clientX!==g){c=q.documentElement;h=q.body;this.pageX=this.clientX+(c&&c.scrollLeft||h&&h.scrollLeft||
0)-(c&&c.clientLeft||h&&h.clientLeft||0);this.pageY=this.clientY+(c&&c.scrollTop||h&&h.scrollTop||0)-(c&&c.clientTop||h&&h.clientTop||0)}if(this.which===g)this.which=this.charCode!==g?this.charCode:this.keyCode;if(this.metaKey===g)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==g)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var c=this.originalEvent;if(c.preventDefault)c.preventDefault();else c.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var c=
this.originalEvent;if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var c=this.originalEvent;c.stopImmediatePropagation?c.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(c){c?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return o});
KISSY.add("event/target",function(j,g,o,m){return{isCustomEventTarget:true,fire:function(n,c){var h=o.data(this,g.EVENT_GUID)||-1;if((h=((g._getCache(h)||{}).events||{})[n])&&j.isFunction(h.handle))return h.handle(m,c)},on:function(n,c,h){g.add(this,n,c,h);return this},detach:function(n,c,h){g.remove(this,n,c,h);return this}}},{requires:["event/base","dom"]});
KISSY.add("event/valuechange",function(j,g,o){function m(d){var e=o.data(d,A);if(!e){e=+new Date;o.data(d,A,e)}return e}function n(d){d=m(d);delete t[d];if(u[d]){clearTimeout(u[d]);delete u[d]}}function c(d){n(d.target)}function h(d){var e=m(d);u[e]||(u[e]=setTimeout(function(){var a=d.value;if(a!==t[e]){g._handle(d,{type:B,preVal:t[e],newVal:a});t[e]=a}u[e]=setTimeout(arguments.callee,C)},C))}function p(d){var e=d.target;if(d.type=="focus"){d=m(e);t[d]=e.value}h(e)}function q(d){n(d);g.remove(d,
"blur",c);g.remove(d,"mousedown keyup keydown focus",p);o.removeData(d,A)}var B="valueChange",A="event/valuechange",t={},u={},C=50;g.special[B]={fix:false,init:function(d){var e=d.nodeName.toLowerCase();if("input"==e||"textarea"==e){q(d);g.on(d,"blur",c);g.on(d,"mousedown keyup keydown focus",p)}},destroy:function(d,e){g.__getEvents(d)[e]||q(d)}}},{requires:["event/base","dom"]});
KISSY.add("event",function(j,g,o){g.Target=o;return g},{requires:["event/base","event/target","event/object","event/focusin","event/mouseenter"]});
