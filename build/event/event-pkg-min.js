/*
Copyright 2010, KISSY UI Library v1.1.3
MIT Licensed
build time: Sep 7 10:47
*/
KISSY.add("event",function(e,k){function j(a,b,d,g,i){if(e.isString(b))b=e.query(b);if(e.isArray(b)){e.each(b,function(h){r[a](h,d,g,i)});return true}if((d=e.trim(d))&&d.indexOf(y)>0){e.each(d.split(y),function(h){r[a](b,h,g,i)});return true}}function m(a){return f(a)?a[w]:-1}function l(a,b){if(!f(a))return e.error("Text or comment node is not valid event target.");try{a[w]=b}catch(d){e.error(d)}}function c(a){try{a[w]=k;delete a[w]}catch(b){}}function f(a){return a&&a.nodeType!==3&&a.nodeType!==
8}var s=document,t=s.addEventListener?function(a,b,d,g){a.addEventListener&&a.addEventListener(b,d,!!g)}:function(a,b,d){a.attachEvent&&a.attachEvent("on"+b,d)},z=s.removeEventListener?function(a,b,d,g){a.removeEventListener&&a.removeEventListener(b,d,!!g)}:function(a,b,d){a.detachEvent&&a.detachEvent("on"+b,d)},w="ksEventTargetId",y=" ",A=e.now(),x={},r={EVENT_GUID:w,special:{},add:function(a,b,d,g){if(!j("add",a,b,d,g)){var i=m(a),h,o,p,q,v;if(!(i===-1||!b||!e.isFunction(d))){if(!i){l(a,i=A++);
x[i]={target:a,events:{}}}o=x[i].events;if(!o[b]){h=((i=!a.isCustomEventTarget)||a._supportSpecialEvent)&&r.special[b]||{};p=function(n,u){if(!n||!n.fixed){n=new e.EventObject(a,n,b);e.isPlainObject(u)&&e.mix(n,u)}h.setup&&h.setup(n);return(h.handle||r._handle)(a,n,o[b].listeners)};o[b]={handle:p,listeners:[]};q=h.fix||b;v=h.capture;if(i)t(a,q,p,v);else a._addEvent&&a._addEvent(q,p,v)}o[b].listeners.push({fn:d,scope:g||a})}}},remove:function(a,b,d,g){if(!j("remove",a,b,d,g)){var i=m(a),h,o,p,q,v,
n,u;if(i!==-1)if(i&&(h=x[i]))if(h.target===a){g=g||a;h=h.events||{};if(o=h[b]){p=o.listeners;n=p.length;if(e.isFunction(d)&&n){v=q=0;for(u=[];q<n;++q)if(d!==p[q].fn||g!==p[q].scope)u[v++]=p[q];o.listeners=u;n=u.length}if(d===k||n===0){if(a.isCustomEventTarget)a._addEvent&&a._removeEvent(b,o.handle);else{d=r.special[b]||{};z(a,d.fix||b,o.handle)}delete h[b]}}if(b===k||e.isEmptyObject(h)){for(b in h)r.remove(a,b);delete x[i];c(a)}}}},_handle:function(a,b,d){d=d.slice(0);for(var g,i=0,h=d.length;i<h;++i){g=
d[i];g=g.fn.call(g.scope||a,b);if(g===false&&a.isCustomEventTarget||b.isImmediatePropagationStopped)break}return g},_getCache:function(a){return x[a]},_simpleAdd:t,_simpleRemove:z};r.on=r.add;e.Event=r});
KISSY.add("event-object",function(e,k){function j(c,f,s){this.currentTarget=c;this.originalEvent=f||{};if(f){this.type=f.type;this._fix()}else{this.type=s;this.target=c}this.currentTarget=c;this.fixed=true}var m=document,l="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");e.augment(j,
{_fix:function(){var c=this.originalEvent,f=l.length,s,t=this.currentTarget;for(t=t.nodeType===9?t:t.ownerDocument||m;f;){s=l[--f];this[s]=c[s]}if(!this.target)this.target=this.srcElement||m;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===k&&this.clientX!==k){c=t.documentElement;f=t.body;this.pageX=this.clientX+(c&&c.scrollLeft||f&&f.scrollLeft||
0)-(c&&c.clientLeft||f&&f.clientLeft||0);this.pageY=this.clientY+(c&&c.scrollTop||f&&f.scrollTop||0)-(c&&c.clientTop||f&&f.clientTop||0)}if(this.which===k)this.which=this.charCode!==k?this.charCode:this.keyCode;if(this.metaKey===k)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==k)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var c=this.originalEvent;if(c.preventDefault)c.preventDefault();else c.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var c=
this.originalEvent;if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var c=this.originalEvent;c.stopImmediatePropagation?c.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(c){c?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});e.EventObject=j});
KISSY.add("event-target",function(e,k){var j=e.Event,m=j.EVENT_GUID;e.EventTarget={isCustomEventTarget:true,fire:function(l,c){if((l=((j._getCache(this[m]||-1)||{}).events||{})[l])&&e.isFunction(l.handle))return l.handle(k,c);return this},on:function(l,c,f){j.add(this,l,c,f);return this},detach:function(l,c,f){j.remove(this,l,c,f);return this}}});
KISSY.add("event-mouseenter",function(e){var k=e.Event;e.UA.ie||e.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(j){k.special[j.name]={fix:j.fix,setup:function(m){m.type=j.name},handle:function(m,l,c){var f=l.relatedTarget;try{for(;f&&f!==m;)f=f.parentNode;f!==m&&k._handle(m,l,c)}catch(s){}}}})});
KISSY.add("event-focusin",function(e){var k=e.Event;document.addEventListener&&e.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(j){k.special[j.name]={fix:j.fix,capture:true,setup:function(m){m.type=j.name}}})});
