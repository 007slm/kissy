/*
Copyright 2010, KISSY UI Library v1.1.1dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("event",function(d,i){function h(a,b,e,g,f){if(d.isString(b))b=d.query(b);if(d.isArray(b)){d.each(b,function(j){r[a](j,e,g,f)});return true}if((e=d.trim(e))&&e.indexOf(w)>0){d.each(e.split(w),function(j){r[a](b,j,g,f)});return true}}function m(a){return k(a)?a[u]:-1}function l(a,b){if(!k(a))return d.error("Text or comment node is not valid event target.");try{a[u]=b}catch(e){d.error(e)}}function c(a){try{a[u]=i;delete a[u]}catch(b){}}function k(a){return a&&a.nodeType!==3&&a.nodeType!==
8}var q=window,n=document,x=n.addEventListener?function(a,b,e,g){a.addEventListener&&a.addEventListener(b,e,!!g)}:function(a,b,e){a.attachEvent&&a.attachEvent("on"+b,e)},y=n.removeEventListener?function(a,b,e,g){a.removeEventListener&&a.removeEventListener(b,e,!!g)}:function(a,b,e){a.detachEvent&&a.detachEvent("on"+b,e)},u="ksEventTargetId",w=" ",z=d.now(),t={},r={EVENT_GUID:u,special:{},add:function(a,b,e,g){if(!h("add",a,b,e,g)){var f=m(a),j,p;if(!(f===-1||!b||!d.isFunction(e))){if(!f){l(a,f=z++);
t[f]={target:a,events:{}}}p=t[f].events;j=!a.isCustomEventTarget&&r.special[b]||{};if(!p[b]){f=function(o,s){if(!o||!o.fixed){o=new d.EventObject(a,o,b);d.isPlainObject(s)&&d.mix(o,s)}j.setup&&j.setup(o);return(j.handle||r._handle)(a,o,p[b].listeners)};p[b]={handle:f,listeners:[]};if(a.isCustomEventTarget)a._addEvent&&a._addEvent(b,f);else x(a,j.fix||b,f,j.capture)}p[b].listeners.push({fn:e,scope:g})}}},remove:function(a,b,e){if(!h("remove",a,b,e)){var g=m(a),f,j,p,o,s,v;if(g!==-1)if(g&&(f=t[g]))if(f.target===
a){f=f.events||{};if(j=f[b]){p=j.listeners;s=p.length;if(d.isFunction(e)&&s&&d.inArray(e,p)){v=[];for(o=0;o<s;++o)e!==p[o]&&v.push(p[o]);s=v.length}if(e===i||s===0){if(a.isCustomEventTarget)a._addEvent&&a._removeEvent(b,j.handle);else y(a,b,j.handle);delete f[b]}}if(b===i||d.isEmptyObject(f)){for(b in f)r.remove(a,b);delete t[g];c(a)}}}},_handle:function(a,b,e){e=e.slice(0);for(var g,f=0,j=e.length;f<j;++f){g=e[f];g=g.fn.call(g.scope||a,b);if(g===false&&a.isCustomEventTarget||b.isImmediatePropagationStopped)break}return g},
_getCache:function(a){return t[a]},_simpleAdd:x,_simpleRemove:y};r.on=r.add;d.Event=r;q.attachEvent&&!q.addEventListener&&q.attachEvent("onunload",function(){var a,b;for(a in t)if(b=t[a].target)try{r.remove(b)}catch(e){}})});
KISSY.add("event-object",function(d,i){function h(c,k,q){this.currentTarget=c;this.originalEvent=k||{};if(k){this.type=k.type;this._fix()}else{this.type=q;this.target=c}this.fixed=true}var m=document,l="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");d.augment(h,
{_fix:function(){for(var c=this.originalEvent,k=l.length,q,n=this.currentTarget.ownerDocument||m;k;){q=l[--k];this[q]=c[q]}if(!this.target)this.target=this.srcElement||m;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===i&&this.clientX!==i){c=n.documentElement;n=n.body;this.pageX=this.clientX+(c&&c.scrollLeft||n&&n.scrollLeft||0)-(c&&c.clientLeft||
n&&n.clientLeft||0);this.pageY=this.clientY+(c&&c.scrollTop||n&&n.scrollTop||0)-(c&&c.clientTop||n&&n.clientTop||0)}if(this.which===i)this.which=this.charCode!==i?this.charCode:this.keyCode;if(this.metaKey===i)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==i)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var c=this.originalEvent;if(c.preventDefault)c.preventDefault();else c.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var c=
this.originalEvent;if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var c=this.originalEvent;c.stopImmediatePropagation?c.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(c){c?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});d.EventObject=h});
KISSY.add("event-target",function(d,i){var h=d.Event,m=h.EVENT_GUID;d.EventTarget={isCustomEventTarget:true,fire:function(l,c){if((l=((h._getCache(this[m]||-1)||{}).events||{})[l])&&d.isFunction(l.handle))return l.handle(i,c)},on:function(l,c,k){h.add(this,l,c,k)},detach:function(l,c){h.remove(this,l,c)}}});
KISSY.add("event-mouseenter",function(d){var i=d.Event;d.UA.ie||d.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(h){i.special[h.name]={fix:h.fix,setup:function(m){m.type=h.name},handle:function(m,l,c){var k=l.relatedTarget;try{for(;k&&k!==m;)k=k.parentNode;k!==m&&i._handle(m,l,c)}catch(q){}}}})});
KISSY.add("event-focusin",function(d){var i=d.Event;document.addEventListener&&d.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(h){i.special[h.name]={fix:h.fix,capture:true,setup:function(m){m.type=h.name}}})});
