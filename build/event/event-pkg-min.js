/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("event/base",function(i,f,n,l){function m(a,b,e,h,j){if(i.isString(b))b=f.query(b);if(i.isArray(b)){i.each(b,function(k){c[a](k,e,h,j)});return true}if((e=i.trim(e))&&e.indexOf(u)>0){i.each(e.split(u),function(k){c[a](b,k,h,j)});return true}return l}function d(a){return a&&a.nodeType!==3&&a.nodeType!==8?f.data(a,v):-1}function g(a,b){a&&a.nodeType!==3&&a.nodeType!==8&&f.data(a,v,b)}var o=document,p=o.addEventListener?function(a,b,e,h){a.addEventListener&&a.addEventListener(b,e,!!h)}:function(a,
b,e){a.attachEvent&&a.attachEvent("on"+b,e)},B=o.removeEventListener?function(a,b,e,h){a.removeEventListener&&a.removeEventListener(b,e,!!h)}:function(a,b,e){a.detachEvent&&a.detachEvent("on"+b,e)},v="ksEventTargetId",u=" ",w=i.now(),x={},c={EVENT_GUID:v,special:{},add:function(a,b,e,h){if(!m("add",a,b,e,h)){var j=d(a),k,r,s,y,t;if(!(j===-1||!b||!i.isFunction(e))){if(!j){g(a,j=w++);x[j]={target:a,events:{}}}r=x[j].events;if(!r[b]){k=(j=!a.isCustomEventTarget)&&c.special[b]||{};s=function(q,z){if(!q||
!q.fixed)q=new n(a,q,b);if(i.isPlainObject(z)){var A=q.type;i.mix(q,z);q.type=A}k.setup&&k.setup(q);return(k.handle||c._handle)(a,q)};r[b]={handle:s,listeners:[]};y=k.fix||b;t=k.capture;k.init&&k.init.apply(null,i.makeArray(arguments));j&&k.fix!==false&&p(a,y,s,t)}r[b].listeners.push({fn:e,scope:h||a})}}},__getListeners:function(a,b){var e,h=[];if(e=(c.__getEvents(a)||{})[b])h=e.listeners;return h},__getEvents:function(a){var b=d(a),e;if(b!==-1)if(b&&(e=x[b]))if(e.target===a)return e.events||{}},
remove:function(a,b,e,h){if(!m("remove",a,b,e,h)){var j=c.__getEvents(a),k=d(a),r,s,y,t,q,z,A=!a.isCustomEventTarget&&c.special[b]||{};if(j!==l){h=h||a;if(r=j[b]){s=r.listeners;y=s.length;if(i.isFunction(e)&&y){q=t=0;for(z=[];t<y;++t)if(e!==s[t].fn||h!==s[t].scope)z[q++]=s[t];r.listeners=z;y=z.length}if(e===l||y===0){if(!a.isCustomEventTarget){A=c.special[b]||{};if(A.fix!==false)B(a,A.fix||b,r.handle)}delete j[b]}}A.destroy&&A.destroy.apply(null,i.makeArray(arguments));if(b===l||i.isEmptyObject(j)){for(b in j)c.remove(a,
b);delete x[k];f.removeData(a,v)}}}},_handle:function(a,b){var e=c.__getListeners(a,b.type);e=e.slice(0);for(var h,j,k=0,r=e.length;k<r;++k){h=e[k];h=h.fn.call(h.scope,b);if(j!==false)j=h;h!==l&&h===false&&b.halt();if(b.isImmediatePropagationStopped)break}return j},_getCache:function(a){return x[a]},__getID:d,_simpleAdd:p,_simpleRemove:B};c.on=c.add;c.detach=c.remove;return c},{requires:["dom","event/object"]});
KISSY.add("event/focusin",function(i,f){document.addEventListener&&i.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(n){f.special[n.name]={fix:n.fix,capture:true,setup:function(l){l.type=n.name}}})},{requires:["event/base"]});
KISSY.add("event/mouseenter",function(i,f,n,l){l.ie||i.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(m){f.special[m.name]={fix:m.fix,setup:function(d){d.type=m.name},handle:function(d,g){var o=g.relatedTarget;try{for(;o&&o!==d;)o=o.parentNode;o!==d&&f._handle(d,g)}catch(p){}}}})},{requires:["event/base","dom","ua"]});
KISSY.add("event/object",function(i,f){function n(d,g,o){this.currentTarget=d;this.originalEvent=g||{};if(g){this.type=g.type;this._fix()}else{this.type=o;this.target=d}this.currentTarget=d;this.fixed=true}var l=document,m="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
i.augment(n,{_fix:function(){var d=this.originalEvent,g=m.length,o,p=this.currentTarget;for(p=p.nodeType===9?p:p.ownerDocument||l;g;){o=m[--g];this[o]=d[o]}if(!this.target)this.target=this.srcElement||l;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===f&&this.clientX!==f){d=p.documentElement;g=p.body;this.pageX=this.clientX+(d&&d.scrollLeft||g&&g.scrollLeft||
0)-(d&&d.clientLeft||g&&g.clientLeft||0);this.pageY=this.clientY+(d&&d.scrollTop||g&&g.scrollTop||0)-(d&&d.clientTop||g&&g.clientTop||0)}if(this.which===f)this.which=this.charCode!==f?this.charCode:this.keyCode;if(this.metaKey===f)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==f)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var d=this.originalEvent;if(d.preventDefault)d.preventDefault();else d.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var d=
this.originalEvent;if(d.stopPropagation)d.stopPropagation();else d.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var d=this.originalEvent;d.stopImmediatePropagation?d.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(d){d?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return n});
KISSY.add("event/target",function(i,f,n,l){return{isCustomEventTarget:true,fire:function(m,d){var g=n.data(this,f.EVENT_GUID)||-1;if((g=((f._getCache(g)||{}).events||{})[m])&&i.isFunction(g.handle))return g.handle(l,d)},on:function(m,d,g){f.add(this,m,d,g);return this},detach:function(m,d,g){f.remove(this,m,d,g);return this}}},{requires:["event/base","dom"]});
KISSY.add("event/valuechange",function(i,f,n){function l(c){var a=n.data(c,v);if(!a){a=+new Date;n.data(c,v,a)}return a}function m(c){c=l(c);delete u[c];if(w[c]){clearTimeout(w[c]);delete w[c]}}function d(c){m(c.target)}function g(c){var a=l(c);w[a]||(w[a]=setTimeout(function(){var b=c.value;if(b!==u[a]){f._handle(c,{type:B,preVal:u[a],newVal:b});u[a]=b}w[a]=setTimeout(arguments.callee,x)},x))}function o(c){var a=c.target;if(c.type=="focus"){c=l(a);u[c]=a.value}g(a)}function p(c){m(c);f.remove(c,
"blur",d);f.remove(c,"mousedown keyup keydown focus",o);n.removeData(c,v)}var B="valueChange",v="event/valuechange",u={},w={},x=50;f.special[B]={fix:false,init:function(c){var a=c.nodeName.toLowerCase();if("input"==a||"textarea"==a){p(c);f.on(c,"blur",d);f.on(c,"mousedown keyup keydown focus",o)}},destroy:function(c,a){f.__getEvents(c)[a]||p(c)}}},{requires:["event/base","dom"]});
KISSY.add("event",function(i,f,n){f.Target=n;return f},{requires:["event/base","event/target","event/object","event/focusin","event/mouseenter"]});
