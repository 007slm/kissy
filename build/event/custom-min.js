/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Mar 15 18:59
*/
KISSY.add("event/custom/api-impl",function(e,k,g,i){var h=g._Utils,l=h.splitAndRun;return e.mix(k,{fire:function(b,c,a){var d=void 0,m=k.getTargets(b,1),n=m&&m.length,a=a||{};l(c,function(m){var f,m=h.getTypedGroups(m);f=m[1];m=m[0];f&&(f=h.getGroupsRe(f),a._ks_groups=f);if((f=i.getCustomEvent(b,m))||n){if(f){if(!f.hasObserver()&&!f.defaultFn&&(f.bubbles&&!n||!f.bubbles))return}else f=new i({currentTarget:b,type:m});m=f.fire(a);!1!==d&&(d=m)}});return d},publish:function(b,c,a){var d;l(c,function(m){d=
i.getCustomEvent(b,m,1);e.mix(d,a)});return b},getCustomEvent:function(b,c,a){return i.getCustomEvent(b,c,a)},addTarget:function(b,c){var a=k.getTargets(b);e.inArray(c,a)||a.push(c);return b},removeTarget:function(b,c){var a=k.getTargets(b),d=e.indexOf(c,a);-1!=d&&a.splice(d,1);return b},getTargets:function(b,c){c||(b["__~ks_bubble_targets"]=b["__~ks_bubble_targets"]||[]);return b["__~ks_bubble_targets"]},on:function(b,c,a,d){h.batchForType(function(a,d,c){d=h.normalizeParam(a,d,c);a=d.type;if(a=
i.getCustomEvent(b,a,1))a.on(d)},0,c,a,d);return b},detach:function(b,c,a,d){h.batchForType(function(a,d,c){var f=h.normalizeParam(a,d,c);(a=f.type)?(a=i.getCustomEvent(b,a,1))&&a.detach(f):(a=i.getCustomEvents(b),e.each(a,function(a){a.detach(f)}))},0,c,a,d);return b}})},{requires:["./api","event/base","./observable"]});KISSY.add("event/custom/api",function(){return{}});
KISSY.add("event/custom",function(e,k,g,i){var h={};e.each(g,function(g,b){h[b]=function(){var b=e.makeArray(arguments);b.unshift(this);return g.apply(null,b)}});g=e.mix({_ObservableCustomEvent:i,Target:h},g);e.mix(k,{Target:h,Custom:g});e.EventTarget=h;return g},{requires:["./base","./custom/api-impl","./custom/observable"]});KISSY.add("event/custom/object",function(e,k){function g(i){g.superclass.constructor.call(this);e.mix(this,i)}e.extend(g,k._Object);return g},{requires:["event/base"]});
KISSY.add("event/custom/observable",function(e,k,g,i,h){function l(){l.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var b=h._Utils;e.extend(l,h._ObservableEvent,{constructor:l,on:function(a){a=new g(a);-1==this.findObserver(a)&&this.observers.push(a)},checkMemory:function(){var a=this.currentTarget,d=l.getCustomEvents(a);d&&(this.hasObserver()||delete d[this.type],e.isEmptyObject(d)&&delete a[c])},fire:function(a){var a=a||{},d=this.bubbles,
b=this.currentTarget,c,e=this.type,f=this.defaultFn,g,j=a,h;a.type=e;j instanceof i||(j.target=b,j=new i(j));j.currentTarget=b;a=this.notify(j);!1!==h&&(h=a);if(d&&!j.isPropagationStopped()){c=(d=k.getTargets(b,1))&&d.length||0;for(g=0;g<c&&!j.isPropagationStopped();g++)a=k.fire(d[g],e,j),!1!==h&&(h=a)}if(f&&!j.isDefaultPrevented()&&(e=l.getCustomEvent(j.target,j.type),!this.defaultTargetOnly&&!e.defaultTargetOnly||b==j.target))h=f.call(b,j);return h},notify:function(a){var d=this.observers,b,c,e=
d.length,f;for(f=0;f<e&&!a.isImmediatePropagationStopped();f++)b=d[f].notify(a,this),!1!==c&&(c=b),!1===b&&a.halt();return c},detach:function(a){var d,c=a.fn,e=a.context,g=this.currentTarget,f=this.observers,a=a.groups;if(f.length){a&&(d=b.getGroupsRe(a));var h,j,i,k,l=f.length;if(c||d){e=e||g;h=a=0;for(j=[];a<l;++a)if(i=f[a],k=i.context||g,e!=k||c&&c!=i.fn||d&&!i.groups.match(d))j[h++]=i;this.observers=j}else this.reset();this.checkMemory()}}});var c="__~ks_custom_events";l.getCustomEvent=function(a,
d,b){var c,e=l.getCustomEvents(a,b);c=e&&e[d];!c&&b&&(c=e[d]=new l({currentTarget:a,type:d}));return c};l.getCustomEvents=function(a,b){!a[c]&&b&&(a[c]={});return a[c]};return l},{requires:["./api","./observer","./object","event/base"]});KISSY.add("event/custom/observer",function(e,k){function g(){g.superclass.constructor.apply(this,arguments)}e.extend(g,k._Observer,{keys:["fn","context","groups"]});return g},{requires:["event/base"]});
