/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Mar 1 15:50
*/
KISSY.add("event/custom/api-impl",function(e,l,d,j){var h=e.trim,g=d._Utils,n=g.splitAndRun;return e.mix(l,{fire:function(c,a,b){var f=void 0,i=l.getTargets(c,1),o=i&&i.length,b=b||{};n(a,function(a){var i,a=g.getTypedGroups(a);i=a[1];a=a[0];i&&(i=g.getGroupsRe(i),b._ks_groups=i);if((i=j.getCustomEvent(c,a))||o){if(i){if(!i.hasObserver()&&!i.defaultFn&&(i.bubbles&&!o||!i.bubbles))return}else i=new j({currentTarget:c,type:a});a=i.fire(b);!1!==f&&(f=a)}});return f},publish:function(c,a,b){var f;n(a,
function(a){f=j.getCustomEvent(c,a,1);e.mix(f,b)});return c},getCustomEvent:function(c,a,b){return j.getCustomEvent(c,a,b)},addTarget:function(c,a){var b=l.getTargets(c);e.inArray(a,b)||b.push(a);return c},removeTarget:function(c,a){var b=l.getTargets(c),f=e.indexOf(a,b);-1!=f&&b.splice(f,1);return c},getTargets:function(c,a){a||(c["__~ks_bubble_targets"]=c["__~ks_bubble_targets"]||[]);return c["__~ks_bubble_targets"]},on:function(c,a,b,f){a=h(a);g.batchForType(function(a,b,f){b=g.normalizeParam(a,
b,f);a=b.type;if(a=j.getCustomEvent(c,a,1))a.on(b)},0,a,b,f);return c},detach:function(c,a,b,f){a=h(a);g.batchForType(function(a,b,f){var d=g.normalizeParam(a,b,f);(a=d.type)?(a=j.getCustomEvent(c,a,1))&&a.detach(d):(a=j.getCustomEvents(c),e.each(a,function(a){a.detach(d)}))},0,a,b,f);return c}})},{requires:["./api","event/base","./observable"]});KISSY.add("event/custom/api",function(){return{}});
KISSY.add("event/custom",function(e,l,d,j){var h={};e.each(d,function(d,j){h[j]=function(){var c=e.makeArray(arguments);c.unshift(this);return d.apply(null,c)}});d=e.mix({_ObservableCustomEvent:j,Target:h},d);e.mix(l,{Target:h,Custom:d});e.EventTarget=h;return d},{requires:["./base","./custom/api-impl","./custom/observable"]});KISSY.add("event/custom/object",function(e,l){function d(j){d.superclass.constructor.call(this);e.mix(this,j)}e.extend(d,l._Object);return d},{requires:["event/base"]});
KISSY.add("event/custom/observable",function(e,l,d,j,h){function g(){g.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var n=h._Utils;e.extend(g,h._ObservableEvent,{constructor:g,on:function(a){a=new d(a);-1==this.findObserver(a)&&this.observers.push(a)},checkMemory:function(){var a=this.currentTarget,b=g.getCustomEvents(a);b&&(this.hasObserver()||delete b[this.type],e.isEmptyObject(b)&&delete a[c])},fire:function(a){var a=a||{},b=this.bubbles,
f=this.currentTarget,c,d=this.type,e=this.defaultFn,h,k=a,m;a.type=d;k instanceof j||(k.target=f,k=new j(k));k.currentTarget=f;a=this.notify(k);!1!==m&&(m=a);if(b&&!k.isPropagationStopped()){c=(b=l.getTargets(f,1))&&b.length||0;for(h=0;h<c&&!k.isPropagationStopped();h++)a=l.fire(b[h],d,k),!1!==m&&(m=a)}if(e&&!k.isDefaultPrevented()&&(d=g.getCustomEvent(k.target,k.type),!this.defaultTargetOnly&&!d.defaultTargetOnly||f==k.target))m=e.call(f,k);return m},notify:function(a){var b=this.observers,c,i,d=
b.length,e;for(e=0;e<d&&!a.isImmediatePropagationStopped();e++)c=b[e].notify(a,this),!1!==i&&(i=c),!1===c&&a.halt();return i},detach:function(a){var b,c=a.fn,d=a.context,e=this.currentTarget,g=this.observers,a=a.groups;if(g.length){a&&(b=n.getGroupsRe(a));var j,k,h,l,p=g.length;if(c||b){d=d||e;j=a=0;for(k=[];a<p;++a)if(h=g[a],l=h.context||e,d!=l||c&&c!=h.fn||b&&!h.groups.match(b))k[j++]=h;this.observers=k}else this.reset();this.checkMemory()}}});var c="__~ks_custom_events";g.getCustomEvent=function(a,
b,c){var d,e=g.getCustomEvents(a,c);d=e&&e[b];!d&&c&&(d=e[b]=new g({currentTarget:a,type:b}));return d};g.getCustomEvents=function(a,b){!a[c]&&b&&(a[c]={});return a[c]};return g},{requires:["./api","./observer","./object","event/base"]});KISSY.add("event/custom/observer",function(e,l){function d(){d.superclass.constructor.apply(this,arguments)}e.extend(d,l._Observer,{keys:["fn","context","groups"]});return d},{requires:["event/base"]});
