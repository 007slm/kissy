/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Oct 31 22:43
*/
KISSY.add("event/dom/touch/gesture",function(h,e){var d=e.Gesture,g=h.Features,a,k,i;g.isTouchSupported?(a="touchstart",k="touchmove",i="touchend"):g.isMsPointerEnabled&&(a="MSPointerDown",k="MSPointerMove",i="MSPointerUp");a&&(d.start=a,d.move=k,d.end=i,d.tap="tap");return d},{requires:["event/dom/base"]});KISSY.add("event/dom/touch/handle-map",function(){return{}});
KISSY.add("event/dom/touch/handle",function(h,e,d,g,a){function k(b){this.doc=b;this.eventHandle={};this.init()}var i=h.guid("touch-handle"),j={};j[a.start]="onTouchStart";j[a.move]="onTouchMove";j[a.end]="onTouchEnd";"mousedown"!==a.start&&(j.touchcancel="onTouchEnd");k.prototype={init:function(){var b=this.doc,f,c;this.onTouchMove=h.throttle(this.onTouchMove,30);for(f in j){c=j[f];g.on(b,f,this[c],this)}},normalize:function(b){var f=b.type,c;if(f.indexOf("mouse")!=-1){if(b.which!=1)return;c=[b];
b.touches=f!=="mouseup"?c:[];b.targetTouches=f!=="mouseup"?c:[];b.changedTouches=c}return b},onTouchStart:function(b){var f,c;for(f in this.eventHandle){c=this.eventHandle[f];c.isActive=true}this.callEventHandle("onTouchStart",b)},onTouchMove:function(b){this.callEventHandle("onTouchMove",b)},onTouchEnd:function(b){this.callEventHandle("onTouchEnd",b)},callEventHandle:function(b,f){var c,a;if(f=this.normalize(f))for(c in this.eventHandle){a=this.eventHandle[c];if(a.isActive&&a[b](f)===false)a.isActive=
false}},addEventHandle:function(b){this.eventHandle[b]||(this.eventHandle[b]=new d[b])},removeEventHandle:function(b){delete this.eventHandle[b]},destroy:function(){var b=this.doc,a,c;for(a in j){c=j[a];g.detach(b,a,this[c],this)}}};return{addDocumentHandle:function(b,a){var c=e._getWin(b.ownerDocument||b).document,d=e.data(c,i);d||e.data(c,i,d=new k(c));d.addEventHandle(a)},removeDocumentHandle:function(b,a){var c=e._getWin(b.ownerDocument||b).document,d=e.data(c,i);if(d){d.removeEventHandle(a);
if(h.isEmptyObject(eventHandle)){d.destroy();e.removeData(c,i)}}}}},{requires:["dom","./handle-map","event/dom/base","./gesture","./tap"]});KISSY.add("event/dom/touch/tap",function(h,e,d){function g(){}g.prototype={onTouchStart:function(a){if(1<a.touches.length)return!1},onTouchMove:function(){return!1},onTouchEnd:function(a){d.fire(a.target,"tap",a)}};return e.tap=g},{requires:["./handle-map","event/dom/base"]});
KISSY.add("event/dom/touch",function(h,e,d,g){var h=e._Special,e={setup:function(a){g.addDocumentHandle(this,a)},tearDown:function(a){g.removeDocumentHandle(this,a)}},a;for(a in d)h[a]=e},{requires:["event/dom/base","./touch/handle-map","./touch/handle"]});
