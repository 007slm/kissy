/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Dec 3 15:43
*/
KISSY.add("event/dom/base/api",function(h,d,a,c,i,j,f){function l(b,a){var e=c[a]||{};b.originalType||(b.selector?e.delegateFix&&(b.originalType=a,a=e.delegateFix):e.onFix&&(b.originalType=a,a=e.onFix));return a}function m(b,a,e){var k,p,c,e=h.merge(e),a=l(e,a);k=j.getCustomEvents(b,1);if(!(c=k.handle))c=k.handle=function(b){var a=b.type,e=c.currentTarget;if(!(j.triggeredEvent==a||"undefined"==typeof KISSY))if(a=j.getCustomEvent(e,a))return b.currentTarget=e,b=new f(b),a.notify(b)},c.currentTarget=
b;if(!(p=k.events))p=k.events={};k=p[a];k||(k=p[a]=new j({type:a,fn:c,currentTarget:b}),k.setup());k.on(e);b=null}var k=d._Utils;h.mix(d,{add:function(b,g,e,c){g=h.trim(g);b=a.query(b);k.batchForType(function(b,a,e,g){e=k.normalizeParam(a,e,g);a=e.type;for(g=b.length-1;0<=g;g--)m(b[g],a,e)},1,b,g,e,c);return b},remove:function(b,g,e,c){g=h.trim(g);b=a.query(b);k.batchForType(function(b,a,e,g){e=k.normalizeParam(a,e,g);a=e.type;for(g=b.length-1;0<=g;g--){var c=b[g],d=a,o=e,o=h.merge(o),f=void 0,d=
l(o,d),c=j.getCustomEvents(c),f=(c||{}).events;if(c&&f)if(d)(f=f[d])&&f.detach(o);else for(d in f)f[d].detach(o)}},1,b,g,e,c);return b},delegate:function(b,a,e,k,c){return d.add(b,a,{fn:k,context:c,selector:e})},undelegate:function(b,a,e,k,c){return d.remove(b,a,{fn:k,context:c,selector:e})},fire:function(b,g,e,c){var d=void 0,e=e||{};e.synthetic=1;k.splitAndRun(g,function(g){e.type=g;var f,i,l,g=k.getTypedGroups(g);(i=g[1])&&(i=k.getGroupsRe(i));g=g[0];h.mix(e,{type:g,_ks_groups:i});b=a.query(b);
for(i=b.length-1;0<=i;i--)f=b[i],l=j.getCustomEvent(f,g),!c&&!l&&(l=new j({type:g,currentTarget:f})),l&&(f=l.fire(e,c),!1!==d&&(d=f))});return d},fireHandler:function(b,a,e){return d.fire(b,a,e,1)},_clone:function(b,a){var e;(e=j.getCustomEvents(b))&&h.each(e.events,function(b,e){h.each(b.observers,function(b){m(a,e,b)})})},_ObservableDOMEvent:j});d.on=d.add;d.detach=d.remove;return d},{requires:"event/base,dom,./special,./utils,./observable,./object".split(",")});
KISSY.add("event/dom/base",function(h,d,a,c,i,j){h.mix(d,{KeyCodes:a,_DOMUtils:c,Gesture:i,_Special:j});return d},{requires:"event/base,./base/key-codes,./base/utils,./base/gesture,./base/special,./base/api,./base/change,./base/submit,./base/focusin,./base/hashchange,./base/mouseenter,./base/mousewheel,./base/valuechange".split(",")});
KISSY.add("event/dom/base/change",function(h,d,a,c){var i=h.UA,j=h.Env.host.document,j=j&&j.documentMode;if(i.ie&&(9>i.ie||j&&9>j)){var f=/^(?:textarea|input|select)$/i,l=function(b){b=b.type;return"checkbox"==b||"radio"==b};c.change={setup:function(){if(f.test(this.nodeName))if(l(this))d.on(this,"propertychange",m),d.on(this,"click",k);else return!1;else d.on(this,"beforeactivate",b)},tearDown:function(){if(f.test(this.nodeName))if(l(this))d.remove(this,"propertychange",m),d.remove(this,"click",
k);else return!1;else d.remove(this,"beforeactivate",b),h.each(a.query("textarea,input,select",this),function(b){b.__changeHandler&&(b.__changeHandler=0,d.remove(b,"change",{fn:g,last:1}))})}};var m=function(b){"checked"==b.originalEvent.propertyName&&(this.__changed=1)},k=function(b){this.__changed&&(this.__changed=0,d.fire(this,"change",b))},b=function(b){b=b.target;f.test(b.nodeName)&&!b.__changeHandler&&(b.__changeHandler=1,d.on(b,"change",{fn:g,last:1}))},g=function(b){if(!b.isPropagationStopped()&&
!l(this)){var a;(a=this.parentNode)&&d.fire(a,"change",b)}}}},{requires:["./api","dom","./special"]});
KISSY.add("event/dom/base/focusin",function(h,d,a){h.UA.ie||h.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(c){function i(a){return d.fire(a.target,c.name)}var j=h.guid("attaches_"+h.now()+"_");a[c.name]={setup:function(){var a=this.ownerDocument||this;j in a||(a[j]=0);a[j]+=1;1===a[j]&&a.addEventListener(c.fix,i,!0)},tearDown:function(){var a=this.ownerDocument||this;a[j]-=1;0===a[j]&&a.removeEventListener(c.fix,i,!0)}}});a.focus={delegateFix:"focusin"};a.blur={delegateFix:"focusout"};
return d},{requires:["./api","./special"]});KISSY.add("event/dom/base/gesture",function(){return{start:"mousedown",move:"mousemove",end:"mouseup",tap:"click"}});
KISSY.add("event/dom/base/hashchange",function(h,d,a,c){var i=h.UA,j=h.Env.host,f=j.document,l=f&&f.documentMode,m="__replace_history_"+h.now(),i=l||i.ie;d.REPLACE_HISTORY=m;if(!("onhashchange"in j)||i&&8>i){var k="<html><head><title>"+(f&&f.title||"")+" - {hash}</title>{head}</head><body>{hash}</body></html>",b=function(){return"#"+(new h.Uri(location.href)).getFragment()},g,e,o=function(){var a=b(),k;if(k=h.endsWith(a,m))a=a.slice(0,-m.length),location.hash=a;a!==e&&(e=a,p(a,k));g=setTimeout(o,
50)},p=i&&8>i?function(b,g){var e=h.substitute(k,{hash:h.escapeHTML(b),head:a.isCustomDomain()?"<script>document.domain = '"+f.domain+"';<\/script>":""}),c=n.contentWindow.document;try{g?c.open("text/html","replace"):c.open(),c.write(e),c.close()}catch(d){}}:function(){d.fire(j,"hashchange")},s=function(){g||o()},u=function(){g&&clearTimeout(g);g=0},n;8>i&&(s=function(){if(!n){var k=a.getEmptyIframeSrc();n=a.create("<iframe "+(k?'src="'+k+'"':"")+' style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');
a.prepend(n,f.documentElement);d.add(n,"load",function(){d.remove(n,"load");p(b());d.add(n,"load",g);o()});f.onpropertychange=function(){try{"title"===event.propertyName&&(n.contentWindow.document.title=f.title+" - "+b())}catch(a){}};var g=function(){var a=h.trim(n.contentWindow.document.body.innerText),k=b();a!=k&&(e=location.hash=a);d.fire(j,"hashchange")}}},u=function(){g&&clearTimeout(g);g=0;d.detach(n);a.remove(n);n=0});c.hashchange={setup:function(){if(this===j){e=b();s()}},tearDown:function(){this===
j&&u()}}}},{requires:["./api","dom","./special"]});
KISSY.add("event/dom/base/key-codes",function(h){var d=h.UA,a={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,
Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,
WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(c){if(c.altKey&&!c.ctrlKey||c.metaKey||c.keyCode>=a.F1&&c.keyCode<=a.F12)return!1;switch(c.keyCode){case a.ALT:case a.CAPS_LOCK:case a.CONTEXT_MENU:case a.CTRL:case a.DOWN:case a.END:case a.ESC:case a.HOME:case a.INSERT:case a.LEFT:case a.MAC_FF_META:case a.META:case a.NUMLOCK:case a.NUM_CENTER:case a.PAGE_DOWN:case a.PAGE_UP:case a.PAUSE:case a.PRINT_SCREEN:case a.RIGHT:case a.SHIFT:case a.UP:case a.WIN_KEY:case a.WIN_KEY_RIGHT:return!1;
default:return!0}},isCharacterKey:function(c){if(c>=a.ZERO&&c<=a.NINE||c>=a.NUM_ZERO&&c<=a.NUM_MULTIPLY||c>=a.A&&c<=a.Z||d.webkit&&0==c)return!0;switch(c){case a.SPACE:case a.QUESTION_MARK:case a.NUM_PLUS:case a.NUM_MINUS:case a.NUM_PERIOD:case a.NUM_DIVISION:case a.SEMICOLON:case a.DASH:case a.EQUALS:case a.COMMA:case a.PERIOD:case a.SLASH:case a.APOSTROPHE:case a.SINGLE_QUOTE:case a.OPEN_SQUARE_BRACKET:case a.BACKSLASH:case a.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};return a});
KISSY.add("event/dom/base/mouseenter",function(h,d,a,c){h.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(d){c[d.name]={onFix:d.fix,delegateFix:d.fix,handle:function(c,d,i){var h=c.currentTarget,k=c.relatedTarget;if(!k||k!==h&&!a.contains(h,k))return[d.simpleNotify(c,i)]}}});return d},{requires:["./api","dom","./special"]});
KISSY.add("event/dom/base/mousewheel",function(h,d){var a=h.UA.gecko?"DOMMouseScroll":"mousewheel";d.mousewheel={onFix:a,delegateFix:a}},{requires:["./special"]});
KISSY.add("event/dom/base/object",function(h,d,a){function c(b){this.scale=this.rotation=this.targetTouches=this.touches=this.changedTouches=this.which=this.wheelDelta=this.view=this.toElement=this.srcElement=this.shiftKey=this.screenY=this.screenX=this.relatedTarget=this.relatedNode=this.prevValue=this.pageY=this.pageX=this.offsetY=this.offsetX=this.newValue=this.metaKey=this.keyCode=this.handler=this.fromElement=this.eventPhase=this.detail=this.data=this.ctrlKey=this.clientY=this.clientX=this.charCode=
this.cancelable=this.button=this.bubbles=this.attrName=this.attrChange=this.altKey=a;c.superclass.constructor.call(this);this.originalEvent=b;this.isDefaultPrevented=b.defaultPrevented||b.returnValue===m||b.getPreventDefault&&b.getPreventDefault()?function(){return l}:function(){return m};i(this);j(this)}function i(b){for(var g=b.originalEvent,e=k.length,c,d=g.currentTarget,d=9===d.nodeType?d:d.ownerDocument||f;e;)c=k[--e],b[c]=g[c];b.target||(b.target=b.srcElement||d);3===b.target.nodeType&&(b.target=
b.target.parentNode);!b.relatedTarget&&b.fromElement&&(b.relatedTarget=b.fromElement===b.target?b.toElement:b.fromElement);b.pageX===a&&b.clientX!==a&&(g=d.documentElement,e=d.body,b.pageX=b.clientX+(g&&g.scrollLeft||e&&e.scrollLeft||0)-(g&&g.clientLeft||e&&e.clientLeft||0),b.pageY=b.clientY+(g&&g.scrollTop||e&&e.scrollTop||0)-(g&&g.clientTop||e&&e.clientTop||0));b.which===a&&(b.which=b.charCode===a?b.keyCode:b.charCode);b.metaKey===a&&(b.metaKey=b.ctrlKey);!b.which&&b.button!==a&&(b.which=b.button&
1?1:b.button&2?3:b.button&4?2:0)}function j(b){var k,e,c,d=b.detail;b.wheelDelta&&(c=b.wheelDelta/120);b.detail&&(c=-(0==d%3?d/3:d));b.axis!==a&&(b.axis===b.HORIZONTAL_AXIS?(e=0,k=-1*c):b.axis===b.VERTICAL_AXIS&&(k=0,e=c));b.wheelDeltaY!==a&&(e=b.wheelDeltaY/120);b.wheelDeltaX!==a&&(k=-1*b.wheelDeltaX/120);!k&&!e&&(e=c);(k!==a||e!==a||c!==a)&&h.mix(b,{deltaY:e,delta:c,deltaX:k})}var f=h.Env.host.document,l=!0,m=!1,k="type,altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,pageX,pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which,axis,changedTouches,touches,targetTouches,rotation,scale".split(",");
h.extend(c,d._Object,{constructor:c,preventDefault:function(){var b=this.originalEvent;b.preventDefault?b.preventDefault():b.returnValue=m;c.superclass.preventDefault.call(this)},stopPropagation:function(){var b=this.originalEvent;b.stopPropagation?b.stopPropagation():b.cancelBubble=l;c.superclass.stopPropagation.call(this)}});return d.DOMEventObject=c},{requires:["event/base"]});
KISSY.add("event/dom/base/observable",function(h,d,a,c,i,j,f){function l(a){h.mix(this,a);this.reset()}var m=f._Utils;h.extend(l,f._ObservableEvent,{setup:function(){var k=this.type,b=a[k]||{},g=this.currentTarget,e=c.data(g).handle;(!b.setup||!1===b.setup.call(g,k))&&c.simpleAdd(g,k,e)},constructor:l,reset:function(){l.superclass.reset.call(this);this.lastCount=this.delegateCount=0},notify:function(a){var b=a.target,c=this.currentTarget,e=this.observers,j=[],h,i,f=this.delegateCount||0,n,l;if(f&&
!b.disabled)for(;b!=c;){n=[];for(i=0;i<f;i++)l=e[i],d.test(b,l.selector)&&n.push(l);n.length&&j.push({currentTarget:b,currentTargetObservers:n});b=b.parentNode||c}j.push({currentTarget:c,currentTargetObservers:e.slice(f)});i=0;for(b=j.length;!a.isPropagationStopped()&&i<b;++i){c=j[i];n=c.currentTargetObservers;c=c.currentTarget;a.currentTarget=c;for(c=0;!a.isImmediatePropagationStopped()&&c<n.length;c++)e=n[c],e=e.notify(a,this),!1!==h&&(h=e)}return h},fire:function(c,b){var c=c||{},g=this.type,e=
a[g];e&&e.onFix&&(g=e.onFix);var i,f,e=this.currentTarget,m=!0;c.type=g;c instanceof j||(f=c,c=new j({currentTarget:e,target:e}),h.mix(c,f));f=e;i=d._getWin(f.ownerDocument||f);var u=i.document,n=[],t=0,r="on"+g;do n.push(f),f=f.parentNode||f.ownerDocument||f===u&&i;while(f);f=n[t];do{c.currentTarget=f;if(i=l.getCustomEvent(f,g))i=i.notify(c),!1!==m&&(m=i);f[r]&&!1===f[r].call(f)&&c.preventDefault();f=n[++t]}while(!b&&f&&!c.isPropagationStopped());if(!b&&!c.isDefaultPrevented()){var q;try{if(r&&e[g]&&
("focus"!==g&&"blur"!==g||0!==e.offsetWidth)&&!h.isWindow(e))(q=e[r])&&(e[r]=null),l.triggeredEvent=g,e[g]()}catch(v){}q&&(e[r]=q);l.triggeredEvent=""}return m},on:function(c){var b=this.observers,d=a[this.type]||{},c=c instanceof i?c:new i(c);-1==this.findObserver(c)&&(c.selector?(b.splice(this.delegateCount,0,c),this.delegateCount++):c.last?(b.push(c),this.lastCount++):b.splice(b.length-this.lastCount,0,c),d.add&&d.add.call(this.currentTarget,c))},detach:function(c){var b,d=a[this.type]||{},e="selector"in
c,f=c.selector,i=c.context,j=c.fn,h=this.currentTarget,l=this.observers,c=c.groups;if(l.length){c&&(b=m.getGroupsRe(c));var t,r,q,v,w=l.length;if(j||e||b){i=i||h;t=c=0;for(r=[];c<w;++c)q=l[c],v=q.context||h,i!=v||j&&j!=q.fn||e&&(f&&f!=q.selector||!f&&!q.selector)||b&&!q.groups.match(b)?r[t++]=q:(q.selector&&this.delegateCount&&this.delegateCount--,q.last&&this.lastCount&&this.lastCount--,d.remove&&d.remove.call(h,q));this.observers=r}else this.reset();this.checkMemory()}},checkMemory:function(){var d=
this.type,b,g,e=a[d]||{},f=this.currentTarget,i=c.data(f);if(i&&(b=i.events,this.hasObserver()||(g=i.handle,(!e.tearDown||!1===e.tearDown.call(f,d))&&c.simpleRemove(f,d,g),delete b[d]),h.isEmptyObject(b)))i.handle=null,c.removeData(f)}});l.triggeredEvent="";l.getCustomEvent=function(a,b){var d=c.data(a),e;d&&(e=d.events);if(e)return e[b]};l.getCustomEvents=function(a,b){var d=c.data(a);!d&&b&&c.data(a,d={});return d};return l},{requires:"dom,./special,./utils,./observer,./object,event/base".split(",")});
KISSY.add("event/dom/base/observer",function(h,d,a){function c(a){c.superclass.constructor.apply(this,arguments)}h.extend(c,a._Observer,{keys:"fn,selector,data,context,originalType,groups,last".split(","),notifyInternal:function(a,c){var f,h,m=a.type;this.originalType&&(a.type=this.originalType);(f=d[a.type])&&f.handle?(f=f.handle(a,this,c))&&0<f.length&&(h=f[0]):h=this.simpleNotify(a,c);a.type=m;return h}});return c},{requires:["./special","event/base"]});KISSY.add("event/dom/base/special",function(){return{}});
KISSY.add("event/dom/base/submit",function(h,d,a,c){var i=h.UA,j=h.Env.host.document,j=j&&j.documentMode;if(i.ie&&(9>i.ie||j&&9>j)){var f=a.nodeName;c.submit={setup:function(){if("form"==f(this))return!1;d.on(this,"click keypress",l)},tearDown:function(){if("form"==f(this))return!1;d.remove(this,"click keypress",l);h.each(a.query("form",this),function(a){a.__submit__fix&&(a.__submit__fix=0,d.remove(a,"submit",{fn:m,last:1}))})}};var l=function(a){var a=a.target,b=f(a);if((a="input"==b||"button"==
b?a.form:null)&&!a.__submit__fix)a.__submit__fix=1,d.on(a,"submit",{fn:m,last:1})},m=function(a){this.parentNode&&!a.isPropagationStopped()&&!a.synthetic&&d.fire(this.parentNode,"submit",a)}}},{requires:["./api","dom","./special"]});
KISSY.add("event/dom/base/utils",function(h,d){var a=h.Env.host.document;return{simpleAdd:a&&a.addEventListener?function(a,d,h,f){a.addEventListener&&a.addEventListener(d,h,!!f)}:function(a,d,h){a.attachEvent&&a.attachEvent("on"+d,h)},simpleRemove:a&&a.removeEventListener?function(a,d,h,f){a.removeEventListener&&a.removeEventListener(d,h,!!f)}:function(a,d,h){a.detachEvent&&a.detachEvent("on"+d,h)},data:function(a,h){return d.data(a,"ksEventTargetId_1.30",h)},removeData:function(a){return d.removeData(a,
"ksEventTargetId_1.30")}}},{requires:["dom"]});
KISSY.add("event/dom/base/valuechange",function(h,d,a,c){function i(b){if(a.hasData(b,p)){var c=a.data(b,p);clearTimeout(c);a.removeData(b,p)}}function j(a){i(a.target)}function f(b){var c=b.value,e=a.data(b,o);c!==e&&(d.fireHandler(b,g,{prevVal:e,newVal:c}),a.data(b,o,c))}function l(b){a.hasData(b,p)||a.data(b,p,setTimeout(function(){f(b);a.data(b,p,setTimeout(arguments.callee,s))},s))}function m(b){var c=b.target;"focus"==b.type&&a.data(c,o,c.value);l(c)}function k(a){f(a.target)}function b(b){a.removeData(b,
o);i(b);d.remove(b,"blur",j);d.remove(b,"webkitspeechchange",k);d.remove(b,"mousedown keyup keydown focus",m)}var g="valuechange",e=a.nodeName,o="event/valuechange/history",p="event/valuechange/poll",s=50;c[g]={setup:function(){var a=e(this);if("input"==a||"textarea"==a)b(this),d.on(this,"blur",j),d.on(this,"webkitspeechchange",k),d.on(this,"mousedown keyup keydown focus",m)},tearDown:function(){b(this)}};return d},{requires:["./api","dom","./special"]});
