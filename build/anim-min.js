/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("anim/base",function(g,e,n,f,o,p,a){function k(b,d,c,i,h,j){if(!(b=e.get(b)))return a;if(!(this instanceof k))return new k(b,d,c,i,h,j);var q=g.isPlainObject(c);d=d;this.domEl=b;if(g.isPlainObject(d))d=String(g.param(d,";")).replace(/=/g,":").replace(/%23/g,"#").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();var r=d,s=b;b={};var w=y.length,x=e.insertAfter(s.cloneNode(false),s);s=x.style;for(m(x,r);w--;){r=y[w];if(s[r])b[r]=(k.PROP_OPS[r]||k.PROP_OPS["*"]).getter(x,r)}e.remove(x);this.props=
b;this.targetStyle=d;if(q)q=g.merge(t,c);else{q=g.clone(t);if(c)q.duration=parseFloat(c)||1;if(g.isString(i)||g.isFunction(i))q.easing=i;if(g.isFunction(h))q.complete=h;if(j!==a)q.nativeSupport=j}this.config=q;if(q.nativeSupport&&z()&&g.isString(i=q.easing))if(/cubic-bezier\([\s\d.,]+\)/.test(i)||(i=f.NativeTimeFunction[i])){q.easing=i;this.transitionName=z()}if(g.isFunction(h))this.callback=h;return a}function l(b,d){return d}function m(b,d){if(o.ie&&d.indexOf(u)>-1){var c=d.match(/opacity\s*:\s*([^;]+)(;|$)/);
c&&e.css(b,u,parseFloat(c[1]))}b.style.cssText+=";"+d}var y,u,t,v;n=n.Target;y="backgroundColor borderBottomColor borderBottomWidth borderBottomStyle borderLeftColor borderLeftWidth borderLeftStyle borderRightColor borderRightWidth borderRightStyle borderSpacing borderTopColor borderTopWidth borderTopStyle bottom color fontFamily fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex".split(" ");
u="opacity";t={duration:1,easing:"easeNone",nativeSupport:true};k.PROPS=y;k.PROP_OPS={"*":{getter:function(b,d){var c=e.css(b,d),i=parseFloat(c);c=(c+"").replace(/^[-\d.]+/,"");if(isNaN(i))return{v:c,u:"",f:l};return{v:i,u:c,f:this.interpolate}},setter:function(b,d,c){return e.css(b,d,c)},interpolate:function(b,d,c){return(b+(d-b)*c).toFixed(3)}}};g.augment(k,n,{isRunning:false,elapsedTime:0,start:0,finish:0,duration:0,run:function(){var b=this.config,d=this.domEl,c,i=this.props,h={},j;if(this.fire("start")!==
false){this.stop();this.duration=c=b.duration*1E3;if(this.transitionName)this._nativeRun();else{for(j in i)h[j]=(k.PROP_OPS[j]||k.PROP_OPS["*"]).getter(d,j);this.source=h;d=g.now();c=d+c;b=b.easing;if(g.isString(b))b=f[b]||f.easeNone;this.start=d;this.finish=c;this.easing=b;p.start(this)}this.isRunning=true;return this}},_complete:function(){this.fire("complete");this.callback&&this.callback()},_runFrame:function(){var b=this.domEl,d=this.finish,c=this.start,i=this.duration,h=g.now(),j=this.source,
q=this.easing,r=this.props,s;c=h-c;i=h>d?1:c/i;var w,x;this.elapsedTime=c;for(s in r){c=j[s];w=r[s];if(w.v==0)w.u=c.u;if(c.u!==w.u){c.v=0;c.u=w.u}c=w.f(c.v,w.v,q(i))+w.u;(k.PROP_OPS[s]||k.PROP_OPS["*"]).setter(b,s,c)}if(this.fire("step")===false||(x=h>d)){this.stop();x&&this._complete()}},_nativeRun:function(){var b=this,d=b.domEl,c=b.duration,i=b.config.easing,h=b.transitionName,j={};j[h+"Property"]="all";j[h+"Duration"]=c+"ms";j[h+"TimingFunction"]=i;e.css(d,j);g.later(function(){m(d,b.targetStyle)},
0);g.later(function(){b.stop(true)},c)},stop:function(b){if(this.transitionName)this._nativeStop(b);else{if(b){m(this.domEl,this.targetStyle);this._complete()}p.stop(this)}this.isRunning=false;return this},_nativeStop:function(b){var d=this.domEl,c=this.transitionName,i=this.props,h;if(b){e.css(d,c+"Property","none");this._complete()}else{for(h in i)e.css(d,h,e._getComputedStyle(d,h));e.css(d,c+"Property","none")}}});k.supportTransition=function(){if(v)return v;var b="transition",d,c=document.body;
if(c.style[b]!==a)d=b;else g.each(["Webkit","Moz","O"],function(i){if(c.style[b=i+"Transition"]!==a){d=b;return false}});return v=d};var z=k.supportTransition;return k},{requires:["dom","event","./easing","ua","./manager"]});
KISSY.add("anim/color",function(g,e,n){var f=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,o=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i,p=n.PROP_OPS;n=n.PROPS;p.color={getter:function(a,k){var l;var m=e.css(a,k);if(l=m.match(f))l=[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])];else if(l=m.match(o)){for(m=1;m<l.length;m++)if(l[m].length<2)l[m]+=l[m];l=[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}else l=[255,255,255];return{v:l,u:"",f:this.interpolate}},setter:p["*"].setter,
interpolate:function(a,k,l){var m=p["*"].interpolate;return"rgb("+[Math.floor(m(a[0],k[0],l)),Math.floor(m(a[1],k[1],l)),Math.floor(m(a[2],k[2],l))].join(", ")+")"}};g.each(n,function(a){if(a.match(/color$/i))p[a]=p.color})},{requires:["dom","./base"]});
KISSY.add("anim/easing",function(){var g=Math,e=g.PI,n=g.pow,f=g.sin,o=1.70158,p={easeNone:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return(2-a)*a},easeBoth:function(a){return(a*=2)<1?0.5*a*a:0.5*(1- --a*(a-2))},easeInStrong:function(a){return a*a*a*a},easeOutStrong:function(a){return 1- --a*a*a*a},easeBothStrong:function(a){return(a*=2)<1?0.5*a*a*a*a:0.5*(2-(a-=2)*a*a*a)},elasticIn:function(a){if(a===0||a===1)return a;return-(n(2,10*(a-=1))*f((a-0.075)*2*e/0.3))},elasticOut:function(a){if(a===
0||a===1)return a;return n(2,-10*a)*f((a-0.075)*2*e/0.3)+1},elasticBoth:function(a){if(a===0||(a*=2)===2)return a;if(a<1)return-0.5*n(2,10*(a-=1))*f((a-0.1125)*2*e/0.45);return n(2,-10*(a-=1))*f((a-0.1125)*2*e/0.45)*0.5+1},backIn:function(a){if(a===1)a-=0.0010;return a*a*((o+1)*a-o)},backOut:function(a){return(a-=1)*a*((o+1)*a+o)+1},backBoth:function(a){if((a*=2)<1)return 0.5*a*a*(((o*=1.525)+1)*a-o);return 0.5*((a-=2)*a*(((o*=1.525)+1)*a+o)+2)},bounceIn:function(a){return 1-p.bounceOut(1-a)},bounceOut:function(a){return a<
1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bounceBoth:function(a){if(a<0.5)return p.bounceIn(a*2)*0.5;return p.bounceOut(a*2-1)*0.5+0.5}};p.NativeTimeFunction={easeNone:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeBoth:"ease-in-out",easeInStrong:"cubic-bezier(0.9, 0.0, 0.9, 0.5)",easeOutStrong:"cubic-bezier(0.1, 0.5, 0.1, 1.0)",easeBothStrong:"cubic-bezier(0.9, 0.0, 0.1, 1.0)"};return p});
KISSY.add("anim/manager",function(g){function e(f){f[n]=f[n]||g.guid("anim-");return f[n]}var n=g.guid("anim-");return{interval:20,runnings:{},timer:null,start:function(f){var o=e(f);if(!this.runnings[o]){this.runnings[o]=f;this.startTimer()}},stop:function(f){this.notRun(f)},notRun:function(f){delete this.runnings[e(f)];g.isEmptyObject(this.runnings)&&this.stopTimer()},pause:function(f){this.notRun(f)},resume:function(f){this.start(f)},startTimer:function(){var f=this;if(!f.timer)f.timer=setTimeout(function(){if(f.runFrames())f.stopTimer();
else{f.timer=null;f.startTimer()}},f.interval)},stopTimer:function(){var f=this.timer;if(f){clearTimeout(f);this.timer=null}},runFrames:function(){var f=true,o=this.runnings,p;for(p in o)if(o.hasOwnProperty(p)){f=false;o[p]._runFrame()}return f}}});
KISSY.add("anim/node-plugin",function(g,e,n,f,o){function p(b,d,c,i,h){if(d==="toggle"){h=e.css(b,k)===l?1:0;d="show"}if(h)e.css(b,k,e.data(b,k)||"");var j={},q={};g.each(z[d],function(r){if(r===m){j[m]=e.css(b,m);e.css(b,m,y)}else if(r===u){j[u]=e.css(b,u);q.opacity=h?1:0;h&&e.css(b,u,0)}else if(r===t){j[t]=e.css(b,t);q.height=h?e.css(b,t)||b.naturalHeight:0;h&&e.css(b,t,0)}else if(r===v){j[v]=e.css(b,v);q.width=h?e.css(b,v)||b.naturalWidth:0;h&&e.css(b,v,0)}});(new n(b,q,c,"easeOut",function(){if(!h){var r=
b.style,s=r[k];if(s!==l){s&&e.data(b,k,s);r[k]=l}j[t]&&e.css(b,{height:j[t]});j[v]&&e.css(b,{width:j[v]});j[u]&&e.css(b,{opacity:j[u]});j[m]&&e.css(b,{overflow:j[m]})}i&&g.isFunction(i)&&i()})).run()}f=g.require("node/node").prototype;var a=g.require("node/nodelist").prototype,k="display",l="none",m="overflow",y="hidden",u="opacity",t="height",v="width",z={show:[m,u,t,v],fade:[u],slide:[m,t]};g.each([f,a],function(b){b.animate=function(){var d=g.makeArray(arguments);g.each(this,function(c){n.apply(o,
[c].concat(d)).run()});return this};g.each({show:["show",1],hide:["show",0],toggle:["toggle"],fadeIn:["fade",1],fadeOut:["fade",0],slideDown:["slide",1],slideUp:["slide",0]},function(d,c){b[c]=function(i,h){e[c]&&arguments.length===0?e[c](this):g.each(this,function(j){p(j,d[0],i,h,d[1])});return this}})})},{requires:["dom","anim/base","node"]});KISSY.add("anim",function(g,e,n){e.Easing=n;return e},{requires:["anim/base","anim/easing","anim/node-plugin","anim/color"]});
