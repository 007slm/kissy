/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Oct 17 12:20
*/
KISSY.add("switchable/accordion/aria",function(e,b,j,k,l,h){function n(a){var c=null;e.each(this.triggers,function(i){if(i==a||b.contains(i,a))c=i});return c}function m(a){var c=null;e.each(this.panels,function(i){if(i==a||b.contains(i,a))c=i});return c}function p(a){var c=n.call(this,a);c||(a=m.call(this,a),c=this.triggers[e.indexOf(a,this.panels)]);return c}function f(a){switch(a.keyCode){case s:case t:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case q:a.ctrlKey&&!a.altKey&&a.halt()}}function d(i){var b=
i.target,f=this.triggers,d=!i.ctrlKey&&!i.shiftKey&&!i.altKey,m=i.ctrlKey&&!i.shiftKey&&!i.altKey;switch(i.keyCode){case z:case A:if((b=n.call(this,b))&&d)this.switchTo(e.indexOf(b,this.triggers)),i.halt();break;case o:case x:if(b=n.call(this,b))a.call(this,b),i.halt();break;case w:case v:if(b=n.call(this,b))c.call(this,b),i.halt();break;case t:m&&(i.halt(),b=p.call(this,b),c.call(this,b));break;case s:m&&(i.halt(),b=p.call(this,b),a.call(this,b));break;case r:d&&(p.call(this,b),g.call(this,0,!0),
i.halt());break;case u:d&&(p.call(this,b),g.call(this,f.length-1,!0),i.halt());break;case q:i.ctrlKey&&!i.altKey&&(i.halt(),b=p.call(this,b),i.shiftKey?a.call(this,b):c.call(this,b))}}function g(a,c){var i=this.triggers,q=i[a];e.each(i,function(a){a!==q&&(y(a,"-1"),b.removeClass(a,"ks-switchable-select"),a.setAttribute("aria-selected","false"))});c&&q.focus();y(q,"0");b.addClass(q,"ks-switchable-select");q.setAttribute("aria-selected","true")}function a(a){var c=this.triggers,a=e.indexOf(a,c);g.call(this,
0==a?c.length-1:a-1,!0)}function c(a){var c=this.triggers,a=e.indexOf(a,c);g.call(this,a==c.length-1?0:a+1,!0)}function i(a){var c=!(!a.originalEvent.target&&!a.originalEvent.srcElement),a=a.currentIndex,i=this.panels,b=this.triggers,q=b[a],s=i[a];this.config.multiple||(e.each(i,function(a){a!==s&&a.setAttribute("aria-hidden","true")}),e.each(b,function(a){a!==q&&a.setAttribute("aria-hidden","true")}));i=s.getAttribute("aria-hidden");s.setAttribute("aria-hidden","false"==i?"true":"false");q.setAttribute("aria-expanded",
"false"==i?"false":"true");g.call(this,a,c)}var s=33,t=34,u=35,r=36,o=37,x=38,w=39,v=40,q=9,A=32,z=13;e.mix(l.Config,{aria:!0});h.addPlugin({name:"aria",init:function(a){if(a.config.aria){var c=a.container,q=a.activeIndex;b.attr(c,"aria-multiselectable",a.config.multiple?"true":"false");a.nav&&b.attr(a.nav,"role","tablist");var s=a.triggers,o=a.panels,m=0;e.each(o,function(a){a.id||(a.id=e.guid("ks-accordion-tab-panel"))});e.each(s,function(a){a.id||(a.id=e.guid("ks-accordion-tab"))});e.each(s,function(a){a.setAttribute("role",
"tab");a.setAttribute("aria-expanded",q==m?"true":"false");a.setAttribute("aria-selected",q==m?"true":"false");a.setAttribute("aria-controls",o[m].id);y(a,q==m?"0":"-1");m++});m=0;e.each(o,function(a){var c=s[m];a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden",q==m?"false":"true");a.setAttribute("aria-labelledby",c.id);m++});a.on("switch",i,a);j.on(c,"keydown",d,a);j.on(c,"keypress",f,a)}}},l);var y=k.setTabIndex},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/accordion/base",function(e,b,j){function k(b,e){if(!(this instanceof k))return new k(b,e);k.superclass.constructor.apply(this,arguments)}e.extend(k,j,{_switchTrigger:function(e,h){var j=this.config;j.multiple?b.toggleClass(h,j.activeTriggerCls):k.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(b){return this.config.multiple||k.superclass._triggerIsValid.call(this,b)},_switchView:function(e,h,j){var m=this.config,p=this._getFromToPanels().toPanels;m.multiple?
(b.toggle(p),this._fireOnSwitch(h),j&&j.call(this)):k.superclass._switchView.apply(this,arguments)}});k.Config={markupType:1,triggerType:"click",multiple:!1};return k},{requires:["dom","../base"]});
KISSY.add("switchable/aria",function(e,b,j,k){function l(){this.stop&&this.stop()}function h(){this.start&&this.start()}k.addPlugin({name:"aria",init:function(b){if(b.config.aria){var e=b.container;j.on(e,"focusin",l,b);j.on(e,"focusout",h,b)}}});var n=["a","input","button","object"];return{setTabIndex:function(m,p){m.tabIndex=p;e.each(b.query("*",m),function(f){var d=f.nodeName.toLowerCase();e.inArray(d,n)&&(b.hasAttr(f,"oriTabIndex")||b.attr(f,"oriTabIndex",f.tabIndex),f.tabIndex=-1!=p?b.attr(f,
"oriTabIndex"):p)})}}},{requires:["dom","event","./base"]});
KISSY.add("switchable/autoplay",function(e,b,j,k,l){var h=e.Env.host,n=function(m){var e=b.scrollTop(),f=b.viewportHeight(),d=b.offset(m),m=b.height(m);return d.top>e&&d.top+m<e+f};e.mix(k.Config,{pauseOnScroll:!1,autoplay:!1,interval:5,pauseOnHover:!0});k.addPlugin({name:"autoplay",init:function(b){function k(){g=e.later(function(){b.paused||b.next()},d,!0)}var f=b.config,d=1E3*f.interval,g;if(f.autoplay&&(f.pauseOnScroll&&(b.__scrollDetect=e.buffer(function(){b[n(b.container)?"start":"stop"]()},
200),j.on(h,"scroll",b.__scrollDetect)),k(),b.stop=function(){if(g){g.cancel();g=l}b.paused=true},b.start=function(){if(g){g.cancel();g=l}b.paused=false;k()},f.pauseOnHover))j.on(b.container,"mouseenter",b.stop,b),j.on(b.container,"mouseleave",b.start,b)},destroy:function(b){b.__scrollDetect&&j.remove(h,"scroll",b.__scrollDetect)}});return k},{requires:["dom","event","./base"]});
KISSY.add("switchable/base",function(e,b,j,k){function l(a,c){this._triggerInternalCls=e.guid(d);this._panelInternalCls=e.guid(g);c=c||{};"markupType"in c||(c.panelCls?c.markupType=1:c.panels&&(c.markupType=2));for(var i=this.constructor;i;)c=e.merge(i.Config,c),i=i.superclass?i.superclass.constructor:null;this.container=b.get(a);this.config=c;this.activeIndex=c.activeIndex;var s;-1<this.activeIndex||("number"==typeof c.switchTo?s=c.switchTo:this.activeIndex=0);this._init();this._initPlugins();this.fire(p);
s!==k&&this.switchTo(s)}function h(a){var c={};c.type=a.type;c.target=a.target;return{originalEvent:c}}var n=e.makeArray,m=j.Target,p="init",f="remove",d="ks-switchable-trigger-internal",g="ks-switchable-panel-internal";l.getDomEvent=h;l.addPlugin=function(a,c){for(var c=c||l,b=a.priority=a.priority||0,s=0,d=c.Plugins=c.Plugins||[];s<d.length&&!(d[s].priority<b);s++);d.splice(s,0,a)};l.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",
panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:!0,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:k,steps:1,viewSize:[]};e.augment(l,m,{_initPlugins:function(){for(var a=this,c=[],b=a.constructor;b;)b.Plugins&&c.push.apply(c,[].concat(b.Plugins).reverse()),b=b.superclass?b.superclass.constructor:null;c.reverse();e.each(c,function(c){c.init&&c.init(a)})},_init:function(){var a=this.config;this._parseMarkup();a.hasTriggers&&this._bindTriggers();this._bindPanels()},
_parseMarkup:function(){var a=this.container,c=this.config,i,s,d=[],f=[];switch(c.markupType){case 0:(i=b.get("."+c.navCls,a))&&(d=b.children(i));s=b.get("."+c.contentCls,a);f=b.children(s);break;case 1:d=b.query("."+c.triggerCls,a);f=b.query("."+c.panelCls,a);break;case 2:d=c.triggers,f=c.panels}this.length=Math.ceil(f.length/c.steps);this.nav=i||c.hasTriggers&&d[0]&&d[0].parentNode;if(c.hasTriggers&&(!this.nav||0==d.length))d=this._generateTriggersMarkup(this.length);this.triggers=n(d);this.panels=
n(f);this.content=s||f[0].parentNode},_generateTriggersMarkup:function(a){var c=this.config,i=this.nav||b.create("<ul>"),d,f;i.className=c.navCls;for(f=0;f<a;f++)d=b.create("<li>"),f===this.activeIndex&&(d.className=c.activeTriggerCls),d.innerHTML=f+1,i.appendChild(d);this.container.appendChild(i);this.nav=i;return b.children(i)},_bindTriggers:function(){var a=this,c=a.config,b=a._triggerInternalCls,d=e.one(a.nav);e.each(a.triggers,function(c){a._initTrigger(c)});d.delegate("click","."+b,function(c){var b=
a._getTriggerIndex(c.currentTarget);a._onFocusTrigger(b,c)});"mouse"===c.triggerType&&d.delegate("mouseenter","."+b,function(c){var b=a._getTriggerIndex(c.currentTarget);a._onMouseEnterTrigger(b,c)}).delegate("mouseleave","."+b,function(){a._onMouseLeaveTrigger()})},_initTrigger:function(a){b.addClass(a,this._triggerInternalCls)},_bindPanels:function(){var a=this;e.each(a.panels,function(c){a._initPanel(c)})},_initPanel:function(a){b.addClass(a,this._panelInternalCls)},_onFocusTrigger:function(a,
c){this._triggerIsValid(a)&&(this._cancelSwitchTimer(),this.switchTo(a,k,h(c)))},_onMouseEnterTrigger:function(a,c){var b=this;if(b._triggerIsValid(a)){var d=h(c);b.switchTimer=e.later(function(){b.switchTo(a,k,d)},1E3*b.config.delay)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(a){return this.activeIndex!==a},_cancelSwitchTimer:function(){this.switchTimer&&(this.switchTimer.cancel(),this.switchTimer=k)},_getTriggerIndex:function(a){return e.indexOf(a,this.triggers)},
_resetLength:function(){this.length=this._getLength()},_getLength:function(a){var c=this.config;a===k&&(a=this.panels.length);return Math.ceil(a/c.steps)},_afterAdd:function(a,c,b){this._resetLength();a=this._getLength(a+1)-1;1==this.config.steps&&this.activeIndex>=a&&(this.activeIndex+=1);var d=this.activeIndex;this.activeIndex=-1;this.switchTo(d);c?this.switchTo(a,k,k,b):b()},add:function(a){var c=a.callback||e.noop,i=this.nav,d=this.content,f=a.trigger,g=a.panel,m=a.active,o=this.panels.length,
a=null!=a.index?a.index:o,k=this.triggers,h=this.panels,v=this.length,q=null,q=null,a=Math.max(0,Math.min(a,o)),o=h[a]||null;h.splice(a,0,g);d.insertBefore(g,o);1==this.config.steps?(q=k[a],i.insertBefore(f,q),k.splice(a,0,f)):(q=this._getLength(),q!=v&&(b.append(f,i),k.push(f)));this._initPanel(g);this._initTrigger(f);this._afterAdd(a,m,c);this.fire("add",{index:a,trigger:f,panel:g})},remove:function(a){function c(){v&&(b.remove(v),o.splice(h,1));if(j){b.remove(j);for(var a=0;a<p.length;a++)if(p[a]==
j){d.triggers.splice(a,1);break}}d._resetLength();d.fire(f,{index:h,trigger:j,panel:v})}var i=a.callback||e.noop,d=this,g=d.config.steps,m=d.length,h,o=d.panels;h="index"in a?a.index:a.panel;var a=d._getLength(o.length-1),p=d.triggers,j=null,v=null;if(o.length&&(h=e.isNumber(h)?Math.max(0,Math.min(h,o.length-1)):e.indexOf(h,o),j=1==g?p[h]:a!==m?p[m-1]:null,v=o[h],!1!==d.fire("beforeRemove",{index:h,panel:v,trigger:j})))if(0==a)c(),i();else{var q=d.activeIndex;1<g?q==a?d.switchTo(q-1,k,k,function(){c();
i()}):(c(),d.activeIndex=-1,d.switchTo(q,k,k,function(){i()})):q==h?d.switchTo(0<q?q-1:q+1,k,k,function(){c();0==q&&(d.activeIndex=0);i()}):(q>h&&(q--,d.activeIndex=q),c(),i())}},switchTo:function(a,c,b,d){var f=this,e=f.config,g=f.activeIndex,o=f.triggers;if(!f._triggerIsValid(a)||!1===f.fire("beforeSwitch",{fromIndex:g,toIndex:a}))return f;f.fromIndex=g;e.hasTriggers&&f._switchTrigger(o[g]||null,o[a]);c===k&&(c=a>g?"forward":"backward");f.activeIndex=a;f._switchView(c,b,function(){d&&d.call(f)});
return f},_switchTrigger:function(a,c){var d=this.config.activeTriggerCls;a&&b.removeClass(a,d);b.addClass(c,d)},_getFromToPanels:function(){var a=this.fromIndex,c;c=this.config.steps;var b=this.panels,d=this.activeIndex,a=-1<a?b.slice(a*c,(a+1)*c):null;c=b.slice(d*c,(d+1)*c);return{fromPanels:a,toPanels:c}},_switchView:function(a,c,d){var f=this,g=f._getFromToPanels(),a=g.fromPanels,g=g.toPanels;a&&b.css(a,"display","none");b.css(g,"display","block");setTimeout(function(){f._fireOnSwitch(c)},0);
d&&d.call(this)},_fireOnSwitch:function(a){this.fire("switch",e.merge(a,{fromIndex:this.fromIndex,currentIndex:this.activeIndex}))},prev:function(a){this.switchTo((this.activeIndex-1+this.length)%this.length,"backward",a)},next:function(a){this.switchTo((this.activeIndex+1)%this.length,"forward",a)},destroy:function(a){for(var c=this,d=c.constructor;d;)e.each(d.Plugins,function(a){a.destroy&&a.destroy(c)}),d=d.superclass?d.superclass.constructor:null;a?j.remove(c.container):b.remove(c.container);
c.nav=null;c.content=null;c.container=null;c.triggers=[];c.panels=[];c.detach()}});return l},{requires:["dom","event"]});
KISSY.add("switchable/carousel/aria",function(e,b,j,k,l,h){function n(a){var b=a.currentIndex,c=this.activeIndex,d=this.panels,f=d[b*this.config.steps],i=this.triggers,b=i[b];if((a=!(!a.originalEvent.target&&!a.originalEvent.srcElement))||-1==c)e.each(i,function(a){r(a,-1)}),e.each(d,function(a){r(a,-1)}),b&&r(b,0),r(f,0),a&&f.focus()}function m(a){var c=null;e.each(this.triggers,function(d){if(d==a||b.contains(d,a))return c=d,!1});return c}function p(d){var f=d.target;switch(d.keyCode){case s:case i:if(f=
m.call(this,f)){var g=b.next(f),h=this.triggers;g||(g=h[0]);r(f,-1);g&&(r(g,0),g.focus());d.halt()}break;case c:case a:if(f=m.call(this,f))g=b.prev(f),h=this.triggers,g||(g=h[h.length-1]),r(f,-1),g&&(r(g,0),g.focus()),d.halt();break;case u:case t:if(f=m.call(this,f))this.switchTo(e.indexOf(f,this.triggers),void 0,o),d.halt()}}function f(a){var c=null;e.each(this.panels,function(d){if(d==a||b.contains(d,a))return c=d,!1});return c}function d(a,c){var b=e.indexOf(a,this.panels),d=this.config.steps,
f=Math.floor(b/d);return f==this.activeIndex?1:0==b%d||b%d==d-1?(this.switchTo(f,c,o),0):1}function g(g){var e=g.target;switch(g.keyCode){case s:case i:if(e=f.call(this,e)){var o=b.next(e),h=this.panels;o||(o=h[0]);r(e,-1);r(o,0);d.call(this,o,x)&&o.focus();g.halt()}break;case c:case a:if(e=f.call(this,e))o=b.prev(e),h=this.panels,o||(o=h[h.length-1]),r(e,-1),r(o,0),d.call(this,o,w)&&o.focus(),g.halt();break;case u:case t:if(e=f.call(this,e))this.fire("itemSelected",{item:e}),g.halt()}}var a=37,c=
38,i=39,s=40,t=32,u=13,r=k.setTabIndex,o={originalEvent:{target:1}},x="forward",w="backward";e.mix(l.Config,{aria:!1});h.addPlugin({name:"aria",init:function(a){if(a.config.aria){var b=a.triggers,c=a.panels,d=a.content,f=a.activeIndex;d.id||(d.id=e.guid("ks-switchbale-content"));d.setAttribute("role","listbox");var i=0;e.each(b,function(a){r(a,f==i?"0":"-1");a.setAttribute("role","button");a.setAttribute("aria-controls",d.id);i++});i=0;e.each(c,function(a){r(a,"-1");a.setAttribute("role","option");
i++});a.on("switch",n,a);if(b=a.nav)j.on(b,"keydown",p,a);j.on(d,"keydown",g,a);b=a.prevBtn;c=a.nextBtn;b&&(r(b,0),b.setAttribute("role","button"),j.on(b,"keydown",function(b){if(b.keyCode==u||b.keyCode==t){a.prev(o);b.preventDefault()}}));c&&(r(c,0),c.setAttribute("role","button"),j.on(c,"keydown",function(b){if(b.keyCode==u||b.keyCode==t){a.next(o);b.preventDefault()}}))}}},l)},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/carousel/base",function(e,b,j,k){function l(b,f){if(!(this instanceof l))return new l(b,f);l.superclass.constructor.apply(this,arguments)}var h="prevBtn",n="nextBtn",m={originalEvent:{target:1}};l.Config={circular:!0,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};e.extend(l,k,{_init:function(){function k(a){b.removeClass([f[h],f[n]],g);0==a&&b.addClass(f[h],g);a==f.length-1&&b.addClass(f[n],g)}var f=this;l.superclass._init.call(f);
var d=f.config,g=d.disableBtnCls;e.each(["prev","next"],function(a){var c=f[a+"Btn"]=b.get("."+d[a+"BtnCls"],f.container);j.on(c,"mousedown",function(b){b.preventDefault();b=f.activeIndex;if("prev"==a&&(0!=b||d.circular))f[a](m);if("next"==a&&(b!=f.length-1||d.circular))f[a](m)})});d.circular||(f.on("added removed",function(){k(f.activeIndex)}),f.on("switch",function(a){k(a.currentIndex)}));j.delegate(f.content,"click","."+f._panelInternalCls,function(a){f.fire("itemSelected",{item:a.currentTarget})})}});
return l},{requires:["dom","event","../base"]});
KISSY.add("switchable/circular",function(e,b,j,k){function l(f){var d=this,g=d.fromIndex,a=d.config,c=d.length,i="scrollx"===a.scrollType,e=i?"left":"top",h=d.activeIndex,i=d.viewSize[i?0:1],m=d.panels,k={},o={},l,n=d._realStep;l=i*c;k[e]=-i*h;-1==g?(b.css(d.content,k),f&&f()):(h+n>c?(o={position:"relative"},o[e]=l,l=h+n-c,b.css(m.slice(0,l),o),b.css(m.slice(l,n),p)):b.css(m.slice(0,n),p),m=b.css(m[g],"position"),(g+c-h)%c<(h-g+c)%c&&"relative"==m?b.css(d.content,e,-(i*(c+g))):g==c-1&&0==h?b.css(d.content,
e,i):b.css(d.content,e,-(i*g)),d.anim&&d.anim.stop(),d.anim=(new j(d.content,k,a.duration,a.easing,function(){d.anim=0;f&&f()})).run())}function h(f,d){var g=this,a=g.fromIndex,c=g.config,e=g.length,h="scrollx"===c.scrollType,k=h?"left":"top",p=g.activeIndex,l=g.viewSize[h?0:1],h=-l*p,o=g.panels,x=g.config.steps,w={},v,q="backward"===d;v=q&&0===a&&p===e-1||!q&&a===e-1&&0===p;g.anim&&(g.anim.stop(),"relative"==o[a*x].style.position&&m.call(g,o,a,k,l,1));v&&(h=n.call(g,o,p,k,l));w[k]=h+"px";-1<a?g.anim=
(new j(g.content,w,c.duration,c.easing,function(){v&&m.call(g,o,p,k,l,1);g.anim=void 0;f&&f()})).run():(b.css(g.content,w),f&&f())}function n(f,d,g,a){var c=this.config.steps,e=this.length,f=f.slice(d*c,(d+1)*c);b.css(f,"position","relative");b.css(f,g,(d?-1:1)*a*e);return d?a:-a*e}function m(f,d,g,a,c){var e=this.config.steps,h=this.length,f=f.slice(d*e,(d+1)*e);b.css(f,"position","");b.css(f,g,"");c&&b.css(this.content,g,d?-a*(h-1):"")}var p={position:"",left:"",top:""};e.mix(k.Config,{circular:!1});
k.adjustPosition=n;k.resetPosition=m;k.addPlugin({name:"circular",priority:5,init:function(f){var d=f.config,e,a,c,i,m=d.effect;if(d.circular&&("scrollx"===m||"scrolly"===m))if(d.scrollType=m,a=f.panels,c=f.container,1==d.steps&&a.length&&(e=1,i=f.viewSize,a=a[0].parentNode.parentNode,c=[Math.min(b.width(c),b.width(a)),Math.min(b.height(c),b.height(a))],"scrollx"==m?e=Math.floor(c[0]/i[0]):"scrolly"==m&&(e=Math.floor(c[1]/i[1])),e>d.steps&&(f._realStep=e,d.effect=l)),!f._realStep)d.effect=h}})},{requires:["dom",
"anim","./base","./effect"]});
KISSY.add("switchable/effect",function(e,b,j,k,l,h){var n;e.mix(l.Config,{effect:"none",duration:0.5,easing:"easeNone"});l.Effects={none:function(e){var h=this._getFromToPanels(),f=h.fromPanels,h=h.toPanels;f&&b.css(f,"display","none");b.css(h,"display","block");e&&e()},fade:function(e){var j=this,f=j._getFromToPanels(),d=f.fromPanels,g=j.config,a=d?d[0]:null,c=f.toPanels[0];j.anim&&(j.anim.stop(),b.css(j.anim.fromEl,{zIndex:1,opacity:0}),b.css(j.anim.toEl,"zIndex",9));b.css(c,"opacity",1);a?(j.anim=
(new k(a,{opacity:0},g.duration,g.easing,function(){j.anim=h;b.css(c,"z-index",9);b.css(a,"z-index",1);e&&e()})).run(),j.anim.toEl=c,j.anim.fromEl=a):(b.css(c,"z-index",9),e&&e())},scroll:function(e,j,f){var d=this,j=d.fromIndex,g=d.config,a="scrollx"===g.effect,c={};c[a?"left":"top"]=-(d.viewSize[a?0:1]*d.activeIndex)+"px";d.anim&&d.anim.stop();f||-1<j?d.anim=(new k(d.content,c,g.duration,g.easing,function(){d.anim=h;e&&e()})).run():(b.css(d.content,c),e&&e())}};n=l.Effects;n.scrollx=n.scrolly=n.scroll;
l.addPlugin({priority:10,name:"effect",init:function(h){var k=h.config,f=k.effect,d=h.panels,g=h.content,a=k.steps,c=d[0],i=h.activeIndex;if("none"!==f)switch(b.css(d,"display","block"),f){case "scrollx":case "scrolly":b.css(g,"position","absolute");"static"==b.css(g.parentNode,"position")&&b.css(g.parentNode,"position","relative");"scrollx"===f&&(b.css(d,"float","left"),b.width(g,"999999px"));h.viewSize=[k.viewSize[0]||c&&b.outerWidth(c,!0)*a,k.viewSize[1]||c&&b.outerHeight(c,!0)*a];break;case "fade":var j=
i*a,l=j+a-1,n;e.each(d,function(a,c){n=c>=j&&c<=l;b.css(a,{opacity:n?1:0,position:"absolute",zIndex:n?9:1})})}}});e.augment(l,{_switchView:function(b,h,f){var d=this,g=d.config.effect;(e.isFunction(g)?g:n[g]).call(d,function(){d._fireOnSwitch(h);f&&f.call(d)},b)}});return l},{requires:["dom","event","anim","./base"]});
KISSY.add("switchable/lazyload",function(e,b,j){var k="beforeSwitch",l="img",h="textarea",n={};n[l]="lazyImgAttribute";n[h]="lazyTextareaClass";e.mix(j.Config,{lazyImgAttribute:"data-ks-lazyload-custom",lazyTextareaClass:"ks-datalazyload-custom",lazyDataType:h});j.addPlugin({name:"lazyload",init:function(j){function p(c){var e=j._realStep||d.steps,c=c.toIndex*e;f.loadCustomLazyData(j.panels.slice(c,c+e),g,a);a:{var n,t,u;if(c=(e=g===l)?"img":g===h?"textarea":""){c=b.query(c,j.container);n=0;for(u=
c.length;n<u;n++)if(t=c[n],e?b.attr(t,a):b.hasClass(t,a)){e=!1;break a}}e=!0}e&&j.detach(k,p)}var f=e.require("datalazyload"),d=j.config,g,a;"img-src"===d.lazyDataType&&(d.lazyDataType=l);"area-data"===d.lazyDataType&&(d.lazyDataType=h);g=d.lazyDataType;a=d[n[g]];f&&g&&a&&(j.on(k,p),p({toIndex:j.activeIndex}))}});return j},{requires:["dom","./base"]});
KISSY.add("switchable/slide/base",function(e,b){function j(b,e){if(!(this instanceof j))return new j(b,e);j.superclass.constructor.apply(this,arguments)}j.Config={autoplay:!0,circular:!0};e.extend(j,b);return j},{requires:["../base"]});KISSY.add("switchable",function(e,b,j,k,l,h){e.mix(b,{Accordion:j,Carousel:k,Slide:l,Tabs:h});return e.Switchable=b},{requires:"switchable/base,switchable/accordion/base,switchable/carousel/base,switchable/slide/base,switchable/tabs/base,switchable/lazyload,switchable/effect,switchable/circular,switchable/carousel/aria,switchable/autoplay,switchable/aria,switchable/tabs/aria,switchable/accordion/aria".split(",")});
KISSY.add("switchable/tabs/aria",function(e,b,j,k,l,h){function n(a){var c=null;e.each(this.triggers,function(d){if(d==a||b.contains(d,a))c=d});return c}function m(a){switch(a.keyCode){case d:case g:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case t:a.ctrlKey&&!a.altKey&&a.halt()}}function p(b){var e=b.target,f=b.ctrlKey&&!b.shiftKey&&!b.altKey;switch(b.keyCode){case a:case c:n.call(this,e)&&(this.prev(r(b)),b.halt());break;case i:case s:n.call(this,e)&&(this.next(r(b)),b.halt());break;case g:f&&
(b.halt(),this.next(r(b)));break;case d:f&&(b.halt(),this.prev(r(b)));break;case t:b.ctrlKey&&!b.altKey&&(b.halt(),b.shiftKey?this.prev(r(b)):this.next(r(b)))}}function f(a){var b=!(!a.originalEvent.target&&!a.originalEvent.srcElement),c=a.fromIndex,d=a.currentIndex;if(c!=d){var a=this.triggers[c],e=this.triggers[d],c=this.panels[c],d=this.panels[d];a&&u(a,"-1");u(e,"0");b&&e.focus();c&&c.setAttribute("aria-hidden","true");d.setAttribute("aria-hidden","false")}}var d=33,g=34,a=37,c=38,i=39,s=40,t=
9;e.mix(h.Config,{aria:!0});k.addPlugin({name:"aria",init:function(a){function c(a){a.setAttribute("role","tab");u(a,"-1");a.id||(a.id=e.guid("ks-switchable"))}function d(a,b){a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden","true");a.setAttribute("aria-labelledby",b.id)}if(a.config.aria){var h=a.triggers,g=a.activeIndex,i=a.panels,k=a.container;a.nav&&b.attr(a.nav,"role","tablist");var l=0;e.each(h,c);a.on("added",function(a){var b;c(b=a.trigger);d(a.panel,b)});l=0;e.each(i,function(a){d(a,
h[l]);l++});-1<g&&(u(h[g],"0"),i[g].setAttribute("aria-hidden","false"));a.on("switch",f,a);j.on(k,"keydown",p,a);j.on(k,"keypress",m,a)}}},h);var u=l.setTabIndex,r=k.getDomEvent},{requires:["dom","event","../base","../aria","./base"]});KISSY.add("switchable/tabs/base",function(e,b){function j(b,e){if(!(this instanceof j))return new j(b,e);j.superclass.constructor.call(this,b,e);return 0}e.extend(j,b);j.Config={};return j},{requires:["../base"]});
KISSY.add("switchable/touch",function(e,b,j,k,l){e.mix(k.Config,{mouseAsTouch:!1});k.addPlugin({name:"touch",init:function(h){if(!h._realStep){var n=h.config,m=n.scrollType||n.effect;if("scrolly"==m||"scrollx"==m){var p=h.content,f=h.container,d,g=n.mouseAsTouch,a,c=0,i=0,s={},t={},u="left",r,o;"scrolly"==m&&(u="top");var x=function(){if("relative"!=h.panels[h.activeIndex].style.position){h.stop&&h.stop();i=1;s=b.offset(p);var a=b.offset(f);a.bottom=a.top+f.offsetHeight;a.right=a.left+f.offsetWidth;
t=a}},w=function(e){if(i){var f=-1!=e.type.indexOf("touch")?e.originalEvent.changedTouches[0]:e,g={};"scrolly"==m?(o=h.viewSize[1],r=f.pageY-a,g.top=s.top+r,f=f.pageY>=t.top&&f.pageY<=t.bottom):(o=h.viewSize[0],r=f.pageX-d,g.left=s.left+r,f=f.pageX>=t.left&&f.pageX<=t.right);if(c||3<Math.abs(r))(-1!=e.type.indexOf("touch")&&e.preventDefault(),h.anim&&(h.anim.stop(),h.anim=l),f)?(c||(c=1,n.circular&&(e=h.activeIndex,f=h.length-1,e==f?k.adjustPosition.call(h,h.panels,0,u,o):0==e&&k.adjustPosition.call(h,
h.panels,f,u,o))),b.offset(p,g)):v()}},v=function(){if(c){i=c=0;var a=h.activeIndex,b=h.length-1;if(!n.circular&&(0>r&&a==b||0<r&&0==a))k.Effects[m].call(h,l,l,!0);else{if(!(0>r&&a==b)&&!(0<r&&0==a)&&(0==a||a==b))k.resetPosition.call(h,h.panels,0==a?b:0,u,o);h[0>r?"next":"prev"]();h.start&&h.start()}}};g?e.use("dd",function(b,c){var e=new c.Draggable({node:p});e.on("dragstart",function(){x();d=e.get("startMousePos").left;a=e.get("startMousePos").top});e.on("drag",w);e.on("dragend",v);h.__touchDD=
e}):(j.on(p,"touchstart",function(b){x();d=b.pageX;a=b.pageY}),j.on(p,"touchmove",w),j.on(p,"touchend",v))}}},destroy:function(b){var e;(e=b.__touchDD)&&e.destroy()}})},{requires:["dom","event","./base"]});
