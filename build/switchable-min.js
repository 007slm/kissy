/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Dec 7 00:26
*/
KISSY.add("switchable/accordion/aria",function(f,b,k,h,j,i){function q(a){var c=null;f.each(this.triggers,function(n){if(n==a||b.contains(n,a))c=n});return c}function l(a){var c=null;f.each(this.panels,function(n){if(n==a||b.contains(n,a))c=n});return c}function p(a){var c=q.call(this,a);c||(a=l.call(this,a),c=this.triggers[f.indexOf(a,this.panels)]);return c}function d(a){switch(a.keyCode){case n:case o:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case v:a.ctrlKey&&!a.altKey&&a.halt()}}function g(c){var b=
c.target,l=this.triggers,d=!c.ctrlKey&&!c.shiftKey&&!c.altKey,g=c.ctrlKey&&!c.shiftKey&&!c.altKey;switch(c.keyCode){case A:case t:if((b=q.call(this,b))&&d)this.switchTo(f.indexOf(b,this.triggers)),c.halt();break;case m:case x:if(b=q.call(this,b))s.call(this,b),c.halt();break;case y:case u:if(b=q.call(this,b))a.call(this,b),c.halt();break;case o:g&&(c.halt(),b=p.call(this,b),a.call(this,b));break;case n:g&&(c.halt(),b=p.call(this,b),s.call(this,b));break;case r:d&&(p.call(this,b),e.call(this,0,!0),
c.halt());break;case w:d&&(p.call(this,b),e.call(this,l.length-1,!0),c.halt());break;case v:c.ctrlKey&&!c.altKey&&(c.halt(),b=p.call(this,b),c.shiftKey?s.call(this,b):a.call(this,b))}}function e(a,c){var n=this.triggers,o=n[a];f.each(n,function(a){a!==o&&(z(a,"-1"),b.removeClass(a,"ks-switchable-select"),a.setAttribute("aria-selected","false"))});c&&o.focus();z(o,"0");b.addClass(o,"ks-switchable-select");o.setAttribute("aria-selected","true")}function s(a){var c=this.triggers,a=f.indexOf(a,c);e.call(this,
0==a?c.length-1:a-1,!0)}function a(a){var c=this.triggers,a=f.indexOf(a,c);e.call(this,a==c.length-1?0:a+1,!0)}function c(a){var c=!(!a.originalEvent.target&&!a.originalEvent.srcElement),a=a.currentIndex,b=this.panels,n=this.triggers,o=n[a],m=b[a];this.config.multiple||(f.each(b,function(a){a!==m&&a.setAttribute("aria-hidden","true")}),f.each(n,function(a){a!==o&&a.setAttribute("aria-hidden","true")}));b=m.getAttribute("aria-hidden");m.setAttribute("aria-hidden","false"==b?"true":"false");o.setAttribute("aria-expanded",
"false"==b?"false":"true");e.call(this,a,c)}var n=33,o=34,w=35,r=36,m=37,x=38,y=39,u=40,v=9,t=32,A=13;f.mix(j.Config,{aria:!0});i.addPlugin({name:"aria",init:function(a){if(a.config.aria){var n=a.container,o=a.activeIndex;b.attr(n,"aria-multiselectable",a.config.multiple?"true":"false");a.nav&&b.attr(a.nav,"role","tablist");var m=a.triggers,l=a.panels,e=0;f.each(l,function(a){a.id||(a.id=f.guid("ks-accordion-tab-panel"))});f.each(m,function(a){a.id||(a.id=f.guid("ks-accordion-tab"))});f.each(m,function(a){a.setAttribute("role",
"tab");a.setAttribute("aria-expanded",o==e?"true":"false");a.setAttribute("aria-selected",o==e?"true":"false");a.setAttribute("aria-controls",l[e].id);z(a,o==e?"0":"-1");e++});e=0;f.each(l,function(a){var c=m[e];a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden",o==e?"false":"true");a.setAttribute("aria-labelledby",c.id);e++});a.on("switch",c,a);k.on(n,"keydown",g,a);k.on(n,"keypress",d,a)}}},j);var z=h.setTabIndex},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/accordion/base",function(f,b,k){function h(b,f){if(!(this instanceof h))return new h(b,f);h.superclass.constructor.apply(this,arguments)}f.extend(h,k,{_switchTrigger:function(f,i){var k=this.config;k.multiple?b.toggleClass(i,k.activeTriggerCls):h.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(b){return this.config.multiple||h.superclass._triggerIsValid.call(this,b)},_switchView:function(f,i,k){var l=this.config,p=this._getFromToPanels().toPanels;l.multiple?
(b.toggle(p),this._fireOnSwitch(i),k&&k.call(this)):h.superclass._switchView.apply(this,arguments)}});h.Config={markupType:1,triggerType:"click",multiple:!1};return h},{requires:["dom","../base"]});
KISSY.add("switchable/aria",function(f,b,k,h){function j(){this.stop&&this.stop()}function i(){this.start&&this.start()}h.addPlugin({name:"aria",init:function(b){if(b.config.aria){var f=b.container;k.on(f,"focusin",j,b);k.on(f,"focusout",i,b)}}});var q=["a","input","button","object"];return{setTabIndex:function(l,p){l.tabIndex=p;f.each(b.query("*",l),function(d){var g=d.nodeName.toLowerCase();f.inArray(g,q)&&(b.hasAttr(d,"oriTabIndex")||b.attr(d,"oriTabIndex",d.tabIndex),d.tabIndex=-1!=p?b.attr(d,
"oriTabIndex"):p)})}}},{requires:["dom","event","./base"]});
KISSY.add("switchable/autoplay",function(f,b,k,h,j){var i=f.Env.host,q=function(l){var f=b.scrollTop(),d=b.viewportHeight(),g=b.offset(l),l=b.height(l);return g.top>f&&g.top+l<f+d};f.mix(h.Config,{pauseOnScroll:!1,autoplay:!1,interval:5,pauseOnHover:!0});h.addPlugin({name:"autoplay",init:function(b){function h(){e=f.later(function(){b.paused||b.next()},g,!0)}var d=b.config,g=1E3*d.interval,e;if(d.autoplay&&(d.pauseOnScroll&&(b.__scrollDetect=f.buffer(function(){b[q(b.container)?"start":"stop"]()},
200),k.on(i,"scroll",b.__scrollDetect)),h(),b.stop=function(){if(e){e.cancel();e=j}b.paused=true},b.start=function(){if(e){e.cancel();e=j}b.paused=false;h()},d.pauseOnHover))k.on(b.container,"mouseenter",b.stop,b),k.on(b.container,"mouseleave",b.start,b)},destroy:function(b){b.__scrollDetect&&(k.remove(i,"scroll",b.__scrollDetect),b.__scrollDetect.stop())}});return h},{requires:["dom","event","./base"]});
KISSY.add("switchable/base",function(f,b,k,h){function j(a,c){this._triggerInternalCls=f.guid(e);this._panelInternalCls=f.guid(s);c=c||{};"markupType"in c||(c.panelCls?c.markupType=1:c.panels&&(c.markupType=2));for(var n=this.constructor;n;)c=f.merge(n.Config,c),n=n.superclass?n.superclass.constructor:null;this.container=b.get(a);this.config=c;this.activeIndex=c.activeIndex;var o;-1<this.activeIndex||("number"==typeof c.switchTo?o=c.switchTo:this.activeIndex=0);this._init();this._initPlugins();this.fire(d);
o!==h&&this.switchTo(o)}function i(a){if(!a||!a.length)return null;if(1==a.length)return a[0].parentNode;for(var c=a[0],n=0;!n&&c!=document.body;)for(var c=c.parentNode,o=n=1;o<a.length;o++)if(!b.contains(c,a[o])){n=0;break}return c}function q(a){var c={};c.type=a.type;c.target=a.target;return{originalEvent:c}}var l=f.makeArray,p=k.Target,d="init",g="remove",e="ks-switchable-trigger-internal",s="ks-switchable-panel-internal";j.getDomEvent=q;j.addPlugin=function(a,c){for(var c=c||j,b=a.priority=a.priority||
0,o=0,e=c.Plugins=c.Plugins||[];o<e.length&&!(e[o].priority<b);o++);e.splice(o,0,a)};j.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:!0,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:h,steps:1,viewSize:[]};f.augment(j,p,{_initPlugins:function(){for(var a=this,c=[],b=a.constructor;b;)b.Plugins&&c.push.apply(c,[].concat(b.Plugins).reverse()),
b=b.superclass?b.superclass.constructor:null;c.reverse();f.each(c,function(c){c.init&&c.init(a)})},_init:function(){var a=this.config;this._parseMarkup();a.hasTriggers&&this._bindTriggers();this._bindPanels()},_parseMarkup:function(){var a=this.container,c=this.config,n,o,e=[],d=[];switch(c.markupType){case 0:(n=b.get("."+c.navCls,a))&&(e=b.children(n));o=b.get("."+c.contentCls,a);d=b.children(o);break;case 1:e=b.query("."+c.triggerCls,a);d=b.query("."+c.panelCls,a);break;case 2:e=c.triggers,d=c.panels,
n=c.nav,o=c.content}this.length=Math.ceil(d.length/c.steps);this.nav=n||c.hasTriggers&&i(e);if(c.hasTriggers&&(!this.nav||0==e.length))e=this._generateTriggersMarkup(this.length);this.triggers=l(e);this.panels=l(d);this.content=o||i(d)},_generateTriggersMarkup:function(a){var c=this.config,n=this.nav||b.create("<ul>"),e,d;n.className=c.navCls;for(d=0;d<a;d++)e=b.create("<li>"),d===this.activeIndex&&(e.className=c.activeTriggerCls),e.innerHTML=d+1,n.appendChild(e);this.container.appendChild(n);this.nav=
n;return b.children(n)},_bindTriggers:function(){var a=this,c=a.config,b=a._triggerInternalCls,e=f.one(a.nav);f.each(a.triggers,function(c){a._initTrigger(c)});e.delegate("click","."+b,function(c){var b=a._getTriggerIndex(c.currentTarget);a._onFocusTrigger(b,c)});"mouse"===c.triggerType&&e.delegate("mouseenter","."+b,function(c){var b=a._getTriggerIndex(c.currentTarget);a._onMouseEnterTrigger(b,c)}).delegate("mouseleave","."+b,function(){a._onMouseLeaveTrigger()})},_initTrigger:function(a){b.addClass(a,
this._triggerInternalCls)},_bindPanels:function(){var a=this;f.each(a.panels,function(c){a._initPanel(c)})},_initPanel:function(a){b.addClass(a,this._panelInternalCls)},_onFocusTrigger:function(a,c){this._triggerIsValid(a)&&(this._cancelSwitchTimer(),this.switchTo(a,h,q(c)))},_onMouseEnterTrigger:function(a,c){var b=this;if(b._triggerIsValid(a)){var e=q(c);b.switchTimer=f.later(function(){b.switchTo(a,h,e)},1E3*b.config.delay)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(a){return this.activeIndex!==
a},_cancelSwitchTimer:function(){this.switchTimer&&(this.switchTimer.cancel(),this.switchTimer=h)},_getTriggerIndex:function(a){return f.indexOf(a,this.triggers)},_resetLength:function(){this.length=this._getLength()},_getLength:function(a){var c=this.config;a===h&&(a=this.panels.length);return Math.ceil(a/c.steps)},_afterAdd:function(a,c,b){this._resetLength();a=this._getLength(a+1)-1;1==this.config.steps&&this.activeIndex>=a&&(this.activeIndex+=1);var e=this.activeIndex;this.activeIndex=-1;this.switchTo(e);
c?this.switchTo(a,h,h,b):b()},add:function(a){var c=a.callback||f.noop,e=this.nav,d=this.content,g=a.trigger,l=a.panel,m=a.active,h=this.panels.length,a=null!=a.index?a.index:h,i=this.triggers,u=this.panels,v=this.length,t=null,t=null,a=Math.max(0,Math.min(a,h)),h=u[a]||null;u.splice(a,0,l);d.insertBefore(l,h);1==this.config.steps?(t=i[a],e.insertBefore(g,t),i.splice(a,0,g)):(t=this._getLength(),t!=v&&(b.append(g,e),i.push(g)));this._initPanel(l);this._initTrigger(g);this._afterAdd(a,m,c);this.fire("add",
{index:a,trigger:g,panel:l})},remove:function(a){function c(){v&&(b.remove(v),s.splice(m,1));if(u){b.remove(u);for(var a=0;a<p.length;a++)if(p[a]==u){d.triggers.splice(a,1);break}}d._resetLength();d.fire(g,{index:m,trigger:u,panel:v})}var e=a.callback||f.noop,d=this,l=d.config.steps,i=d.length,m,s=d.panels;m="index"in a?a.index:a.panel;var a=d._getLength(s.length-1),p=d.triggers,u=null,v=null;if(s.length&&(m=f.isNumber(m)?Math.max(0,Math.min(m,s.length-1)):f.indexOf(m,s),u=1==l?p[m]:a!==i?p[i-1]:
null,v=s[m],!1!==d.fire("beforeRemove",{index:m,panel:v,trigger:u})))if(0==a)c(),e();else{var t=d.activeIndex;1<l?t==a?d.switchTo(t-1,h,h,function(){c();e()}):(c(),d.activeIndex=-1,d.switchTo(t,h,h,function(){e()})):t==m?d.switchTo(0<t?t-1:t+1,h,h,function(){c();0==t&&(d.activeIndex=0);e()}):(t>m&&(t--,d.activeIndex=t),c(),e())}},switchTo:function(a,c,b,e){var d=this,g=d.config,m=d.activeIndex,f=d.triggers;if(!d._triggerIsValid(a)||!1===d.fire("beforeSwitch",{fromIndex:m,toIndex:a}))return d;d.fromIndex=
m;g.hasTriggers&&d._switchTrigger(f[m]||null,f[a]);c===h&&(c=a>m?"forward":"backward");d.activeIndex=a;d._switchView(c,b,function(){e&&e.call(d)});return d},_switchTrigger:function(a,c){var d=this.config.activeTriggerCls;a&&b.removeClass(a,d);b.addClass(c,d)},_getFromToPanels:function(){var a=this.fromIndex,c;c=this.config.steps;var b=this.panels,d=this.activeIndex,a=-1<a?b.slice(a*c,(a+1)*c):null;c=b.slice(d*c,(d+1)*c);return{fromPanels:a,toPanels:c}},_switchView:function(a,c,d){var e=this,g=e._getFromToPanels(),
a=g.fromPanels,g=g.toPanels;a&&b.css(a,"display","none");b.css(g,"display","block");setTimeout(function(){e._fireOnSwitch(c)},0);d&&d.call(this)},_fireOnSwitch:function(a){this.fire("switch",f.merge(a,{fromIndex:this.fromIndex,currentIndex:this.activeIndex}))},prev:function(a){this.switchTo((this.activeIndex-1+this.length)%this.length,"backward",a)},next:function(a){this.switchTo((this.activeIndex+1)%this.length,"forward",a)},destroy:function(a){for(var c=this,d=c.constructor;d;)f.each(d.Plugins,
function(a){a.destroy&&a.destroy(c)}),d=d.superclass?d.superclass.constructor:null;a?k.remove(c.container):b.remove(c.container);c.nav=null;c.content=null;c.container=null;c.triggers=[];c.panels=[];c.detach()}});return j},{requires:["dom","event"]});
KISSY.add("switchable/carousel/aria",function(f,b,k,h,j,i){function q(a){var b=a.currentIndex,c=this.activeIndex,d=this.panels,e=d[b*this.config.steps],g=this.triggers,b=g[b];if((a=!(!a.originalEvent.target&&!a.originalEvent.srcElement))||-1==c)f.each(g,function(a){r(a,-1)}),f.each(d,function(a){r(a,-1)}),b&&r(b,0),r(e,0),a&&e.focus()}function l(a){var c=null;f.each(this.triggers,function(d){if(d==a||b.contains(d,a))return c=d,!1});return c}function p(d){var e=d.target;switch(d.keyCode){case n:case c:if(e=
l.call(this,e)){var g=b.next(e),h=this.triggers;g||(g=h[0]);r(e,-1);g&&(r(g,0),g.focus());d.halt()}break;case a:case s:if(e=l.call(this,e))g=b.prev(e),h=this.triggers,g||(g=h[h.length-1]),r(e,-1),g&&(r(g,0),g.focus()),d.halt();break;case w:case o:if(e=l.call(this,e))this.switchTo(f.indexOf(e,this.triggers),void 0,m),d.halt()}}function d(a){var c=null;f.each(this.panels,function(d){if(d==a||b.contains(d,a))return c=d,!1});return c}function g(a,c){var b=f.indexOf(a,this.panels),d=this.config.steps,
e=Math.floor(b/d);return e==this.activeIndex?1:0==b%d||b%d==d-1?(this.switchTo(e,c,m),0):1}function e(e){var m=e.target;switch(e.keyCode){case n:case c:if(m=d.call(this,m)){var f=b.next(m),l=this.panels;f||(f=l[0]);r(m,-1);r(f,0);g.call(this,f,x)&&f.focus();e.halt()}break;case a:case s:if(m=d.call(this,m))f=b.prev(m),l=this.panels,f||(f=l[l.length-1]),r(m,-1),r(f,0),g.call(this,f,y)&&f.focus(),e.halt();break;case w:case o:if(m=d.call(this,m))this.fire("itemSelected",{item:m}),e.halt()}}var s=37,a=
38,c=39,n=40,o=32,w=13,r=h.setTabIndex,m={originalEvent:{target:1}},x="forward",y="backward";f.mix(j.Config,{aria:!1});i.addPlugin({name:"aria",init:function(a){if(a.config.aria){var b=a.triggers,c=a.panels,d=a.content,g=a.activeIndex;d.id||(d.id=f.guid("ks-switchbale-content"));d.setAttribute("role","listbox");var l=0;f.each(b,function(a){r(a,g==l?"0":"-1");a.setAttribute("role","button");a.setAttribute("aria-controls",d.id);l++});l=0;f.each(c,function(a){r(a,"-1");a.setAttribute("role","option");
l++});a.on("switch",q,a);if(b=a.nav)k.on(b,"keydown",p,a);k.on(d,"keydown",e,a);b=a.prevBtn;c=a.nextBtn;b&&(r(b,0),b.setAttribute("role","button"),k.on(b,"keydown",function(b){if(b.keyCode==w||b.keyCode==o){a.prev(m);b.preventDefault()}}));c&&(r(c,0),c.setAttribute("role","button"),k.on(c,"keydown",function(b){if(b.keyCode==w||b.keyCode==o){a.next(m);b.preventDefault()}}))}}},j)},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/carousel/base",function(f,b,k,h){function j(b,d){if(!(this instanceof j))return new j(b,d);j.superclass.constructor.apply(this,arguments)}var i="prevBtn",q="nextBtn",l={originalEvent:{target:1}};j.Config={circular:!0,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};f.extend(j,h,{_init:function(){function h(g){b.removeClass([d[i],d[q]],e);0==g&&b.addClass(d[i],e);g==d.length-1&&b.addClass(d[q],e)}var d=this;j.superclass._init.call(d);
var g=d.config,e=g.disableBtnCls;f.each(["prev","next"],function(e){var a=d[e+"Btn"]=b.get("."+g[e+"BtnCls"],d.container);k.on(a,"mousedown",function(a){a.preventDefault();a=d.activeIndex;if("prev"==e&&(0!=a||g.circular))d[e](l);if("next"==e&&(a!=d.length-1||g.circular))d[e](l)})});g.circular||(d.on("added removed",function(){h(d.activeIndex)}),d.on("switch",function(b){h(b.currentIndex)}));k.delegate(d.content,"click","."+d._panelInternalCls,function(b){d.fire("itemSelected",{item:b.currentTarget})})}});
return j},{requires:["dom","event","../base"]});
KISSY.add("switchable/circular",function(f,b,k,h){function j(d){var g=this,e=g.fromIndex,f=g.config,a=g.length,c="scrollx"===f.scrollType,l=c?"left":"top",h=g.activeIndex,c=g.viewSize[c?0:1],i=g.panels,j={},m={},x,q=g._realStep;x=c*a;j[l]=-c*h;-1==e?(b.css(g.content,j),d&&d()):(h+q>a?(m={position:"relative"},m[l]=x,x=h+q-a,b.css(i.slice(0,x),m),b.css(i.slice(x,q),p)):b.css(i.slice(0,q),p),i=b.css(i[e],"position"),(e+a-h)%a<(h-e+a)%a&&"relative"==i?b.css(g.content,l,-(c*(a+e))):e==a-1&&0==h?b.css(g.content,
l,c):b.css(g.content,l,-(c*e)),g.anim&&g.anim.stop(),g.anim=(new k(g.content,j,f.duration,f.easing,function(){g.anim=0;d&&d()})).run())}function i(d,g){var e=this,f=e.fromIndex,a=e.config,c=e.length,h="scrollx"===a.scrollType,i=h?"left":"top",p=e.activeIndex,j=e.viewSize[h?0:1],h=-j*p,m=e.panels,x=e.config.steps,y={},u,v="backward"===g;u=v&&0===f&&p===c-1||!v&&f===c-1&&0===p;e.anim&&(e.anim.stop(),"relative"==m[f*x].style.position&&l.call(e,m,f,i,j,1));u&&(h=q.call(e,m,p,i,j));y[i]=h+"px";-1<f?e.anim=
(new k(e.content,y,a.duration,a.easing,function(){u&&l.call(e,m,p,i,j,1);e.anim=void 0;d&&d()})).run():(b.css(e.content,y),d&&d())}function q(d,g,e,f){var a=this.config.steps,c=this.length,d=d.slice(g*a,(g+1)*a);b.css(d,"position","relative");b.css(d,e,(g?-1:1)*f*c);return g?f:-f*c}function l(d,g,e,f,a){var c=this.config.steps,l=this.length,d=d.slice(g*c,(g+1)*c);b.css(d,"position","");b.css(d,e,"");a&&b.css(this.content,e,g?-f*(l-1):"")}var p={position:"",left:"",top:""};f.mix(h.Config,{circular:!1});
h.adjustPosition=q;h.resetPosition=l;h.addPlugin({name:"circular",priority:5,init:function(b){var g=b.config,e=g.effect;if(g.circular&&("scrollx"===e||"scrolly"===e))g.scrollType=e,g.effect=b._realStep?j:i}})},{requires:["dom","anim","./base","./effect"]});
KISSY.add("switchable/effect",function(f,b,k,h,j,i){var q;f.mix(j.Config,{effect:"none",duration:0.5,easing:"easeNone"});j.Effects={none:function(f){var h=this._getFromToPanels(),d=h.fromPanels,h=h.toPanels;d&&b.css(d,"display","none");b.css(h,"display","block");f&&f()},fade:function(f){var p=this,d=p._getFromToPanels(),g=d.fromPanels,e=p.config,j=g?g[0]:null,a=d.toPanels[0];p.anim&&(p.anim.stop(),b.css(p.anim.fromEl,{zIndex:1,opacity:0}),b.css(p.anim.toEl,"zIndex",9));b.css(a,"opacity",1);j?(p.anim=
(new h(j,{opacity:0},e.duration,e.easing,function(){p.anim=i;b.css(a,"z-index",9);b.css(j,"z-index",1);f&&f()})).run(),p.anim.toEl=a,p.anim.fromEl=j):(b.css(a,"z-index",9),f&&f())},scroll:function(f,j,d){var g=this,j=g.fromIndex,e=g.config,k="scrollx"===e.effect,a={};a[k?"left":"top"]=-(g.viewSize[k?0:1]*g.activeIndex)+"px";g.anim&&g.anim.stop();d||-1<j?g.anim=(new h(g.content,a,e.duration,e.easing,function(){g.anim=i;f&&f()})).run():(b.css(g.content,a),f&&f())}};q=j.Effects;q.scrollx=q.scrolly=q.scroll;
j.addPlugin({priority:10,name:"effect",init:function(h){var i=h.config,d=i.effect,g=h.panels,e=h.content,j=i.steps,a=g[0],c=h.container,n=h.activeIndex;if("none"!==d)switch(b.css(g,"display","block"),d){case "scrollx":case "scrolly":b.css(e,"position","absolute");"static"==b.css(e.parentNode,"position")&&b.css(e.parentNode,"position","relative");"scrollx"===d&&(b.css(g,"float","left"),b.width(e,"999999px"));h.viewSize=[i.viewSize[0]||a&&b.outerWidth(a,!0)*j,i.viewSize[1]||a&&b.outerHeight(a,!0)*j];
1==j&&a&&(g=1,e=h.viewSize,a=a.parentNode.parentNode,c=[Math.min(b.width(c),b.width(a)),Math.min(b.height(c),b.height(a))],"scrollx"==d?g=Math.floor(c[0]/e[0]):"scrolly"==d&&(g=Math.floor(c[1]/e[1])),g>i.steps&&(h._realStep=g));break;case "fade":var k=n*j,q=k+j-1,r;f.each(g,function(a,c){r=c>=k&&c<=q;b.css(a,{opacity:r?1:0,position:"absolute",zIndex:r?9:1})})}}});f.augment(j,{_switchView:function(b,h,d){var g=this,e=g.config.effect;(f.isFunction(e)?e:q[e]).call(g,function(){g._fireOnSwitch(h);d&&
d.call(g)},b)}});return j},{requires:["dom","event","anim","./base"]});
KISSY.add("switchable/lazyload",function(f,b,k){var h="beforeSwitch",j="img",i="textarea",q={};q[j]="lazyImgAttribute";q[i]="lazyTextareaClass";f.mix(k.Config,{lazyImgAttribute:"data-ks-lazyload-custom",lazyTextareaClass:"ks-datalazyload-custom",lazyDataType:i});k.addPlugin({name:"lazyload",init:function(l){function k(a){var c=l._realStep||g.steps,a=a.toIndex*c;d.loadCustomLazyData(l.panels.slice(a,a+c),e,s);a:{var f,o,q;if(a=(c=e===j)?"img":e===i?"textarea":""){a=b.query(a,l.container);f=0;for(q=
a.length;f<q;f++)if(o=a[f],c?b.attr(o,s):b.hasClass(o,s)){c=!1;break a}}c=!0}c&&l.detach(h,k)}var d=f.require("datalazyload"),g=l.config,e=g.lazyDataType,s;"img-src"===e?e=j:"area-data"===e&&(e=i);g.lazyDataType=e;s=g[q[e]];d&&e&&s&&(l.on(h,k),k({toIndex:l.activeIndex}))}});return k},{requires:["dom","./base"]});
KISSY.add("switchable/slide/base",function(f,b){function k(b,f){if(!(this instanceof k))return new k(b,f);k.superclass.constructor.apply(this,arguments)}k.Config={autoplay:!0,circular:!0};f.extend(k,b);return k},{requires:["../base"]});KISSY.add("switchable",function(f,b,k,h,j,i){f.mix(b,{Accordion:k,Carousel:h,Slide:j,Tabs:i});return f.Switchable=b},{requires:"switchable/base,switchable/accordion/base,switchable/carousel/base,switchable/slide/base,switchable/tabs/base,switchable/lazyload,switchable/effect,switchable/circular,switchable/carousel/aria,switchable/autoplay,switchable/aria,switchable/tabs/aria,switchable/accordion/aria,switchable/touch".split(",")});
KISSY.add("switchable/tabs/aria",function(f,b,k,h,j,i){function q(a){var c=null;f.each(this.triggers,function(d){if(d==a||b.contains(d,a))c=d});return c}function l(a){switch(a.keyCode){case g:case e:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case o:a.ctrlKey&&!a.altKey&&a.halt()}}function p(b){var d=b.target,f=b.ctrlKey&&!b.shiftKey&&!b.altKey;switch(b.keyCode){case s:case a:q.call(this,d)&&(this.prev(r(b)),b.halt());break;case c:case n:q.call(this,d)&&(this.next(r(b)),b.halt());break;case e:f&&
(b.halt(),this.next(r(b)));break;case g:f&&(b.halt(),this.prev(r(b)));break;case o:b.ctrlKey&&!b.altKey&&(b.halt(),b.shiftKey?this.prev(r(b)):this.next(r(b)))}}function d(a){var b=!(!a.originalEvent.target&&!a.originalEvent.srcElement),c=a.fromIndex,d=a.currentIndex;if(c!=d){var a=this.triggers[c],e=this.triggers[d],c=this.panels[c],d=this.panels[d];a&&w(a,"-1");w(e,"0");b&&e.focus();c&&c.setAttribute("aria-hidden","true");d.setAttribute("aria-hidden","false")}}var g=33,e=34,s=37,a=38,c=39,n=40,o=
9;f.mix(i.Config,{aria:!0});h.addPlugin({name:"aria",init:function(a){function c(a){a.setAttribute("role","tab");w(a,"-1");a.id||(a.id=f.guid("ks-switchable"))}function e(a,b){a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden","true");a.setAttribute("aria-labelledby",b.id)}if(a.config.aria){var g=a.triggers,h=a.activeIndex,i=a.panels,j=a.container;a.nav&&b.attr(a.nav,"role","tablist");var n=0;f.each(g,c);a.on("added",function(a){var b;c(b=a.trigger);e(a.panel,b)});n=0;f.each(i,function(a){e(a,
g[n]);n++});-1<h&&(w(g[h],"0"),i[h].setAttribute("aria-hidden","false"));a.on("switch",d,a);k.on(j,"keydown",p,a);k.on(j,"keypress",l,a)}}},i);var w=j.setTabIndex,r=h.getDomEvent},{requires:["dom","event","../base","../aria","./base"]});KISSY.add("switchable/tabs/base",function(f,b){function k(b,f){if(!(this instanceof k))return new k(b,f);k.superclass.constructor.call(this,b,f);return 0}f.extend(k,b);k.Config={};return k},{requires:["../base"]});
KISSY.add("switchable/touch",function(f,b,k,h,j){f.mix(h.Config,{mouseAsTouch:!1});h.addPlugin({name:"touch",init:function(i){if(!i._realStep){var k=i.config,l=k.scrollType||k.effect;if("scrolly"==l||"scrollx"==l){var p=i.content,d=i.container,g,e,s={},a={},c="left",n,o;"scrolly"==l&&(c="top");var w=function(d){var f={};"scrolly"==l?(o=i.viewSize[1],n=d.pageY-e,f.top=s.top+n,d=d.pageY>=a.top&&d.pageY<=a.bottom):(o=i.viewSize[0],n=d.pageX-g,f.left=s.left+n,d=d.pageX>=a.left&&d.pageX<=a.right);i.anim&&
(i.anim.stop(),i.anim=void 0);if(d){if(k.circular){var d=i.activeIndex,j=i.length-1;d==j?h.adjustPosition.call(i,i.panels,0,c,o):0==d&&h.adjustPosition.call(i,i.panels,j,c,o)}b.offset(p,f)}else m.stopDrag()},r=function(){var a=i.activeIndex,b=i.length-1;if(!k.circular&&(0>n&&a==b||0<n&&0==a))h.Effects[l].call(i,void 0,void 0,!0);else{if(!(0>n&&a==b)&&!(0<n&&0==a)&&(0==a||a==b))h.resetPosition.call(i,i.panels,0==a?b:0,c,o);i[0>n?"next":"prev"]();i.start&&i.start()}};k.mouseAsTouch&&(j=f.require("dd/base"));
if(j){var m=new j.Draggable({node:p});m.on("dragstart",function(){if("relative"==i.panels[i.activeIndex].style.position)m.stopDrag();else{i.stop&&i.stop();s=b.offset(p);var c=b.offset(d);c.bottom=c.top+d.offsetHeight;c.right=c.left+d.offsetWidth;a=c}g=m.get("startMousePos").left;e=m.get("startMousePos").top});m.on("drag",w);m.on("dragend",r);i.__touchDD=m}}}},destroy:function(b){var f;(f=b.__touchDD)&&f.destroy()}})},{requires:["dom","event","./base",KISSY.Features.isTouchSupported()?"dd/base":""]});
