/*
Copyright 2011, KISSY UI Library v1.30dev
MIT Licensed
build time: Dec 27 12:24
*/
KISSY.add("switchable/aria",function(m,e,o,p){function i(){this.stop&&this.stop()}function r(){this.start&&this.start()}p.Plugins.push({name:"aria",init:function(h){if(h.config.aria){var g=h.container;o.on(g,"focusin",i,h);o.on(g,"focusout",r,h)}}});var k=["a","input","button","object"];return{setTabIndex:function(h,g){h.tabIndex=g;e.query("*",h).each(function(a){var b=a.nodeName.toLowerCase();if(m.inArray(b,k)){e.hasAttr(a,"oriTabIndex")||e.attr(a,"oriTabIndex",a.tabIndex);a.tabIndex=g!=-1?e.attr(a,
"oriTabIndex"):g}})}}},{requires:["dom","event","./base"]});
KISSY.add("switchable/autoplay",function(m,e,o,p){m.mix(o.Config,{autoplay:false,interval:5,pauseOnHover:true});o.Plugins.push({name:"autoplay",init:function(i){function r(){g=m.later(function(){i.paused||i.switchTo(i.activeIndex<i.length-1?i.activeIndex+1:0,"forward")},h,true)}var k=i.config,h=k.interval*1E3,g;if(k.autoplay){r();i.stop=function(){if(g){g.cancel();g=p}i.paused=true};i.start=function(){if(g){g.cancel();g=p}i.paused=false;r()};if(k.pauseOnHover){e.on(i.container,"mouseenter",i.stop,
i);e.on(i.container,"mouseleave",i.start,i)}}}});return o},{requires:["event","./base"]});KISSY.add("switchable/autorender",function(m,e,o,p){p.autoRender=function(i,r){i="."+(i||"KS_Widget");e.query(i,r).each(function(k){var h=k.getAttribute("data-widget-type"),g;if(h&&"Switchable Tabs Slide Carousel Accordion".indexOf(h)>-1)try{if(g=k.getAttribute("data-widget-config"))g=g.replace(/'/g,'"');new m[h](k,o.parse(g))}catch(a){}})}},{requires:["dom","json","switchable/base"]});
KISSY.add("switchable/base",function(m,e,o,p){function i(a,b){b=b||{};if(!("markupType"in b))if(b.panelCls)b.markupType=1;else if(b.panels)b.markupType=2;for(var d=this.constructor;d;){b=m.merge(d.Config,b);d=d.superclass?d.superclass.constructor:null}this.container=e.get(a);this.config=b;this.activeIndex=this.completedIndex=b.activeIndex;if(!(this.activeIndex>-1))if(typeof b.switchTo!="number")this.completedIndex=this.activeIndex=0;this._init();this._initPlugins();this.fire(g);this.activeIndex>-1||
typeof b.switchTo=="number"&&this.switchTo(b.switchTo)}function r(a){var b={};b.type=a.originalEvent.type;b.target=a.originalEvent.target||a.originalEvent.srcElement;return{originalEvent:b}}var k=m.makeArray,h=o.Target,g="init";i.getDomEvent=r;i.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",
steps:1,viewSize:[]};i.Plugins=[];m.augment(i,h,{_initPlugins:function(){for(var a=this,b=a.constructor;b;){m.each(b.Plugins,function(d){d.init&&d.init(a)});b=b.superclass?b.superclass.constructor:null}},_init:function(){var a=this.config;this._parseMarkup();a.hasTriggers&&this._bindTriggers()},_parseMarkup:function(){var a=this.container,b=this.config,d,f,c=[],l=[];switch(b.markupType){case 0:if(d=e.get("."+b.navCls,a))c=e.children(d);f=e.get("."+b.contentCls,a);l=e.children(f);break;case 1:c=e.query("."+
b.triggerCls,a);l=e.query("."+b.panelCls,a);break;case 2:c=b.triggers;l=b.panels}a=l.length;this.length=Math.ceil(a/b.steps);if(b.hasTriggers&&a>0&&c.length===0)c=this._generateTriggersMarkup(this.length);this.triggers=k(c);this.panels=k(l);this.content=f||l[0].parentNode;this.nav=d||b.hasTriggers&&c[0].parentNode},_generateTriggersMarkup:function(a){var b=this.config,d=e.create("<ul>"),f,c;d.className=b.navCls;for(c=0;c<a;c++){f=e.create("<li>");if(c===this.activeIndex)f.className=b.activeTriggerCls;
f.innerHTML=c+1;d.appendChild(f)}this.container.appendChild(d);return e.children(d)},_bindTriggers:function(){var a=this,b=a.config,d=a.triggers,f,c,l=d.length;for(c=0;c<l;c++)(function(q){f=d[q];o.on(f,"click",function(j){a._onFocusTrigger(q,j)});if(b.triggerType==="mouse"){o.on(f,"mouseenter",function(j){a._onMouseEnterTrigger(q,j)});o.on(f,"mouseleave",function(){a._onMouseLeaveTrigger(q)})}})(c)},_onFocusTrigger:function(a,b){if(this._triggerIsValid(a)){this._cancelSwitchTimer();this.switchTo(a,
p,r(b))}},_onMouseEnterTrigger:function(a,b){var d=this;if(d._triggerIsValid(a)){var f=r(b);d.switchTimer=m.later(function(){d.switchTo(a,p,f)},d.config.delay*1E3)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(a){return this.activeIndex!==a},_cancelSwitchTimer:function(){if(this.switchTimer){this.switchTimer.cancel();this.switchTimer=p}},switchTo:function(a,b,d,f){var c=this,l=c.config,q=c.triggers,j=c.panels,n=c.activeIndex,t=l.steps,u=n*t,v=a*t;if(!c._triggerIsValid(a))return c;
if(c.fire("beforeSwitch",{toIndex:a})===false)return c;if(l.hasTriggers)c._switchTrigger(n>-1?q[n]:null,q[a]);if(b===p)b=a>n?"forward":"backward";c._switchView(n>-1?j.slice(u,u+t):null,j.slice(v,v+t),a,b,d,function(){f&&f.call(c,a);c.completedIndex=a});c.activeIndex=a;return c},_switchTrigger:function(a,b){var d=this.config.activeTriggerCls;a&&e.removeClass(a,d);e.addClass(b,d)},_switchView:function(a,b,d,f,c,l){a&&e.css(a,"display","none");e.css(b,"display","block");this._fireOnSwitch(d,c);l&&l.call(this)},
_fireOnSwitch:function(a,b){this.fire("switch",m.mix(b||{},{currentIndex:a}))},prev:function(a){var b=this.activeIndex;this.switchTo(b>0?b-1:this.length-1,"backward",a)},next:function(a){var b=this.activeIndex;this.switchTo(b<this.length-1?b+1:0,"forward",a)}});return i},{requires:["dom","event"]});
KISSY.add("switchable/circular",function(m,e,o,p){function i(j,n,t,u,v){var s=this;n=s.config;var w=s.length,C=s.activeIndex,x=n.scrollType===q,y=x?a:b,z=s.viewSize[x?0:1];x=-z*u;var A={},D,B=v===l;if(D=B&&C===0&&u===w-1||v===c&&C===w-1&&u===0)x=r.call(s,s.panels,u,B,y,z);A[y]=x+f;s.anim&&s.anim.stop();if(j)s.anim=(new o(s.content,A,n.duration,n.easing,function(){D&&k.call(s,s.panels,u,B,y,z);s.anim=undefined;t&&t()})).run();else{e.css(s.content,A);t&&t()}}function r(j,n,t,u,v){var s=this.config.steps;
n=this.length;var w=t?n-1:0;j=j.slice(w*s,(w+1)*s);e.css(j,h,g);e.css(j,u,(t?-1:1)*v*n);return t?v:-v*n}function k(j,n,t,u,v){var s=this.config.steps;n=this.length;var w=t?n-1:0;j=j.slice(w*s,(w+1)*s);e.css(j,h,d);e.css(j,u,d);e.css(this.content,u,t?-v*(n-1):d)}var h="position",g="relative",a="left",b="top",d="",f="px",c="forward",l="backward",q="scrollx";m.mix(p.Config,{circular:false});p.Plugins.push({name:"circular",init:function(j){j=j.config;if(j.circular&&(j.effect===q||j.effect==="scrolly")){j.scrollType=
j.effect;j.effect=i}}})},{requires:["dom","anim","./base","./effect"]});
KISSY.add("switchable/countdown",function(m,e,o,p,i,r){m.mix(i.Config,{countdown:false,countdownFromStyle:"",countdownToStyle:"width: 0"});i.Plugins.push({name:"countdown",init:function(k){function h(j){g();q=(new p(f[j],l,d-1)).run()}function g(){if(b){clearTimeout(b);b=null}if(q){q.stop();q=r}}var a=k.config,b,d=a.interval,f=[],c=a.countdownFromStyle,l=a.countdownToStyle,q;if(!(!a.autoplay||!a.hasTriggers||!a.countdown)){m.each(k.triggers,function(j,n){j.innerHTML='<div class="ks-switchable-trigger-mask"></div><div class="ks-switchable-trigger-content">'+
j.innerHTML+"</div>";f[n]=j.firstChild});if(a.pauseOnHover){o.on(k.container,"mouseenter",function(){g();var j=f[k.activeIndex];if(c)q=(new p(j,c,0.2,"easeOut")).run();else e.attr(j,"style","")});o.on(k.container,"mouseleave",function(){g();var j=k.activeIndex;e.attr(f[j],"style",c);b=setTimeout(function(){h(j)},200)})}k.on("beforeSwitch",function(){g();if(f[k.activeIndex])e.attr(f[k.activeIndex],"style",c||"")});k.on("switch",function(j){k.paused||h(j.currentIndex)});k.activeIndex>-1&&h(k.activeIndex)}}});
return i},{requires:["dom","event","anim","./base"]});
KISSY.add("switchable/effect",function(m,e,o,p,i,r){var k;m.mix(i.Config,{effect:"none",duration:0.5,easing:"easeNone"});i.Effects={none:function(h,g,a){h&&e.css(h,"display","none");e.css(g,"display","block");a&&a()},fade:function(h,g,a){var b=this,d=b.config,f=h?h[0]:null,c=g[0];if(b.anim){b.anim.stop();e.css(b.anim.fromEl,{zIndex:1,opacity:0});e.css(b.anim.toEl,"zIndex",9)}e.css(c,"opacity",1);if(f){b.anim=(new p(f,{opacity:0},d.duration,d.easing,function(){b.anim=r;e.css(c,"z-index",9);e.css(f,
"z-index",1);a&&a()})).run();b.anim.toEl=c;b.anim.fromEl=f}else{e.css(c,"z-index",9);a&&a()}},scroll:function(h,g,a,b){var d=this;g=d.config;var f=g.effect==="scrollx",c={};c[f?"left":"top"]=-(d.viewSize[f?0:1]*b)+"px";d.anim&&d.anim.stop();if(h)d.anim=(new p(d.content,c,g.duration,g.easing,function(){d.anim=r;a&&a()})).run();else{e.css(d.content,c);a&&a()}}};k=i.Effects;k.scrollx=k.scrolly=k.scroll;i.Plugins.push({name:"effect",init:function(h){var g=h.config,a=g.effect,b=h.panels,d=h.content,f=
g.steps,c=h.activeIndex,l=b.length;h.viewSize=[g.viewSize[0]||b[0].offsetWidth*f,g.viewSize[1]||b[0].offsetHeight*f];if(a!=="none"){e.css(b,"display","block");switch(a){case "scrollx":case "scrolly":e.css(d,"position","absolute");e.css(d.parentNode,"position")=="static"&&e.css(d.parentNode,"position","relative");if(a==="scrollx"){e.css(b,"float","left");e.width(d,h.viewSize[0]*(l/f))}break;case "fade":var q=c*f,j=q+f-1,n;m.each(b,function(t,u){n=u>=q&&u<=j;e.css(t,{opacity:n?1:0,position:"absolute",
zIndex:n?9:1})})}}}});m.augment(i,{_switchView:function(h,g,a,b,d,f){var c=this,l=c.config.effect;(m.isFunction(l)?l:k[l]).call(c,h,g,function(){c._fireOnSwitch(a,d);f&&f.call(c)},a,b)}});return i},{requires:["dom","event","anim","switchable/base"]});
KISSY.add("switchable/lazyload",function(m,e,o){var p="beforeSwitch",i="img",r="textarea",k={};k[i]="data-ks-lazyload-custom";k[r]="ks-datalazyload-custom";m.mix(o.Config,{lazyDataType:r});o.Plugins.push({name:"lazyload",init:function(h){function g(c){var l=b.steps;c=c.toIndex*l;a.loadCustomLazyData(h.panels.slice(c,c+l),d);a:{if(c=(l=d===i)?"img":d===r?"textarea":""){c=e.query(c,h.container);for(var q=0,j=c.length;q<j;q++){var n=c[q];if(l?e.attr(n,f):e.hasClass(n,f)){l=false;break a}}}l=true}l&&
h.detach(p,g)}var a=m.require("datalazyload"),b=h.config,d,f;if(b.lazyDataType==="img-src")b.lazyDataType=i;if(b.lazyDataType==="area-data")b.lazyDataType=r;d=b.lazyDataType;f=k[d];!a||!d||!f||h.on(p,g)}});return o},{requires:["dom","./base"]});
KISSY.add("switchable",function(m,e,o,p,i,r,k,h,g,a,b,d,f,c,l,q){m.Switchable=e;o={Accordion:p,Carousel:h,Slide:c,Tabs:q};m.mix(m,o);m.mix(e,o);return e},{requires:["switchable/base","switchable/aria","switchable/accordion/base","switchable/accordion/aria","switchable/autoplay","switchable/autorender","switchable/carousel/base","switchable/carousel/aria","switchable/circular","switchable/countdown","switchable/effect","switchable/lazyload","switchable/slide/base","switchable/slide/aria","switchable/tabs/base",
"switchable/tabs/aria"]});
