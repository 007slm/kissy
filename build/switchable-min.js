/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Jul 20 01:09
*/
KISSY.add("switchable/accordion/aria",function(c,b,k,h,m,j){function p(a){var d=null;c.each(this.triggers,function(e){if(e==a||b.contains(e,a))d=e});return d}function s(a){var d=null;c.each(this.panels,function(e){if(e==a||b.contains(e,a))d=e});return d}function l(a){var d=p.call(this,a);d||(a=s.call(this,a),d=this.triggers[c.indexOf(a,this.panels)]);return d}function i(a){switch(a.keyCode){case t:case q:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case n:a.ctrlKey&&!a.altKey&&a.halt()}}function f(e){var b=
e.target,f=this.triggers,i=!e.ctrlKey&&!e.shiftKey&&!e.altKey,s=e.ctrlKey&&!e.shiftKey&&!e.altKey;switch(e.keyCode){case z:case A:if((b=p.call(this,b))&&i)this.switchTo(c.indexOf(b,this.triggers)),e.halt();break;case r:case x:if(b=p.call(this,b))a.call(this,b),e.halt();break;case w:case v:if(b=p.call(this,b))d.call(this,b),e.halt();break;case q:s&&(e.halt(),b=l.call(this,b),d.call(this,b));break;case t:s&&(e.halt(),b=l.call(this,b),a.call(this,b));break;case o:i&&(l.call(this,b),g.call(this,0,!0),
e.halt());break;case u:i&&(l.call(this,b),g.call(this,f.length-1,!0),e.halt());break;case n:e.ctrlKey&&!e.altKey&&(e.halt(),b=l.call(this,b),e.shiftKey?a.call(this,b):d.call(this,b))}}function g(a,d){var e=this.triggers,n=e[a];c.each(e,function(a){a!==n&&(y(a,"-1"),b.removeClass(a,"ks-switchable-select"),a.setAttribute("aria-selected","false"))});d&&n.focus();y(n,"0");b.addClass(n,"ks-switchable-select");n.setAttribute("aria-selected","true")}function a(a){var d=this.triggers,a=c.indexOf(a,d);g.call(this,
0==a?d.length-1:a-1,!0)}function d(a){var d=this.triggers,a=c.indexOf(a,d);g.call(this,a==d.length-1?0:a+1,!0)}function e(a){var d=!(!a.originalEvent.target&&!a.originalEvent.srcElement),a=a.currentIndex,e=this.panels,b=this.triggers,n=b[a],t=e[a];this.config.multiple||(c.each(e,function(a){a!==t&&a.setAttribute("aria-hidden","true")}),c.each(b,function(a){a!==n&&a.setAttribute("aria-hidden","true")}));e=t.getAttribute("aria-hidden");t.setAttribute("aria-hidden","false"==e?"true":"false");n.setAttribute("aria-expanded",
"false"==e?"false":"true");g.call(this,a,d)}var t=33,q=34,u=35,o=36,r=37,x=38,w=39,v=40,n=9,A=32,z=13;c.mix(m.Config,{aria:!0});j.addPlugin({name:"aria",init:function(a){if(a.config.aria){var d=a.container,n=a.activeIndex;b.attr(d,"aria-multiselectable",a.config.multiple?"true":"false");a.nav&&b.attr(a.nav,"role","tablist");var t=a.triggers,r=a.panels,q=0;c.each(r,function(a){a.id||(a.id=c.guid("ks-accordion-tab-panel"))});c.each(t,function(a){a.id||(a.id=c.guid("ks-accordion-tab"))});c.each(t,function(a){a.setAttribute("role",
"tab");a.setAttribute("aria-expanded",n==q?"true":"false");a.setAttribute("aria-selected",n==q?"true":"false");a.setAttribute("aria-controls",r[q].id);y(a,n==q?"0":"-1");q++});q=0;c.each(r,function(a){var d=t[q];a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden",n==q?"false":"true");a.setAttribute("aria-labelledby",d.id);q++});a.on("switch",e,a);k.on(d,"keydown",f,a);k.on(d,"keypress",i,a)}}},m);var y=h.setTabIndex},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/accordion/base",function(c,b,k){function h(b,c){if(!(this instanceof h))return new h(b,c);h.superclass.constructor.apply(this,arguments)}c.extend(h,k,{_switchTrigger:function(c,j){var k=this.config;k.multiple?b.toggleClass(j,k.activeTriggerCls):h.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(b){return this.config.multiple||h.superclass._triggerIsValid.call(this,b)},_switchView:function(c,j,k){var s=this.config,l=this._getFromToPanels().toPanels;s.multiple?
(b.toggle(l),this._fireOnSwitch(j),k&&k.call(this)):h.superclass._switchView.apply(this,arguments)}});h.Config={markupType:1,triggerType:"click",multiple:!1};return h},{requires:["dom","../base"]});
KISSY.add("switchable/aria",function(c,b,k,h){function m(){this.stop&&this.stop()}function j(){this.start&&this.start()}h.addPlugin({name:"aria",init:function(b){if(b.config.aria){var c=b.container;k.on(c,"focusin",m,b);k.on(c,"focusout",j,b)}}});var p=["a","input","button","object"];return{setTabIndex:function(s,l){s.tabIndex=l;c.each(b.query("*",s),function(i){var f=i.nodeName.toLowerCase();c.inArray(f,p)&&(b.hasAttr(i,"oriTabIndex")||b.attr(i,"oriTabIndex",i.tabIndex),i.tabIndex=-1!=l?b.attr(i,
"oriTabIndex"):l)})}}},{requires:["dom","event","./base"]});
KISSY.add("switchable/autoplay",function(c,b,k,h,m){var j=c.Env.host,p=function(c){var l=b.scrollTop(),i=b.viewportHeight(),f=b.offset(c),c=b.height(c);return f.top>l&&f.top+c<l+i};c.mix(h.Config,{pauseOnScroll:!1,autoplay:!1,interval:5,pauseOnHover:!0});h.addPlugin({name:"autoplay",init:function(b){function l(){g=c.later(function(){b.paused||b.next()},f,!0)}var i=b.config,f=1E3*i.interval,g;if(i.autoplay&&(i.pauseOnScroll&&(b.__scrollDetect=c.buffer(function(){b[p(b.container)?"start":"stop"]()},
200),k.on(j,"scroll",b.__scrollDetect)),l(),b.stop=function(){if(g){g.cancel();g=m}b.paused=true},b.start=function(){if(g){g.cancel();g=m}b.paused=false;l()},i.pauseOnHover))k.on(b.container,"mouseenter",b.stop,b),k.on(b.container,"mouseleave",b.start,b)},destroy:function(b){b.__scrollDetect&&k.remove(j,"scroll",b.__scrollDetect)}});return h},{requires:["dom","event","./base"]});
KISSY.add("switchable/base",function(c,b,k,h){function m(a,d){this._triggerInternalCls=c.guid(f);this._panelInternalCls=c.guid(g);d=d||{};"markupType"in d||(d.panelCls?d.markupType=1:d.panels&&(d.markupType=2));for(var e=this.constructor;e;)d=c.merge(e.Config,d),e=e.superclass?e.superclass.constructor:null;this.container=b.get(a);this.config=d;this.activeIndex=d.activeIndex;var t;-1<this.activeIndex||("number"==typeof d.switchTo?t=d.switchTo:this.activeIndex=0);this._init();this._initPlugins();this.fire(l);
t!==h&&this.switchTo(t)}function j(a){var d={};d.type=a.type;d.target=a.target;return{originalEvent:d}}var p=c.makeArray,s=k.Target,l="init",i="remove",f="ks-switchable-trigger-internal",g="ks-switchable-panel-internal";m.getDomEvent=j;m.addPlugin=function(a,d){for(var d=d||m,b=a.priority=a.priority||0,t=0,q=d.Plugins=d.Plugins||[];t<q.length&&!(q[t].priority<b);t++);q.splice(t,0,a)};m.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",
panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:!0,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:h,steps:1,viewSize:[]};c.augment(m,s,{_initPlugins:function(){for(var a=this,d=[],b=a.constructor;b;)b.Plugins&&d.push.apply(d,[].concat(b.Plugins).reverse()),b=b.superclass?b.superclass.constructor:null;d.reverse();c.each(d,function(b){b.init&&b.init(a)})},_init:function(){var a=this.config;this._parseMarkup();a.hasTriggers&&this._bindTriggers();this._bindPanels()},
_parseMarkup:function(){var a=this.container,d=this.config,e,t,q=[],c=[];switch(d.markupType){case 0:(e=b.get("."+d.navCls,a))&&(q=b.children(e));t=b.get("."+d.contentCls,a);c=b.children(t);break;case 1:q=b.query("."+d.triggerCls,a);c=b.query("."+d.panelCls,a);break;case 2:q=d.triggers,c=d.panels}this.length=Math.ceil(c.length/d.steps);this.nav=e||d.hasTriggers&&q[0]&&q[0].parentNode;if(d.hasTriggers&&(!this.nav||0==q.length))q=this._generateTriggersMarkup(this.length);this.triggers=p(q);this.panels=
p(c);this.content=t||c[0].parentNode},_generateTriggersMarkup:function(a){var d=this.config,e=this.nav||b.create("<ul>"),c,q;e.className=d.navCls;for(q=0;q<a;q++)c=b.create("<li>"),q===this.activeIndex&&(c.className=d.activeTriggerCls),c.innerHTML=q+1,e.appendChild(c);this.container.appendChild(e);this.nav=e;return b.children(e)},_bindTriggers:function(){var a=this,b=a.config,e=a._triggerInternalCls,t=c.one(a.nav);c.each(a.triggers,function(b){a._initTrigger(b)});t.delegate("click","."+e,function(b){var d=
a._getTriggerIndex(b.currentTarget);a._onFocusTrigger(d,b)});"mouse"===b.triggerType&&t.delegate("mouseenter","."+e,function(b){var d=a._getTriggerIndex(b.currentTarget);a._onMouseEnterTrigger(d,b)}).delegate("mouseleave","."+e,function(){a._onMouseLeaveTrigger()})},_initTrigger:function(a){b.addClass(a,this._triggerInternalCls)},_bindPanels:function(){var a=this;c.each(a.panels,function(b){a._initPanel(b)})},_initPanel:function(a){b.addClass(a,this._panelInternalCls)},_onFocusTrigger:function(a,
b){this._triggerIsValid(a)&&(this._cancelSwitchTimer(),this.switchTo(a,h,j(b)))},_onMouseEnterTrigger:function(a,b){var e=this;if(e._triggerIsValid(a)){var t=j(b);e.switchTimer=c.later(function(){e.switchTo(a,h,t)},1E3*e.config.delay)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(a){return this.activeIndex!==a},_cancelSwitchTimer:function(){this.switchTimer&&(this.switchTimer.cancel(),this.switchTimer=h)},_getTriggerIndex:function(a){return c.indexOf(a,this.triggers)},
_resetLength:function(){this.length=this._getLength()},_getLength:function(a){var b=this.config;a===h&&(a=this.panels.length);return Math.ceil(a/b.steps)},_afterAdd:function(a,b,e){this._resetLength();a=this._getLength(a+1)-1;1==this.config.steps&&this.activeIndex>=a&&(this.activeIndex+=1);var c=this.activeIndex;this.activeIndex=-1;this.switchTo(c);b?this.switchTo(a,h,h,e):e()},add:function(a){var d=a.callback||c.noop,e=this.nav,i=this.content,f=a.trigger,g=a.panel,o=a.active,r=this.panels.length,
a=null!=a.index?a.index:r,l=this.triggers,h=this.panels,v=this.length,n=null,n=null,a=Math.max(0,Math.min(a,r)),r=h[a]||null;h.splice(a,0,g);i.insertBefore(g,r);1==this.config.steps?(n=l[a],e.insertBefore(f,n),l.splice(a,0,f)):(n=this._getLength(),n!=v&&(b.append(f,e),l.push(f)));this._initPanel(g);this._initTrigger(f);this._afterAdd(a,o,d);this.fire("add",{index:a,trigger:f,panel:g})},remove:function(a){function d(){v&&(b.remove(v),r.splice(o,1));if(k){b.remove(k);for(var a=0;a<j.length;a++)if(j[a]==
k){f.triggers.splice(a,1);break}}f._resetLength();f.fire(i,{index:o,trigger:k,panel:v})}var e=a.callback||c.noop,f=this,g=f.config.steps,l=f.length,o,r=f.panels;o="index"in a?a.index:a.panel;var a=f._getLength(r.length-1),j=f.triggers,k=null,v=null;if(r.length&&(o=c.isNumber(o)?Math.max(0,Math.min(o,r.length-1)):c.indexOf(o,r),k=1==g?j[o]:a!==l?j[l-1]:null,v=r[o],!1!==f.fire("beforeRemove",{index:o,panel:v,trigger:k})))if(0==a)d(),e();else{var n=f.activeIndex;1<g?n==a?f.switchTo(n-1,h,h,function(){d();
e()}):(d(),f.activeIndex=-1,f.switchTo(n,h,h,function(){e()})):n==o?f.switchTo(0<n?n-1:n+1,h,h,function(){d();0==n&&(f.activeIndex=0);e()}):(n>o&&(n--,f.activeIndex=n),d(),e())}},switchTo:function(a,b,e,f){var c=this,i=c.config,g=c.activeIndex,r=c.triggers;if(!c._triggerIsValid(a)||!1===c.fire("beforeSwitch",{fromIndex:g,toIndex:a}))return c;c.fromIndex=g;i.hasTriggers&&c._switchTrigger(r[g]||null,r[a]);b===h&&(b=a>g?"forward":"backward");c.activeIndex=a;c._switchView(b,e,function(){f&&f.call(c)});
return c},_switchTrigger:function(a,d){var e=this.config.activeTriggerCls;a&&b.removeClass(a,e);b.addClass(d,e)},_getFromToPanels:function(){var a=this.fromIndex,b;b=this.config.steps;var e=this.panels,c=this.activeIndex,a=-1<a?e.slice(a*b,(a+1)*b):null;b=e.slice(c*b,(c+1)*b);return{fromPanels:a,toPanels:b}},_switchView:function(a,d,e){var c=this,f=c._getFromToPanels(),a=f.fromPanels,f=f.toPanels;a&&b.css(a,"display","none");b.css(f,"display","block");setTimeout(function(){c._fireOnSwitch(d)},0);
e&&e.call(this)},_fireOnSwitch:function(a){this.fire("switch",c.merge(a,{fromIndex:this.fromIndex,currentIndex:this.activeIndex}))},prev:function(a){this.switchTo((this.activeIndex-1+this.length)%this.length,"backward",a)},next:function(a){this.switchTo((this.activeIndex+1)%this.length,"forward",a)},destroy:function(a){for(var d=this,e=d.constructor;e;)c.each(e.Plugins,function(a){a.destroy&&a.destroy(d)}),e=e.superclass?e.superclass.constructor:null;a?k.remove(d.container):b.remove(d.container);
d.nav=null;d.content=null;d.container=null;d.triggers=[];d.panels=[];d.detach()}});return m},{requires:["dom","event"]});
KISSY.add("switchable/carousel/aria",function(c,b,k,h,m,j){function p(a){var b=a.currentIndex,d=this.activeIndex,e=this.panels,f=e[b*this.config.steps],i=this.triggers,b=i[b];if((a=!(!a.originalEvent.target&&!a.originalEvent.srcElement))||-1==d)c.each(i,function(a){o(a,-1)}),c.each(e,function(a){o(a,-1)}),b&&o(b,0),o(f,0),a&&f.focus()}function s(a){var d=null;c.each(this.triggers,function(e){if(e==a||b.contains(e,a))return d=e,!1});return d}function l(f){var n=f.target;switch(f.keyCode){case t:case e:if(n=
s.call(this,n)){var i=b.next(n),g=this.triggers;i||(i=g[0]);o(n,-1);i&&(o(i,0),i.focus());f.halt()}break;case d:case a:if(n=s.call(this,n))i=b.prev(n),g=this.triggers,i||(i=g[g.length-1]),o(n,-1),i&&(o(i,0),i.focus()),f.halt();break;case u:case q:if(n=s.call(this,n))this.switchTo(c.indexOf(n,this.triggers),void 0,r),f.halt()}}function i(a){var d=null;c.each(this.panels,function(e){if(e==a||b.contains(e,a))return d=e,!1});return d}function f(a,b){var d=c.indexOf(a,this.panels),e=this.config.steps,
f=Math.floor(d/e);return f==this.activeIndex?1:0==d%e||d%e==e-1?(this.switchTo(f,b,r),0):1}function g(c){var n=c.target;switch(c.keyCode){case t:case e:if(n=i.call(this,n)){var g=b.next(n),r=this.panels;g||(g=r[0]);o(n,-1);o(g,0);f.call(this,g,x)&&g.focus();c.halt()}break;case d:case a:if(n=i.call(this,n))g=b.prev(n),r=this.panels,g||(g=r[r.length-1]),o(n,-1),o(g,0),f.call(this,g,w)&&g.focus(),c.halt();break;case u:case q:if(n=i.call(this,n))this.fire("itemSelected",{item:n}),c.halt()}}var a=37,d=
38,e=39,t=40,q=32,u=13,o=h.setTabIndex,r={originalEvent:{target:1}},x="forward",w="backward";c.mix(m.Config,{aria:!1});j.addPlugin({name:"aria",init:function(a){if(a.config.aria){var b=a.triggers,d=a.panels,e=a.content,f=a.activeIndex;e.id||(e.id=c.guid("ks-switchbale-content"));e.setAttribute("role","listbox");var i=0;c.each(b,function(a){o(a,f==i?"0":"-1");a.setAttribute("role","button");a.setAttribute("aria-controls",e.id);i++});i=0;c.each(d,function(a){o(a,"-1");a.setAttribute("role","option");
i++});a.on("switch",p,a);if(b=a.nav)k.on(b,"keydown",l,a);k.on(e,"keydown",g,a);b=a.prevBtn;d=a.nextBtn;b&&(o(b,0),b.setAttribute("role","button"),k.on(b,"keydown",function(b){if(b.keyCode==u||b.keyCode==q){a.prev(r);b.preventDefault()}}));d&&(o(d,0),d.setAttribute("role","button"),k.on(d,"keydown",function(b){if(b.keyCode==u||b.keyCode==q){a.next(r);b.preventDefault()}}))}}},m)},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/carousel/base",function(c,b,k,h){function m(b,c){if(!(this instanceof m))return new m(b,c);m.superclass.constructor.apply(this,arguments)}var j="prevBtn",p="nextBtn",s={originalEvent:{target:1}};m.Config={circular:!0,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};c.extend(m,h,{_init:function(){function l(a){b.removeClass([i[j],i[p]],g);0==a&&b.addClass(i[j],g);a==i.length-1&&b.addClass(i[p],g)}var i=this;m.superclass._init.call(i);
var f=i.config,g=f.disableBtnCls;c.each(["prev","next"],function(a){var d=i[a+"Btn"]=b.get("."+f[a+"BtnCls"],i.container);k.on(d,"mousedown",function(b){b.preventDefault();b=i.activeIndex;if("prev"==a&&(0!=b||f.circular))i[a](s);if("next"==a&&(b!=i.length-1||f.circular))i[a](s)})});f.circular||(i.on("added removed",function(){l(i.activeIndex)}),i.on("switch",function(a){l(a.currentIndex)}));k.delegate(i.content,"click","."+i._panelInternalCls,function(a){i.fire("itemSelected",{item:a.currentTarget})})}});
return m},{requires:["dom","event","../base"]});
KISSY.add("switchable/circular",function(c,b,k,h){function m(c){var f=this,g=f.fromIndex,a=f.config,d=f.length,e="scrollx"===a.scrollType,j=e?"left":"top",h=f.activeIndex,e=f.viewSize[e?0:1],s=f.panels,o={},r={},m=f._realStep,p=e*d;o[j]=-e*h;-1==g?(b.css(f.content,o),c&&c()):(h+m>d&&"relative"!=b.css(s[0],"position")?(r={position:"relative"},r[j]=p,b.css(s.slice(0,m),r),0<=g&&g<m&&b.css(f.content,j,-(e*(d+g)))):0<h&&h<m&&"relative"==b.css(s[0],"position")&&(b.css(s.slice(0,m),l),0<=g&&g<m&&b.css(f.content,
j,-(e*g))),"relative"==s[h].style.position&&(o[j]=-e*(d+h)),f.anim&&f.anim.stop(),f.anim=(new k(f.content,o,a.duration,a.easing,function(){if(h==0){b.css(s.slice(0,m),l);b.css(f.content,j,"")}f.anim=0;c&&c()})).run())}function j(c,f){var g=this,a=g.fromIndex,d=g.config,e=g.length,j="scrollx"===d.scrollType,h=j?"left":"top",l=g.activeIndex,o=g.viewSize[j?0:1],j=-o*l,r=g.panels,m=g.config.steps,w={},v,n="backward"===f;v=n&&0===a&&l===e-1||!n&&a===e-1&&0===l;g.anim&&(g.anim.stop(),"relative"==r[a*m].style.position&&
s.call(g,r,a,h,o,1));v&&(j=p.call(g,r,l,h,o));w[h]=j+"px";-1<a?g.anim=(new k(g.content,w,d.duration,d.easing,function(){v&&s.call(g,r,l,h,o,1);g.anim=void 0;c&&c()})).run():(b.css(g.content,w),c&&c())}function p(c,f,g,a){var d=this.config.steps,e=this.length,c=c.slice(f*d,(f+1)*d);b.css(c,"position","relative");b.css(c,g,(f?-1:1)*a*e);return f?a:-a*e}function s(c,f,g,a,d){var e=this.config.steps,j=this.length,c=c.slice(f*e,(f+1)*e);b.css(c,"position","");b.css(c,g,"");d&&b.css(this.content,g,f?-a*
(j-1):"")}var l={position:"",left:"",top:""};c.mix(h.Config,{circular:!1});h.adjustPosition=p;h.resetPosition=s;h.addPlugin({name:"circular",priority:5,init:function(c){var f=c.config,g,a,d,e,h=f.effect;if(f.circular&&("scrollx"===h||"scrolly"===h))if(f.scrollType=h,d=c.panels,e=c.container,1==f.steps&&d.length&&(g=1,a=d[0].parentNode.parentNode,a=[Math.min(b.width(e),b.width(a)),Math.min(b.height(e),b.height(a))],"scrollx"==h?g=Math.floor(a[0]/b.outerWidth(d[0],!0)):"scrolly"==h&&(g=Math.floor(a[1]/
b.outerHeight(d[0],!0))),g>f.steps&&(c._realStep=g,f.effect=m)),!c._realStep)f.effect=j}})},{requires:["dom","anim","./base","./effect"]});
KISSY.add("switchable/effect",function(c,b,k,h,m,j){var p;c.mix(m.Config,{effect:"none",duration:0.5,easing:"easeNone"});m.Effects={none:function(c){var h=this._getFromToPanels(),i=h.fromPanels,h=h.toPanels;i&&b.css(i,"display","none");b.css(h,"display","block");c&&c()},fade:function(c){var l=this,i=l._getFromToPanels(),f=i.fromPanels,g=l.config,a=f?f[0]:null,d=i.toPanels[0];l.anim&&(l.anim.stop(),b.css(l.anim.fromEl,{zIndex:1,opacity:0}),b.css(l.anim.toEl,"zIndex",9));b.css(d,"opacity",1);a?(l.anim=
(new h(a,{opacity:0},g.duration,g.easing,function(){l.anim=j;b.css(d,"z-index",9);b.css(a,"z-index",1);c&&c()})).run(),l.anim.toEl=d,l.anim.fromEl=a):(b.css(d,"z-index",9),c&&c())},scroll:function(c,l,i){var f=this,l=f.fromIndex,g=f.config,a="scrollx"===g.effect,d={};d[a?"left":"top"]=-(f.viewSize[a?0:1]*f.activeIndex)+"px";f.anim&&f.anim.stop();i||-1<l?f.anim=(new h(f.content,d,g.duration,g.easing,function(){f.anim=j;c&&c()})).run():(b.css(f.content,d),c&&c())}};p=m.Effects;p.scrollx=p.scrolly=p.scroll;
m.addPlugin({priority:10,name:"effect",init:function(h){var j=h.config,i=j.effect,f=h.panels,g=h.content,a=j.steps,d=f[0],e=h.activeIndex;if("none"!==i)switch(b.css(f,"display","block"),i){case "scrollx":case "scrolly":b.css(g,"position","absolute");"static"==b.css(g.parentNode,"position")&&b.css(g.parentNode,"position","relative");"scrollx"===i&&(b.css(f,"float","left"),b.width(g,"9999px"));h.viewSize=[j.viewSize[0]||d&&b.outerWidth(d,!0)*a,j.viewSize[1]||d&&b.outerHeight(d,!0)*a];break;case "fade":var k=
e*a,m=k+a-1,p;c.each(f,function(a,c){p=c>=k&&c<=m;b.css(a,{opacity:p?1:0,position:"absolute",zIndex:p?9:1})})}}});c.augment(m,{_switchView:function(b,h,i){var f=this,g=f.config.effect;(c.isFunction(g)?g:p[g]).call(f,function(){f._fireOnSwitch(h);i&&i.call(f)},b)}});return m},{requires:["dom","event","anim","./base"]});
KISSY.add("switchable/lazyload",function(c,b,k){var h="beforeSwitch",m="img",j="textarea",p={};p[m]="lazyImgAttribute";p[j]="lazyTextareaClass";c.mix(k.Config,{lazyImgAttribute:"data-ks-lazyload-custom",lazyTextareaClass:"ks-datalazyload-custom",lazyDataType:j});k.addPlugin({name:"lazyload",init:function(k){function l(c){var e=f.steps,c=c.toIndex*e;i.loadCustomLazyData(k.panels.slice(c,c+e),g,a);a:{var p,q,u;if(c=(e=g===m)?"img":g===j?"textarea":""){c=b.query(c,k.container);p=0;for(u=c.length;p<u;p++)if(q=
c[p],e?b.attr(q,a):b.hasClass(q,a)){e=!1;break a}}e=!0}e&&k.detach(h,l)}var i=c.require("datalazyload"),f=k.config,g,a;"img-src"===f.lazyDataType&&(f.lazyDataType=m);"area-data"===f.lazyDataType&&(f.lazyDataType=j);g=f.lazyDataType;a=f[p[g]];if(i&&g&&a)k.on(h,l)}});return k},{requires:["dom","./base"]});
KISSY.add("switchable/slide/base",function(c,b){function k(b,c){if(!(this instanceof k))return new k(b,c);k.superclass.constructor.apply(this,arguments)}k.Config={autoplay:!0,circular:!0};c.extend(k,b);return k},{requires:["../base"]});KISSY.add("switchable",function(c,b,k,h,m,j){c.mix(b,{Accordion:k,Carousel:h,Slide:m,Tabs:j});return c.Switchable=b},{requires:"switchable/base,switchable/accordion/base,switchable/carousel/base,switchable/slide/base,switchable/tabs/base,switchable/lazyload,switchable/effect,switchable/circular,switchable/carousel/aria,switchable/autoplay,switchable/aria,switchable/tabs/aria,switchable/accordion/aria".split(",")});
KISSY.add("switchable/tabs/aria",function(c,b,k,h,m,j){function p(a){var d=null;c.each(this.triggers,function(c){if(c==a||b.contains(c,a))d=c});return d}function s(a){switch(a.keyCode){case f:case g:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case q:a.ctrlKey&&!a.altKey&&a.halt()}}function l(b){var c=b.target,h=b.ctrlKey&&!b.shiftKey&&!b.altKey;switch(b.keyCode){case a:case d:p.call(this,c)&&(this.prev(o(b)),b.halt());break;case e:case t:p.call(this,c)&&(this.next(o(b)),b.halt());break;case g:h&&
(b.halt(),this.next(o(b)));break;case f:h&&(b.halt(),this.prev(o(b)));break;case q:b.ctrlKey&&!b.altKey&&(b.halt(),b.shiftKey?this.prev(o(b)):this.next(o(b)))}}function i(a){var b=!(!a.originalEvent.target&&!a.originalEvent.srcElement),c=a.fromIndex,d=a.currentIndex;if(c!=d){var a=this.triggers[c],e=this.triggers[d],c=this.panels[c],d=this.panels[d];a&&u(a,"-1");u(e,"0");b&&e.focus();c&&c.setAttribute("aria-hidden","true");d.setAttribute("aria-hidden","false")}}var f=33,g=34,a=37,d=38,e=39,t=40,q=
9;c.mix(j.Config,{aria:!0});h.addPlugin({name:"aria",init:function(a){function d(a){a.setAttribute("role","tab");u(a,"-1");a.id||(a.id=c.guid("ks-switchable"))}function e(a,b){a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden","true");a.setAttribute("aria-labelledby",b.id)}if(a.config.aria){var f=a.triggers,g=a.activeIndex,h=a.panels,j=a.container;a.nav&&b.attr(a.nav,"role","tablist");var m=0;c.each(f,d);a.on("added",function(a){var b;d(b=a.trigger);e(a.panel,b)});m=0;c.each(h,function(a){e(a,
f[m]);m++});-1<g&&(u(f[g],"0"),h[g].setAttribute("aria-hidden","false"));a.on("switch",i,a);k.on(j,"keydown",l,a);k.on(j,"keypress",s,a)}}},j);var u=m.setTabIndex,o=h.getDomEvent},{requires:["dom","event","../base","../aria","./base"]});KISSY.add("switchable/tabs/base",function(c,b){function k(b,c){if(!(this instanceof k))return new k(b,c);k.superclass.constructor.call(this,b,c);return 0}c.extend(k,b);k.Config={};return k},{requires:["../base"]});
KISSY.add("switchable/touch",function(c,b,k,h,m){c.mix(h.Config,{mouseAsTouch:!1});h.addPlugin({name:"touch",init:function(j){if(!j._realStep){var p=j.config,s=p.scrollType||p.effect;if("scrolly"==s||"scrollx"==s){var l=j.content,i=j.container,f,g=p.mouseAsTouch,a,d=0,e=0,t={},q={},u="left",o,r;"scrolly"==s&&(u="top");var x=function(){if("relative"!=j.panels[j.activeIndex].style.position){j.stop&&j.stop();e=1;t=b.offset(l);var a=b.offset(i);a.bottom=a.top+i.offsetHeight;a.right=a.left+i.offsetWidth;
q=a}},w=function(c){if(e){var g=-1!=c.type.indexOf("touch")?c.originalEvent.changedTouches[0]:c,i={};"scrolly"==s?(r=j.viewSize[1],o=g.pageY-a,i.top=t.top+o,g=g.pageY>=q.top&&g.pageY<=q.bottom):(r=j.viewSize[0],o=g.pageX-f,i.left=t.left+o,g=g.pageX>=q.left&&g.pageX<=q.right);if(d||3<Math.abs(o))(-1!=c.type.indexOf("touch")&&c.preventDefault(),j.anim&&(j.anim.stop(),j.anim=m),g)?(d||(d=1,p.circular&&(c=j.activeIndex,g=j.length-1,c==g?h.adjustPosition.call(j,j.panels,0,u,r):0==c&&h.adjustPosition.call(j,
j.panels,g,u,r))),b.offset(l,i)):v()}},v=function(){if(d){e=d=0;var a=j.activeIndex,b=j.length-1;if(!p.circular&&(0>o&&a==b||0<o&&0==a))h.Effects[s].call(j,m,m,!0);else{if(!(0>o&&a==b)&&!(0<o&&0==a)&&(0==a||a==b))h.resetPosition.call(j,j.panels,0==a?b:0,u,r);j[0>o?"next":"prev"]();j.start&&j.start()}}};k.on(l,"touchstart",function(b){x();f=b.pageX;a=b.pageY});k.on(l,"touchmove",w);k.on(l,"touchend",v);g&&!("ontouchstart"in c.Env.host.document.documentElement)&&c.use("dd",function(b,c){var d=new c.Draggable({node:l});
d.on("dragstart",function(){x();f=d.startMousePos.left;a=d.startMousePos.top});d.on("drag",w);d.on("dragend",v);j.__touchDD=d})}}},destroy:function(b){var c;(c=b.__touchDD)&&c.destroy()}})},{requires:["dom","event","./base"]});
