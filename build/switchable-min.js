/*
Copyright 2012, KISSY UI Library v1.30rc
MIT Licensed
build time: Jul 20 01:10
*/
KISSY.add("switchable/accordion/aria",function(d,b,i,j,n,g){function m(a){var c=null;d.each(this.triggers,function(h){if(h==a||b.contains(h,a))c=h});return c}function k(a){var c=null;d.each(this.panels,function(h){if(h==a||b.contains(h,a))c=h});return c}function p(a){var c=m.call(this,a);c||(a=k.call(this,a),c=this.triggers[d.indexOf(a,this.panels)]);return c}function f(a){switch(a.keyCode){case t:case s:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case q:a.ctrlKey&&!a.altKey&&a.halt()}}function e(b){var h=
b.target,e=this.triggers,f=!b.ctrlKey&&!b.shiftKey&&!b.altKey,k=b.ctrlKey&&!b.shiftKey&&!b.altKey;switch(b.keyCode){case z:case A:if((h=m.call(this,h))&&f)this.switchTo(d.indexOf(h,this.triggers)),b.halt();break;case o:case x:if(h=m.call(this,h))a.call(this,h),b.halt();break;case w:case v:if(h=m.call(this,h))c.call(this,h),b.halt();break;case s:k&&(b.halt(),h=p.call(this,h),c.call(this,h));break;case t:k&&(b.halt(),h=p.call(this,h),a.call(this,h));break;case r:f&&(p.call(this,h),l.call(this,0,!0),
b.halt());break;case u:f&&(p.call(this,h),l.call(this,e.length-1,!0),b.halt());break;case q:b.ctrlKey&&!b.altKey&&(b.halt(),h=p.call(this,h),b.shiftKey?a.call(this,h):c.call(this,h))}}function l(a,c){var h=this.triggers,q=h[a];d.each(h,function(a){a!==q&&(y(a,"-1"),b.removeClass(a,"ks-switchable-select"),a.setAttribute("aria-selected","false"))});c&&q.focus();y(q,"0");b.addClass(q,"ks-switchable-select");q.setAttribute("aria-selected","true")}function a(a){var c=this.triggers,a=d.indexOf(a,c);l.call(this,
0==a?c.length-1:a-1,!0)}function c(a){var c=this.triggers,a=d.indexOf(a,c);l.call(this,a==c.length-1?0:a+1,!0)}function h(a){var c=!(!a.originalEvent.target&&!a.originalEvent.srcElement),a=a.currentIndex,h=this.panels,b=this.triggers,q=b[a],e=h[a];this.config.multiple||(d.each(h,function(a){a!==e&&a.setAttribute("aria-hidden","true")}),d.each(b,function(a){a!==q&&a.setAttribute("aria-hidden","true")}));h=e.getAttribute("aria-hidden");e.setAttribute("aria-hidden","false"==h?"true":"false");q.setAttribute("aria-expanded",
"false"==h?"false":"true");l.call(this,a,c)}var t=33,s=34,u=35,r=36,o=37,x=38,w=39,v=40,q=9,A=32,z=13;d.mix(n.Config,{aria:!0});g.addPlugin({name:"aria",init:function(a){if(a.config.aria){var c=a.container,q=a.activeIndex;b.attr(c,"aria-multiselectable",a.config.multiple?"true":"false");a.nav&&b.attr(a.nav,"role","tablist");var t=a.triggers,o=a.panels,k=0;d.each(o,function(a){a.id||(a.id=d.guid("ks-accordion-tab-panel"))});d.each(t,function(a){a.id||(a.id=d.guid("ks-accordion-tab"))});d.each(t,function(a){a.setAttribute("role",
"tab");a.setAttribute("aria-expanded",q==k?"true":"false");a.setAttribute("aria-selected",q==k?"true":"false");a.setAttribute("aria-controls",o[k].id);y(a,q==k?"0":"-1");k++});k=0;d.each(o,function(a){var c=t[k];a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden",q==k?"false":"true");a.setAttribute("aria-labelledby",c.id);k++});a.on("switch",h,a);i.on(c,"keydown",e,a);i.on(c,"keypress",f,a)}}},n);var y=j.setTabIndex},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/accordion/base",function(d,b,i){function j(b,d){if(!(this instanceof j))return new j(b,d);j.superclass.constructor.apply(this,arguments)}d.extend(j,i,{_switchTrigger:function(d,g){var i=this.config;i.multiple?b.toggleClass(g,i.activeTriggerCls):j.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(b){return this.config.multiple||j.superclass._triggerIsValid.call(this,b)},_switchView:function(d,g,i){var k=this.config,p=this._getFromToPanels().toPanels;k.multiple?
(b.toggle(p),this._fireOnSwitch(g),i&&i.call(this)):j.superclass._switchView.apply(this,arguments)}});j.Config={markupType:1,triggerType:"click",multiple:!1};return j},{requires:["dom","../base"]});
KISSY.add("switchable/aria",function(d,b,i,j){function n(){this.stop&&this.stop()}function g(){this.start&&this.start()}j.addPlugin({name:"aria",init:function(b){if(b.config.aria){var d=b.container;i.on(d,"focusin",n,b);i.on(d,"focusout",g,b)}}});var m=["a","input","button","object"];return{setTabIndex:function(k,g){k.tabIndex=g;d.each(b.query("*",k),function(f){var e=f.nodeName.toLowerCase();d.inArray(e,m)&&(b.hasAttr(f,"oriTabIndex")||b.attr(f,"oriTabIndex",f.tabIndex),f.tabIndex=-1!=g?b.attr(f,
"oriTabIndex"):g)})}}},{requires:["dom","event","./base"]});
KISSY.add("switchable/autoplay",function(d,b,i,j,n){var g=d.Env.host,m=function(k){var d=b.scrollTop(),f=b.viewportHeight(),e=b.offset(k),k=b.height(k);return e.top>d&&e.top+k<d+f};d.mix(j.Config,{pauseOnScroll:!1,autoplay:!1,interval:5,pauseOnHover:!0});j.addPlugin({name:"autoplay",init:function(b){function j(){l=d.later(function(){b.paused||b.next()},e,!0)}var f=b.config,e=1E3*f.interval,l;if(f.autoplay&&(f.pauseOnScroll&&(b.__scrollDetect=d.buffer(function(){b[m(b.container)?"start":"stop"]()},
200),i.on(g,"scroll",b.__scrollDetect)),j(),b.stop=function(){if(l){l.cancel();l=n}b.paused=true},b.start=function(){if(l){l.cancel();l=n}b.paused=false;j()},f.pauseOnHover))i.on(b.container,"mouseenter",b.stop,b),i.on(b.container,"mouseleave",b.start,b)},destroy:function(b){b.__scrollDetect&&i.remove(g,"scroll",b.__scrollDetect)}});return j},{requires:["dom","event","./base"]});
KISSY.add("switchable/base",function(d,b,i,j){function n(a,c){this._triggerInternalCls=d.guid(e);this._panelInternalCls=d.guid(l);c=c||{};"markupType"in c||(c.panelCls?c.markupType=1:c.panels&&(c.markupType=2));for(var h=this.constructor;h;)c=d.merge(h.Config,c),h=h.superclass?h.superclass.constructor:null;this.container=b.get(a);this.config=c;this.activeIndex=c.activeIndex;var t;-1<this.activeIndex||("number"==typeof c.switchTo?t=c.switchTo:this.activeIndex=0);this._init();this._initPlugins();this.fire(p);
t!==j&&this.switchTo(t)}function g(a){var c={};c.type=a.type;c.target=a.target;return{originalEvent:c}}var m=d.makeArray,k=i.Target,p="init",f="remove",e="ks-switchable-trigger-internal",l="ks-switchable-panel-internal";n.getDomEvent=g;n.addPlugin=function(a,c){for(var c=c||n,b=a.priority=a.priority||0,e=0,f=c.Plugins=c.Plugins||[];e<f.length&&!(f[e].priority<b);e++);f.splice(e,0,a)};n.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",
panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:!0,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:j,steps:1,viewSize:[]};d.augment(n,k,{_initPlugins:function(){for(var a=this,c=[],b=a.constructor;b;)b.Plugins&&c.push.apply(c,[].concat(b.Plugins).reverse()),b=b.superclass?b.superclass.constructor:null;c.reverse();d.each(c,function(c){c.init&&c.init(a)})},_init:function(){var a=this.config;this._parseMarkup();a.hasTriggers&&this._bindTriggers();this._bindPanels()},
_parseMarkup:function(){var a=this.container,c=this.config,h,e,f=[],d=[];switch(c.markupType){case 0:(h=b.get("."+c.navCls,a))&&(f=b.children(h));e=b.get("."+c.contentCls,a);d=b.children(e);break;case 1:f=b.query("."+c.triggerCls,a);d=b.query("."+c.panelCls,a);break;case 2:f=c.triggers,d=c.panels}this.length=Math.ceil(d.length/c.steps);this.nav=h||c.hasTriggers&&f[0]&&f[0].parentNode;if(c.hasTriggers&&(!this.nav||0==f.length))f=this._generateTriggersMarkup(this.length);this.triggers=m(f);this.panels=
m(d);this.content=e||d[0].parentNode},_generateTriggersMarkup:function(a){var c=this.config,h=this.nav||b.create("<ul>"),e,f;h.className=c.navCls;for(f=0;f<a;f++)e=b.create("<li>"),f===this.activeIndex&&(e.className=c.activeTriggerCls),e.innerHTML=f+1,h.appendChild(e);this.container.appendChild(h);this.nav=h;return b.children(h)},_bindTriggers:function(){var a=this,c=a.config,b=a._triggerInternalCls,f=d.one(a.nav);d.each(a.triggers,function(c){a._initTrigger(c)});f.delegate("click","."+b,function(c){var b=
a._getTriggerIndex(c.currentTarget);a._onFocusTrigger(b,c)});"mouse"===c.triggerType&&f.delegate("mouseenter","."+b,function(c){var b=a._getTriggerIndex(c.currentTarget);a._onMouseEnterTrigger(b,c)}).delegate("mouseleave","."+b,function(){a._onMouseLeaveTrigger()})},_initTrigger:function(a){b.addClass(a,this._triggerInternalCls)},_bindPanels:function(){var a=this;d.each(a.panels,function(c){a._initPanel(c)})},_initPanel:function(a){b.addClass(a,this._panelInternalCls)},_onFocusTrigger:function(a,
c){this._triggerIsValid(a)&&(this._cancelSwitchTimer(),this.switchTo(a,j,g(c)))},_onMouseEnterTrigger:function(a,c){var b=this;if(b._triggerIsValid(a)){var f=g(c);b.switchTimer=d.later(function(){b.switchTo(a,j,f)},1E3*b.config.delay)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(a){return this.activeIndex!==a},_cancelSwitchTimer:function(){this.switchTimer&&(this.switchTimer.cancel(),this.switchTimer=j)},_getTriggerIndex:function(a){return d.indexOf(a,this.triggers)},
_resetLength:function(){this.length=this._getLength()},_getLength:function(a){var c=this.config;a===j&&(a=this.panels.length);return Math.ceil(a/c.steps)},_afterAdd:function(a,c,b){this._resetLength();a=this._getLength(a+1)-1;1==this.config.steps&&this.activeIndex>=a&&(this.activeIndex+=1);var f=this.activeIndex;this.activeIndex=-1;this.switchTo(f);c?this.switchTo(a,j,j,b):b()},add:function(a){var c=a.callback||d.noop,h=this.nav,f=this.content,e=a.trigger,l=a.panel,g=a.active,o=this.panels.length,
a=null!=a.index?a.index:o,k=this.triggers,j=this.panels,v=this.length,q=null,q=null,a=Math.max(0,Math.min(a,o)),o=j[a]||null;j.splice(a,0,l);f.insertBefore(l,o);1==this.config.steps?(q=k[a],h.insertBefore(e,q),k.splice(a,0,e)):(q=this._getLength(),q!=v&&(b.append(e,h),k.push(e)));this._initPanel(l);this._initTrigger(e);this._afterAdd(a,g,c);this.fire("add",{index:a,trigger:e,panel:l})},remove:function(a){function c(){v&&(b.remove(v),o.splice(k,1));if(i){b.remove(i);for(var a=0;a<p.length;a++)if(p[a]==
i){e.triggers.splice(a,1);break}}e._resetLength();e.fire(f,{index:k,trigger:i,panel:v})}var h=a.callback||d.noop,e=this,l=e.config.steps,g=e.length,k,o=e.panels;k="index"in a?a.index:a.panel;var a=e._getLength(o.length-1),p=e.triggers,i=null,v=null;if(o.length&&(k=d.isNumber(k)?Math.max(0,Math.min(k,o.length-1)):d.indexOf(k,o),i=1==l?p[k]:a!==g?p[g-1]:null,v=o[k],!1!==e.fire("beforeRemove",{index:k,panel:v,trigger:i})))if(0==a)c(),h();else{var q=e.activeIndex;1<l?q==a?e.switchTo(q-1,j,j,function(){c();
h()}):(c(),e.activeIndex=-1,e.switchTo(q,j,j,function(){h()})):q==k?e.switchTo(0<q?q-1:q+1,j,j,function(){c();0==q&&(e.activeIndex=0);h()}):(q>k&&(q--,e.activeIndex=q),c(),h())}},switchTo:function(a,c,b,e){var f=this,d=f.config,l=f.activeIndex,o=f.triggers;if(!f._triggerIsValid(a)||!1===f.fire("beforeSwitch",{fromIndex:l,toIndex:a}))return f;f.fromIndex=l;d.hasTriggers&&f._switchTrigger(o[l]||null,o[a]);c===j&&(c=a>l?"forward":"backward");f.activeIndex=a;f._switchView(c,b,function(){e&&e.call(f)});
return f},_switchTrigger:function(a,c){var e=this.config.activeTriggerCls;a&&b.removeClass(a,e);b.addClass(c,e)},_getFromToPanels:function(){var a=this.fromIndex,c;c=this.config.steps;var b=this.panels,e=this.activeIndex,a=-1<a?b.slice(a*c,(a+1)*c):null;c=b.slice(e*c,(e+1)*c);return{fromPanels:a,toPanels:c}},_switchView:function(a,c,e){var f=this,d=f._getFromToPanels(),a=d.fromPanels,d=d.toPanels;a&&b.css(a,"display","none");b.css(d,"display","block");setTimeout(function(){f._fireOnSwitch(c)},0);
e&&e.call(this)},_fireOnSwitch:function(a){this.fire("switch",d.merge(a,{fromIndex:this.fromIndex,currentIndex:this.activeIndex}))},prev:function(a){this.switchTo((this.activeIndex-1+this.length)%this.length,"backward",a)},next:function(a){this.switchTo((this.activeIndex+1)%this.length,"forward",a)},destroy:function(a){for(var c=this,e=c.constructor;e;)d.each(e.Plugins,function(a){a.destroy&&a.destroy(c)}),e=e.superclass?e.superclass.constructor:null;a?i.remove(c.container):b.remove(c.container);
c.nav=null;c.content=null;c.container=null;c.triggers=[];c.panels=[];c.detach()}});return n},{requires:["dom","event"]});
KISSY.add("switchable/carousel/aria",function(d,b,i,j,n,g){function m(a){var b=a.currentIndex,c=this.activeIndex,e=this.panels,f=e[b*this.config.steps],h=this.triggers,b=h[b];if((a=!(!a.originalEvent.target&&!a.originalEvent.srcElement))||-1==c)d.each(h,function(a){r(a,-1)}),d.each(e,function(a){r(a,-1)}),b&&r(b,0),r(f,0),a&&f.focus()}function k(a){var c=null;d.each(this.triggers,function(e){if(e==a||b.contains(e,a))return c=e,!1});return c}function p(e){var f=e.target;switch(e.keyCode){case t:case h:if(f=
k.call(this,f)){var l=b.next(f),g=this.triggers;l||(l=g[0]);r(f,-1);l&&(r(l,0),l.focus());e.halt()}break;case c:case a:if(f=k.call(this,f))l=b.prev(f),g=this.triggers,l||(l=g[g.length-1]),r(f,-1),l&&(r(l,0),l.focus()),e.halt();break;case u:case s:if(f=k.call(this,f))this.switchTo(d.indexOf(f,this.triggers),void 0,o),e.halt()}}function f(a){var c=null;d.each(this.panels,function(e){if(e==a||b.contains(e,a))return c=e,!1});return c}function e(a,c){var b=d.indexOf(a,this.panels),e=this.config.steps,
f=Math.floor(b/e);return f==this.activeIndex?1:0==b%e||b%e==e-1?(this.switchTo(f,c,o),0):1}function l(l){var d=l.target;switch(l.keyCode){case t:case h:if(d=f.call(this,d)){var o=b.next(d),k=this.panels;o||(o=k[0]);r(d,-1);r(o,0);e.call(this,o,x)&&o.focus();l.halt()}break;case c:case a:if(d=f.call(this,d))o=b.prev(d),k=this.panels,o||(o=k[k.length-1]),r(d,-1),r(o,0),e.call(this,o,w)&&o.focus(),l.halt();break;case u:case s:if(d=f.call(this,d))this.fire("itemSelected",{item:d}),l.halt()}}var a=37,c=
38,h=39,t=40,s=32,u=13,r=j.setTabIndex,o={originalEvent:{target:1}},x="forward",w="backward";d.mix(n.Config,{aria:!1});g.addPlugin({name:"aria",init:function(a){if(a.config.aria){var b=a.triggers,c=a.panels,e=a.content,f=a.activeIndex;e.id||(e.id=d.guid("ks-switchbale-content"));e.setAttribute("role","listbox");var h=0;d.each(b,function(a){r(a,f==h?"0":"-1");a.setAttribute("role","button");a.setAttribute("aria-controls",e.id);h++});h=0;d.each(c,function(a){r(a,"-1");a.setAttribute("role","option");
h++});a.on("switch",m,a);if(b=a.nav)i.on(b,"keydown",p,a);i.on(e,"keydown",l,a);b=a.prevBtn;c=a.nextBtn;b&&(r(b,0),b.setAttribute("role","button"),i.on(b,"keydown",function(b){if(b.keyCode==u||b.keyCode==s){a.prev(o);b.preventDefault()}}));c&&(r(c,0),c.setAttribute("role","button"),i.on(c,"keydown",function(b){if(b.keyCode==u||b.keyCode==s){a.next(o);b.preventDefault()}}))}}},n)},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/carousel/base",function(d,b,i,j){function n(b,f){if(!(this instanceof n))return new n(b,f);n.superclass.constructor.apply(this,arguments)}var g="prevBtn",m="nextBtn",k={originalEvent:{target:1}};n.Config={circular:!0,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};d.extend(n,j,{_init:function(){function j(a){b.removeClass([f[g],f[m]],l);0==a&&b.addClass(f[g],l);a==f.length-1&&b.addClass(f[m],l)}var f=this;n.superclass._init.call(f);
var e=f.config,l=e.disableBtnCls;d.each(["prev","next"],function(a){var c=f[a+"Btn"]=b.get("."+e[a+"BtnCls"],f.container);i.on(c,"mousedown",function(b){b.preventDefault();b=f.activeIndex;if("prev"==a&&(0!=b||e.circular))f[a](k);if("next"==a&&(b!=f.length-1||e.circular))f[a](k)})});e.circular||(f.on("added removed",function(){j(f.activeIndex)}),f.on("switch",function(a){j(a.currentIndex)}));i.delegate(f.content,"click","."+f._panelInternalCls,function(a){f.fire("itemSelected",{item:a.currentTarget})})}});
return n},{requires:["dom","event","../base"]});
KISSY.add("switchable/circular",function(d,b,i,j){function n(f){var e=this,d=e.fromIndex,a=e.config,c=e.length,h="scrollx"===a.scrollType,k=h?"left":"top",g=e.activeIndex,h=e.viewSize[h?0:1],j=e.panels,n={},o={},m=e._realStep,w=h*c;n[k]=-h*g;-1==d?(b.css(e.content,n),f&&f()):(g+m>c&&"relative"!=b.css(j[0],"position")?(o={position:"relative"},o[k]=w,b.css(j.slice(0,m),o),0<=d&&d<m&&b.css(e.content,k,-(h*(c+d)))):0<g&&g<m&&"relative"==b.css(j[0],"position")&&(b.css(j.slice(0,m),p),0<=d&&d<m&&b.css(e.content,
k,-(h*d))),"relative"==j[g].style.position&&(n[k]=-h*(c+g)),e.anim&&e.anim.stop(),e.anim=(new i(e.content,n,a.duration,a.easing,function(){if(g==0){b.css(j.slice(0,m),p);b.css(e.content,k,"")}e.anim=0;f&&f()})).run())}function g(f,e){var d=this,a=d.fromIndex,c=d.config,h=d.length,g="scrollx"===c.scrollType,j=g?"left":"top",p=d.activeIndex,n=d.viewSize[g?0:1],g=-n*p,o=d.panels,x=d.config.steps,w={},v,q="backward"===e;v=q&&0===a&&p===h-1||!q&&a===h-1&&0===p;d.anim&&(d.anim.stop(),"relative"==o[a*x].style.position&&
k.call(d,o,a,j,n,1));v&&(g=m.call(d,o,p,j,n));w[j]=g+"px";-1<a?d.anim=(new i(d.content,w,c.duration,c.easing,function(){v&&k.call(d,o,p,j,n,1);d.anim=void 0;f&&f()})).run():(b.css(d.content,w),f&&f())}function m(f,e,d,a){var c=this.config.steps,h=this.length,f=f.slice(e*c,(e+1)*c);b.css(f,"position","relative");b.css(f,d,(e?-1:1)*a*h);return e?a:-a*h}function k(f,e,d,a,c){var h=this.config.steps,g=this.length,f=f.slice(e*h,(e+1)*h);b.css(f,"position","");b.css(f,d,"");c&&b.css(this.content,d,e?-a*
(g-1):"")}var p={position:"",left:"",top:""};d.mix(j.Config,{circular:!1});j.adjustPosition=m;j.resetPosition=k;j.addPlugin({name:"circular",priority:5,init:function(f){var e=f.config,d,a,c,h,k=e.effect;if(e.circular&&("scrollx"===k||"scrolly"===k))if(e.scrollType=k,c=f.panels,h=f.container,1==e.steps&&c.length&&(d=1,a=c[0].parentNode.parentNode,a=[Math.min(b.width(h),b.width(a)),Math.min(b.height(h),b.height(a))],"scrollx"==k?d=Math.floor(a[0]/b.outerWidth(c[0],!0)):"scrolly"==k&&(d=Math.floor(a[1]/
b.outerHeight(c[0],!0))),d>e.steps&&(f._realStep=d,e.effect=n)),!f._realStep)e.effect=g}})},{requires:["dom","anim","./base","./effect"]});
KISSY.add("switchable/effect",function(d,b,i,j,n,g){var m;d.mix(n.Config,{effect:"none",duration:0.5,easing:"easeNone"});n.Effects={none:function(d){var g=this._getFromToPanels(),f=g.fromPanels,g=g.toPanels;f&&b.css(f,"display","none");b.css(g,"display","block");d&&d()},fade:function(d){var i=this,f=i._getFromToPanels(),e=f.fromPanels,l=i.config,a=e?e[0]:null,c=f.toPanels[0];i.anim&&(i.anim.stop(),b.css(i.anim.fromEl,{zIndex:1,opacity:0}),b.css(i.anim.toEl,"zIndex",9));b.css(c,"opacity",1);a?(i.anim=
(new j(a,{opacity:0},l.duration,l.easing,function(){i.anim=g;b.css(c,"z-index",9);b.css(a,"z-index",1);d&&d()})).run(),i.anim.toEl=c,i.anim.fromEl=a):(b.css(c,"z-index",9),d&&d())},scroll:function(d,i,f){var e=this,i=e.fromIndex,l=e.config,a="scrollx"===l.effect,c={};c[a?"left":"top"]=-(e.viewSize[a?0:1]*e.activeIndex)+"px";e.anim&&e.anim.stop();f||-1<i?e.anim=(new j(e.content,c,l.duration,l.easing,function(){e.anim=g;d&&d()})).run():(b.css(e.content,c),d&&d())}};m=n.Effects;m.scrollx=m.scrolly=m.scroll;
n.addPlugin({priority:10,name:"effect",init:function(g){var j=g.config,f=j.effect,e=g.panels,l=g.content,a=j.steps,c=e[0],h=g.activeIndex;if("none"!==f)switch(b.css(e,"display","block"),f){case "scrollx":case "scrolly":b.css(l,"position","absolute");"static"==b.css(l.parentNode,"position")&&b.css(l.parentNode,"position","relative");"scrollx"===f&&(b.css(e,"float","left"),b.width(l,"9999px"));g.viewSize=[j.viewSize[0]||c&&b.outerWidth(c,!0)*a,j.viewSize[1]||c&&b.outerHeight(c,!0)*a];break;case "fade":var i=
h*a,n=i+a-1,m;d.each(e,function(a,c){m=c>=i&&c<=n;b.css(a,{opacity:m?1:0,position:"absolute",zIndex:m?9:1})})}}});d.augment(n,{_switchView:function(b,g,f){var e=this,j=e.config.effect;(d.isFunction(j)?j:m[j]).call(e,function(){e._fireOnSwitch(g);f&&f.call(e)},b)}});return n},{requires:["dom","event","anim","./base"]});
KISSY.add("switchable/lazyload",function(d,b,i){var j="beforeSwitch",n="img",g="textarea",m={};m[n]="lazyImgAttribute";m[g]="lazyTextareaClass";d.mix(i.Config,{lazyImgAttribute:"data-ks-lazyload-custom",lazyTextareaClass:"ks-datalazyload-custom",lazyDataType:g});i.addPlugin({name:"lazyload",init:function(k){function i(c){var d=e.steps,c=c.toIndex*d;f.loadCustomLazyData(k.panels.slice(c,c+d),l,a);a:{var m,s,u;if(c=(d=l===n)?"img":l===g?"textarea":""){c=b.query(c,k.container);m=0;for(u=c.length;m<u;m++)if(s=
c[m],d?b.attr(s,a):b.hasClass(s,a)){d=!1;break a}}d=!0}d&&k.detach(j,i)}var f=d.require("datalazyload"),e=k.config,l,a;"img-src"===e.lazyDataType&&(e.lazyDataType=n);"area-data"===e.lazyDataType&&(e.lazyDataType=g);l=e.lazyDataType;a=e[m[l]];if(f&&l&&a)k.on(j,i)}});return i},{requires:["dom","./base"]});
KISSY.add("switchable/seamless",function(d,b,i){i.addPlugin({name:"seamless",priority:5,init:function(d){var i=d.config,g=d.panels,m=d.container,k=i.effect;if(1==i.steps&&g.length&&i.circular){var p=1,f,e,l,m=[b.width(m),b.height(m)],a;"scrollx"==k?(e="left",p=Math.floor(m[0]/(f=g[0].offsetWidth))):"scrolly"==k&&(e="top",p=Math.floor(m[1]/(f=g[0].offsetHeight)));p<=i.steps||(a=f*g.length,l=g.length-p+1,d.on("beforeSwitch",function(c){c=c.toIndex;if(c>=l){c=Math.abs(c-l);b.css(g[c],"position","relative");
b.css(g[c],e,a)}else if(!c){b.css(g[p-1],{position:"relative"});b.css(g[p-1],e,a)}}),d.on("switch",function(a){if(a.currentIndex==0)for(a=1;a<p;a++){b.css(g[a],{position:""});b.css(g[a],e,"")}}))}}})},{requires:["dom","./base"]});KISSY.add("switchable/slide/base",function(d,b){function i(b,d){if(!(this instanceof i))return new i(b,d);i.superclass.constructor.apply(this,arguments)}i.Config={autoplay:!0,circular:!0};d.extend(i,b);return i},{requires:["../base"]});
KISSY.add("switchable",function(d,b,i,j,n,g){d.mix(b,{Accordion:i,Carousel:j,Slide:n,Tabs:g});return d.Switchable=b},{requires:"switchable/base,switchable/accordion/base,switchable/carousel/base,switchable/slide/base,switchable/tabs/base,switchable/lazyload,switchable/effect,switchable/circular,switchable/carousel/aria,switchable/autoplay,switchable/aria,switchable/tabs/aria,switchable/accordion/aria".split(",")});
KISSY.add("switchable/tabs/aria",function(d,b,i,j,n,g){function m(a){var c=null;d.each(this.triggers,function(e){if(e==a||b.contains(e,a))c=e});return c}function k(a){switch(a.keyCode){case e:case l:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case s:a.ctrlKey&&!a.altKey&&a.halt()}}function p(b){var d=b.target,f=b.ctrlKey&&!b.shiftKey&&!b.altKey;switch(b.keyCode){case a:case c:m.call(this,d)&&(this.prev(r(b)),b.halt());break;case h:case t:m.call(this,d)&&(this.next(r(b)),b.halt());break;case l:f&&
(b.halt(),this.next(r(b)));break;case e:f&&(b.halt(),this.prev(r(b)));break;case s:b.ctrlKey&&!b.altKey&&(b.halt(),b.shiftKey?this.prev(r(b)):this.next(r(b)))}}function f(a){var b=!(!a.originalEvent.target&&!a.originalEvent.srcElement),c=a.fromIndex,e=a.currentIndex;if(c!=e){var a=this.triggers[c],d=this.triggers[e],c=this.panels[c],e=this.panels[e];a&&u(a,"-1");u(d,"0");b&&d.focus();c&&c.setAttribute("aria-hidden","true");e.setAttribute("aria-hidden","false")}}var e=33,l=34,a=37,c=38,h=39,t=40,s=
9;d.mix(g.Config,{aria:!0});j.addPlugin({name:"aria",init:function(a){function c(a){a.setAttribute("role","tab");u(a,"-1");a.id||(a.id=d.guid("ks-switchable"))}function e(a,b){a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden","true");a.setAttribute("aria-labelledby",b.id)}if(a.config.aria){var g=a.triggers,h=a.activeIndex,j=a.panels,l=a.container;a.nav&&b.attr(a.nav,"role","tablist");var m=0;d.each(g,c);a.on("added",function(a){var b;c(b=a.trigger);e(a.panel,b)});m=0;d.each(j,function(a){e(a,
g[m]);m++});-1<h&&(u(g[h],"0"),j[h].setAttribute("aria-hidden","false"));a.on("switch",f,a);i.on(l,"keydown",p,a);i.on(l,"keypress",k,a)}}},g);var u=n.setTabIndex,r=j.getDomEvent},{requires:["dom","event","../base","../aria","./base"]});KISSY.add("switchable/tabs/base",function(d,b){function i(b,d){if(!(this instanceof i))return new i(b,d);i.superclass.constructor.call(this,b,d);return 0}d.extend(i,b);i.Config={};return i},{requires:["../base"]});
KISSY.add("switchable/touch",function(d,b,i,j,n){d.mix(j.Config,{mouseAsTouch:!1});j.addPlugin({name:"touch",init:function(g){if(!g._realStep){var m=g.config,k=m.scrollType||m.effect;if("scrolly"==k||"scrollx"==k){var p=g.content,f=g.container,e,l=m.mouseAsTouch,a,c=0,h=0,t={},s={},u="left",r,o;"scrolly"==k&&(u="top");var x=function(){if("relative"!=g.panels[g.activeIndex].style.position){g.stop&&g.stop();h=1;t=b.offset(p);var a=b.offset(f);a.bottom=a.top+f.offsetHeight;a.right=a.left+f.offsetWidth;
s=a}},w=function(d){if(h){var f=-1!=d.type.indexOf("touch")?d.originalEvent.changedTouches[0]:d,i={};"scrolly"==k?(o=g.viewSize[1],r=f.pageY-a,i.top=t.top+r,f=f.pageY>=s.top&&f.pageY<=s.bottom):(o=g.viewSize[0],r=f.pageX-e,i.left=t.left+r,f=f.pageX>=s.left&&f.pageX<=s.right);if(c||3<Math.abs(r))(-1!=d.type.indexOf("touch")&&d.preventDefault(),g.anim&&(g.anim.stop(),g.anim=n),f)?(c||(c=1,m.circular&&(d=g.activeIndex,f=g.length-1,d==f?j.adjustPosition.call(g,g.panels,0,u,o):0==d&&j.adjustPosition.call(g,
g.panels,f,u,o))),b.offset(p,i)):v()}},v=function(){if(c){h=c=0;var a=g.activeIndex,b=g.length-1;if(!m.circular&&(0>r&&a==b||0<r&&0==a))j.Effects[k].call(g,n,n,!0);else{if(!(0>r&&a==b)&&!(0<r&&0==a)&&(0==a||a==b))j.resetPosition.call(g,g.panels,0==a?b:0,u,o);g[0>r?"next":"prev"]();g.start&&g.start()}}};i.on(p,"touchstart",function(b){x();e=b.pageX;a=b.pageY});i.on(p,"touchmove",w);i.on(p,"touchend",v);l&&!("ontouchstart"in d.Env.host.document.documentElement)&&d.use("dd",function(b,c){var d=new c.Draggable({node:p});
d.on("dragstart",function(){x();e=d.startMousePos.left;a=d.startMousePos.top});d.on("drag",w);d.on("dragend",v);g.__touchDD=d})}}},destroy:function(b){var d;(d=b.__touchDD)&&d.destroy()}})},{requires:["dom","event","./base"]});
