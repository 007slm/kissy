/*
Copyright 2012, KISSY UI Library v1.30dev
MIT Licensed
build time: May 17 18:27
*/
KISSY.add("switchable/accordion/aria",function(d,c,j,h,l){function g(a){var b=null;d.each(this.triggers,function(i){if(i==a||c.contains(i,a))b=i});return b}function m(a){var b;d.each(this.panels,function(i){if(i==a||c.contains(i,a))b=i});return b}function e(a){var b=g.call(this,a);b||(a=m.call(this,a),b=this.triggers[d.indexOf(a,this.panels)]);return b}function o(a){switch(a.keyCode){case v:case u:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case x:a.ctrlKey&&!a.altKey&&a.halt()}}function k(f){var c=
f.target,k=this.triggers,o=!f.ctrlKey&&!f.shiftKey&&!f.altKey,h=f.ctrlKey&&!f.shiftKey&&!f.altKey;switch(f.keyCode){case y:case q:if((c=g.call(this,c))&&o)this.switchTo(d.indexOf(c,this.triggers)),f.halt();break;case s:case r:if(c=g.call(this,c))b.call(this,c),f.halt();break;case z:case p:if(c=g.call(this,c))i.call(this,c),f.halt();break;case u:h&&(f.halt(),c=e.call(this,c),i.call(this,c));break;case v:h&&(f.halt(),c=e.call(this,c),b.call(this,c));break;case n:o&&(e.call(this,c),a.call(this,0,!0),
f.halt());break;case t:o&&(e.call(this,c),a.call(this,k.length-1,!0),f.halt());break;case x:f.ctrlKey&&!f.altKey&&(f.halt(),c=e.call(this,c),f.shiftKey?b.call(this,c):i.call(this,c))}}function a(a,b){var f=this.triggers,i=f[a];d.each(f,function(a){a!==i&&(w(a,"-1"),c.removeClass(a,"ks-switchable-select"),a.setAttribute("aria-selected","false"))});b&&i.focus();w(i,"0");c.addClass(i,"ks-switchable-select");i.setAttribute("aria-selected","true")}function b(b){var f=this.triggers,b=d.indexOf(b,f);a.call(this,
0==b?f.length-1:b-1,!0)}function i(b){var f=this.triggers,b=d.indexOf(b,f);a.call(this,b==f.length-1?0:b+1,!0)}function f(b){var f=!(!b.originalEvent.target&&!b.originalEvent.srcElement),b=b.currentIndex,i=this.panels,c=this.triggers,e=c[b],p=i[b];this.config.multiple||(d.each(i,function(a){a!==p&&a.setAttribute("aria-hidden","true")}),d.each(c,function(a){a!==e&&a.setAttribute("aria-hidden","true")}));i=p.getAttribute("aria-hidden");p.setAttribute("aria-hidden","false"==i?"true":"false");e.setAttribute("aria-expanded",
"false"==i?"false":"true");a.call(this,b,f)}var v=33,u=34,t=35,n=36,s=37,r=38,z=39,p=40,x=9,q=32,y=13;d.mix(l.Config,{aria:!0});l.Plugins.push({name:"aria",init:function(a){if(a.config.aria){var b=a.container,i=a.activeIndex;c.attr(b,"aria-multiselectable",a.config.multiple?"true":"false");a.nav&&c.attr(a.nav,"role","tablist");var e=a.triggers,p=a.panels,q=0;d.each(p,function(a){a.id||(a.id=d.guid("ks-accordion-tab-panel"))});d.each(e,function(a){a.id||(a.id=d.guid("ks-accordion-tab"))});d.each(e,
function(a){a.setAttribute("role","tab");a.setAttribute("aria-expanded",i==q?"true":"false");a.setAttribute("aria-selected",i==q?"true":"false");a.setAttribute("aria-controls",p[q].id);w(a,i==q?"0":"-1");q++});q=0;d.each(p,function(a){var b=e[q];a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden",i==q?"false":"true");a.setAttribute("aria-labelledby",b.id);q++});a.on("switch",f,a);j.on(b,"keydown",k,a);j.on(b,"keypress",o,a)}}});var w=h.setTabIndex},{requires:["dom","event","../aria","./base"]});
KISSY.add("switchable/accordion/base",function(d,c,j){function h(c,d){if(!(this instanceof h))return new h(c,d);h.superclass.constructor.apply(this,arguments)}d.extend(h,j,{_switchTrigger:function(d,g){var j=this.config;j.multiple?c.toggleClass(g,j.activeTriggerCls):h.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(c){return this.config.multiple||h.superclass._triggerIsValid.call(this,c)},_switchView:function(d,g,j){var e=this.config,o=this._getFromToPanels().toPanels;e.multiple?
(c.toggle(o),this._fireOnSwitch(g),j&&j.call(this)):h.superclass._switchView.apply(this,arguments)}});h.Plugins=[];h.Config={markupType:1,triggerType:"click",multiple:!1};return h},{requires:["dom","../base"]});
KISSY.add("switchable/aria",function(d,c,j,h){function l(){this.stop&&this.stop()}function g(){this.start&&this.start()}h.Plugins.push({name:"aria",init:function(c){if(c.config.aria){var d=c.container;j.on(d,"focusin",l,c);j.on(d,"focusout",g,c)}}});var m=["a","input","button","object"];return{setTabIndex:function(e,o){e.tabIndex=o;d.each(c.query("*",e),function(e){var a=e.nodeName.toLowerCase();d.inArray(a,m)&&(c.hasAttr(e,"oriTabIndex")||c.attr(e,"oriTabIndex",e.tabIndex),e.tabIndex=-1!=o?c.attr(e,
"oriTabIndex"):o)})}}},{requires:["dom","event","./base"]});
KISSY.add("switchable/autoplay",function(d,c,j,h,l){var g=d.Env.host,m=function(e){var d=c.scrollTop(),k=c.viewportHeight(),a=c.offset(e),e=c.height(e);return a.top>d&&a.top+e<d+k};d.mix(h.Config,{pauseOnScroll:!1,autoplay:!1,interval:5,pauseOnHover:!0});h.Plugins.push({name:"autoplay",init:function(c){function h(){b=d.later(function(){c.paused||c.next()},a,!0)}var k=c.config,a=1E3*k.interval,b;if(k.autoplay&&(k.pauseOnScroll&&(c.__scrollDetect=d.buffer(function(){c[m(c.container)?"start":"stop"]()},
200),j.on(g,"scroll",c.__scrollDetect)),h(),c.stop=function(){if(b){b.cancel();b=l}c.paused=true},c.start=function(){if(b){b.cancel();b=l}c.paused=false;h()},k.pauseOnHover))j.on(c.container,"mouseenter",c.stop,c),j.on(c.container,"mouseleave",c.start,c)},destroy:function(c){c.__scrollDetect&&j.remove(g,"scroll",c.__scrollDetect)}});return h},{requires:["dom","event","./base"]});
KISSY.add("switchable/autorender",function(d,c,j,h){h.autoRender=function(l,g){d.each(c.query("."+(l||"KS_Widget"),g),function(c){var d=c.getAttribute("data-widget-type"),g;if(d&&-1<"Switchable Tabs Slide Carousel Accordion".indexOf(d))try{(g=c.getAttribute("data-widget-config"))&&(g=g.replace(/'/g,'"')),new ("Switchable"==d?h:h[d])(c,j.parse(g))}catch(k){}})}},{requires:["dom","json","./base"]});
KISSY.add("switchable/base",function(d,c,j,h){function l(a,b){b=b||{};"markupType"in b||(b.panelCls?b.markupType=1:b.panels&&(b.markupType=2));for(var i=this.constructor;i;)b=d.merge(i.Config,b),i=i.superclass?i.superclass.constructor:null;this.container=c.get(a);this.config=b;this.activeIndex=b.activeIndex;var f;-1<this.activeIndex||("number"==typeof b.switchTo?f=b.switchTo:this.activeIndex=0);this._init();this._initPlugins();this.fire(o);f!==h&&this.switchTo(f)}function g(a){var b={};b.type=a.type;
b.target=a.target;return{originalEvent:b}}var m=d.makeArray,e=j.Target,o="init",k="remove";l.getDomEvent=g;l.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:!0,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:h,steps:1,viewSize:[]};l.Plugins=[];d.augment(l,e,{_initPlugins:function(){for(var a=this,b=[],c=a.constructor;c;)b.push.apply(b,
c.Plugins.reverse()),c=c.superclass?c.superclass.constructor:null;b.reverse();d.each(b,function(b){b.init&&b.init(a)})},_init:function(){var a=this.config;this._parseMarkup();a.hasTriggers&&this._bindTriggers();this._bindPanels()},_parseMarkup:function(){var a=this.container,b=this.config,i,f,d=[],e=[];switch(b.markupType){case 0:(i=c.get("."+b.navCls,a))&&(d=c.children(i));f=c.get("."+b.contentCls,a);e=c.children(f);break;case 1:d=c.query("."+b.triggerCls,a);e=c.query("."+b.panelCls,a);break;case 2:d=
b.triggers,e=b.panels}this.length=Math.ceil(e.length/b.steps);this.nav=i||b.hasTriggers&&d[0]&&d[0].parentNode;if(b.hasTriggers&&(!this.nav||0==d.length))d=this._generateTriggersMarkup(this.length);this.triggers=m(d);this.panels=m(e);this.content=f||e[0].parentNode},_generateTriggersMarkup:function(a){var b=this.config,i=this.nav||c.create("<ul>"),f,d;i.className=b.navCls;for(d=0;d<a;d++)f=c.create("<li>"),d===this.activeIndex&&(f.className=b.activeTriggerCls),f.innerHTML=d+1,i.appendChild(f);this.container.appendChild(i);
this.nav=i;return c.children(i)},_bindTriggers:function(){var a=this,b=a.config,c=d.one(a.nav);d.each(a.triggers,function(b){a._initTrigger(b)});c.delegate("click",".ks-switchable-trigger-internal",function(b){var c=a._getTriggerIndex(b.currentTarget);a._onFocusTrigger(c,b)});"mouse"===b.triggerType&&c.delegate("mouseenter",".ks-switchable-trigger-internal",function(b){var c=a._getTriggerIndex(b.currentTarget);a._onMouseEnterTrigger(c,b)}).delegate("mouseleave",".ks-switchable-trigger-internal",function(){a._onMouseLeaveTrigger()})},
_initTrigger:function(a){c.addClass(a,"ks-switchable-trigger-internal")},_bindPanels:function(){var a=this;d.each(a.panels,function(b){a._initPanel(b)})},_initPanel:function(a){c.addClass(a,"ks-switchable-panel-internal")},_onFocusTrigger:function(a,b){this._triggerIsValid(a)&&(this._cancelSwitchTimer(),this.switchTo(a,h,g(b)))},_onMouseEnterTrigger:function(a,b){var c=this;if(c._triggerIsValid(a)){var f=g(b);c.switchTimer=d.later(function(){c.switchTo(a,h,f)},1E3*c.config.delay)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},
_triggerIsValid:function(a){return this.activeIndex!==a},_cancelSwitchTimer:function(){this.switchTimer&&(this.switchTimer.cancel(),this.switchTimer=h)},_getTriggerIndex:function(a){return d.indexOf(a,this.triggers)},_resetLength:function(){this.length=this._getLength()},_getLength:function(a){var b=this.config;a===h&&(a=this.panels.length);return Math.ceil(a/b.steps)},_afterAdd:function(a,b,c){this._resetLength();a=this._getLength(a+1)-1;1==this.config.steps&&this.activeIndex>=a&&(this.activeIndex+=
1);var f=this.activeIndex;this.activeIndex=-1;this.switchTo(f);b?this.switchTo(a,h,h,c):c()},add:function(a){var b=a.callback||d.noop,i=this.nav,f=this.content,e=a.trigger,h=a.panel,g=a.active,n=this.panels.length,a=null!=a.index?a.index:n,k=this.triggers,r=this.panels,j=this.length,p=null,p=null,a=Math.max(0,Math.min(a,n)),n=r[a]||null;r.splice(a,0,h);f.insertBefore(h,n);1==this.config.steps?(p=k[a],i.insertBefore(e,p),k.splice(a,0,e)):(p=this._getLength(),p!=j&&(c.append(e,i),k.push(e)));this._initPanel(h);
this._initTrigger(e);this._afterAdd(a,g,b);this.fire("add",{index:a,trigger:e,panel:h})},remove:function(a){function b(){l&&(c.remove(l),j.splice(n,1));if(r){c.remove(r);for(var a=0;a<o.length;a++)if(o[a]==r){f.triggers.splice(a,1);break}}f._resetLength();f.fire(k,{index:n,trigger:r,panel:l})}var i=a.callback||d.noop,f=this,e=f.config.steps,g=f.length,j=f.panels,n=a.index||a.panel,a=f._getLength(j.length-1),o=f.triggers,r=null,l=null;if(j.length&&(n=d.isNumber(n)?Math.max(0,Math.min(n,j.length-1)):
d.indexOf(n,j),r=1==e?o[n]:a!==g?o[g-1]:null,l=j[n],!1!==f.fire("beforeRemove",{index:n,panel:l,trigger:r})))if(0==a)b(),i();else{var p=f.activeIndex;1<e?p==a?f.switchTo(p-1,h,h,function(){b();i()}):(b(),f.activeIndex=-1,f.switchTo(p,h,h,function(){i()})):p==n?f.switchTo(0<p?p-1:p+1,h,h,function(){b();0==p&&(f.activeIndex=0);i()}):(p>n&&(p--,f.activeIndex=p),b(),i())}},switchTo:function(a,b,c,f){var d=this,e=d.config,g=d.activeIndex,k=d.triggers;if(!d._triggerIsValid(a)||!1===d.fire("beforeSwitch",
{fromIndex:g,toIndex:a}))return d;d.fromIndex=g;e.hasTriggers&&d._switchTrigger(k[g]||null,k[a]);b===h&&(b=a>g?"forward":"backward");d.activeIndex=a;d._switchView(b,c,function(){f&&f.call(d)});return d},_switchTrigger:function(a,b){var d=this.config.activeTriggerCls;a&&c.removeClass(a,d);c.addClass(b,d)},_getFromToPanels:function(){var a=this.fromIndex,b;b=this.config.steps;var c=this.panels,d=this.activeIndex,a=-1<a?c.slice(a*b,(a+1)*b):null;b=c.slice(d*b,(d+1)*b);return{fromPanels:a,toPanels:b}},
_switchView:function(a,b,d){var f=this,e=f._getFromToPanels(),a=e.fromPanels,e=e.toPanels;a&&c.css(a,"display","none");c.css(e,"display","block");setTimeout(function(){f._fireOnSwitch(b)},0);d&&d.call(this)},_fireOnSwitch:function(a){this.fire("switch",d.merge(a,{fromIndex:this.fromIndex,currentIndex:this.activeIndex}))},prev:function(a){this.switchTo((this.activeIndex-1+this.length)%this.length,"backward",a)},next:function(a){this.switchTo((this.activeIndex+1)%this.length,"forward",a)},destroy:function(a){for(var b=
this,i=b.constructor;i;)d.each(i.Plugins,function(a){a.destroy&&a.destroy(b)}),i=i.superclass?i.superclass.constructor:null;a?j.remove(b.container):c.remove(b.container);b.nav=null;b.content=null;b.container=null;b.triggers=[];b.panels=[];b.detach()}});return l},{requires:["dom","event"]});
KISSY.add("switchable/carousel/aria",function(d,c,j,h,l){function g(a){var b=a.currentIndex,c=this.activeIndex,f=this.panels,i=f[b*this.config.steps],e=this.triggers,b=e[b];if((a=!(!a.originalEvent.target&&!a.originalEvent.srcElement))||-1==c)d.each(e,function(a){n(a,-1)}),d.each(f,function(a){n(a,-1)}),b&&n(b,0),n(i,0),a&&i.focus()}function m(a){var b=null;d.each(this.triggers,function(d){if(d==a||c.contains(d,a))return b=d,!1});return b}function e(a){var e=a.target;switch(a.keyCode){case v:case f:if(e=
m.call(this,e)){var q=c.next(e),g=this.triggers;q||(q=g[0]);n(e,-1);q&&(n(q,0),q.focus());a.halt()}break;case i:case b:if(e=m.call(this,e))q=c.prev(e),g=this.triggers,q||(q=g[g.length-1]),n(e,-1),q&&(n(q,0),q.focus()),a.halt();break;case t:case u:if(e=m.call(this,e))this.switchTo(d.indexOf(e,this.triggers),void 0,s),a.halt()}}function o(a){var b=null;d.each(this.panels,function(d){if(d==a||c.contains(d,a))return b=d,!1});return b}function k(a,b){var c=d.indexOf(a,this.panels),f=this.config.steps,
e=Math.floor(c/f);return e==this.activeIndex?1:0==c%f||c%f==f-1?(this.switchTo(e,b,s),0):1}function a(a){var d=a.target;switch(a.keyCode){case v:case f:if(d=o.call(this,d)){var e=c.next(d),g=this.panels;e||(e=g[0]);n(d,-1);n(e,0);k.call(this,e,r)&&e.focus();a.halt()}break;case i:case b:if(d=o.call(this,d))e=c.prev(d),g=this.panels,e||(e=g[g.length-1]),n(d,-1),n(e,0),k.call(this,e,z)&&e.focus(),a.halt();break;case t:case u:if(d=o.call(this,d))this.fire("itemSelected",{item:d}),a.halt()}}var b=37,i=
38,f=39,v=40,u=32,t=13,n=h.setTabIndex,s={originalEvent:{target:1}},r="forward",z="backward";d.mix(l.Config,{aria:!1});l.Plugins.push({name:"aria",init:function(b){if(b.config.aria){var c=b.triggers,f=b.panels,i=b.content,r=b.activeIndex;i.id||(i.id=d.guid("ks-switchbale-content"));i.setAttribute("role","listbox");var h=0;d.each(c,function(a){n(a,r==h?"0":"-1");a.setAttribute("role","button");a.setAttribute("aria-controls",i.id);h++});h=0;d.each(f,function(a){n(a,"-1");a.setAttribute("role","option");
h++});b.on("switch",g,b);if(c=b.nav)j.on(c,"keydown",e,b);j.on(i,"keydown",a,b);c=b.prevBtn;f=b.nextBtn;c&&(n(c,0),c.setAttribute("role","button"),j.on(c,"keydown",function(a){if(a.keyCode==t||a.keyCode==u){b.prev(s);a.preventDefault()}}));f&&(n(f,0),f.setAttribute("role","button"),j.on(f,"keydown",function(a){if(a.keyCode==t||a.keyCode==u){b.next(s);a.preventDefault()}}))}}})},{requires:["dom","event","../aria","./base"]});
KISSY.add("switchable/carousel/base",function(d,c,j,h){function l(c,d){if(!(this instanceof l))return new l(c,d);l.superclass.constructor.apply(this,arguments)}var g="prevBtn",m="nextBtn",e={originalEvent:{target:1}};l.Config={circular:!0,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};l.Plugins=[];d.extend(l,h,{_init:function(){function h(a){c.removeClass([k[g],k[m]],b);0==a&&c.addClass(k[g],b);a==k.length-1&&c.addClass(k[m],b)}var k=
this;l.superclass._init.call(k);var a=k.config,b=a.disableBtnCls;d.each(["prev","next"],function(b){var d=k[b+"Btn"]=c.get("."+a[b+"BtnCls"],k.container);j.on(d,"mousedown",function(c){c.preventDefault();c=k.activeIndex;if("prev"==b&&(0!=c||a.circular))k[b](e);if("next"==b&&(c!=k.length-1||a.circular))k[b](e)})});a.circular||(k.on("added removed",function(){h(k.activeIndex)}),k.on("switch",function(a){h(a.currentIndex)}));j.delegate(k.content,"click",".ks-switchable-panel-internal",function(a){k.fire("itemSelected",
{item:a.currentTarget})})}});return l},{requires:["dom","event","../base"]});
KISSY.add("switchable/circular",function(d,c,j,h){function l(b,d){var e=this,h=e.fromIndex,r=e.config,o=e.length,p=r.scrollType===v,l=p?k:a,q=e.activeIndex,y=e.viewSize[p?0:1],p=-y*q,w=e.panels,D=e.config.steps,B={},C,A=d===f;C=A&&0===h&&q===o-1||!A&&h===o-1&&0===q;e.anim&&(e.anim.stop(),"relative"==w[h*D].style.position&&m.call(e,w,h,l,y,1));C&&(p=g.call(e,w,A,l,y));B[l]=p+i;-1<h?e.anim=(new j(e.content,B,r.duration,r.easing,function(){C&&m.call(e,w,A,l,y,1);e.anim=void 0;b&&b()})).run():(c.css(e.content,
B),b&&b())}function g(a,b,d,f){var i=this.config.steps,h=this.length,g=b?h-1:0,a=a.slice(g*i,(g+1)*i);c.css(a,e,o);c.css(a,d,(b?-1:1)*f*h);return b?f:-f*h}function m(a,d,f,i,h){var g=this.config.steps,k=this.length,j=d?k-1:0,a=a.slice(j*g,(j+1)*g);c.css(a,e,b);c.css(a,f,b);h&&c.css(this.content,f,d?-i*(k-1):b)}var e="position",o="relative",k="left",a="top",b="",i="px",f="backward",v="scrollx";d.mix(h.Config,{circular:!1});h.adjustPosition=g;h.resetPosition=m;h.Plugins.push({name:"circular",init:function(a){a=
a.config;if(a.circular&&(a.effect===v||"scrolly"===a.effect))a.scrollType=a.effect,a.effect=l}})},{requires:["dom","anim","./base","./effect"]});
KISSY.add("switchable/effect",function(d,c,j,h,l,g){var m;d.mix(l.Config,{effect:"none",duration:0.5,easing:"easeNone"});l.Effects={none:function(d){var h=this._getFromToPanels(),g=h.fromPanels,h=h.toPanels;g&&c.css(g,"display","none");c.css(h,"display","block");d&&d()},fade:function(d){var j=this,k=j._getFromToPanels(),a=k.fromPanels,b=j.config,i=a?a[0]:null,f=k.toPanels[0];j.anim&&(j.anim.stop(),c.css(j.anim.fromEl,{zIndex:1,opacity:0}),c.css(j.anim.toEl,"zIndex",9));c.css(f,"opacity",1);i?(j.anim=
(new h(i,{opacity:0},b.duration,b.easing,function(){j.anim=g;c.css(f,"z-index",9);c.css(i,"z-index",1);d&&d()})).run(),j.anim.toEl=f,j.anim.fromEl=i):(c.css(f,"z-index",9),d&&d())},scroll:function(d,j){var k=this,a=k.fromIndex,b=k.config,i="scrollx"===b.effect,f={};f[i?"left":"top"]=-(k.viewSize[i?0:1]*k.activeIndex)+"px";k.anim&&k.anim.stop();j||-1<a?k.anim=(new h(k.content,f,b.duration,b.easing,function(){k.anim=g;d&&d()})).run():(c.css(k.content,f),d&&d())}};m=l.Effects;m.scrollx=m.scrolly=m.scroll;
l.Plugins.push({name:"effect",init:function(e){var h=e.config,g=h.effect,a=e.panels,b=e.content,i=h.steps,f=a[0],j=e.activeIndex;if("none"!==g)switch(c.css(a,"display","block"),g){case "scrollx":case "scrolly":c.css(b,"position","absolute");"static"==c.css(b.parentNode,"position")&&c.css(b.parentNode,"position","relative");"scrollx"===g&&(c.css(a,"float","left"),c.width(b,"9999px"));e.viewSize=[h.viewSize[0]||f&&f.offsetWidth*i,h.viewSize[1]||f&&f.offsetHeight*i];break;case "fade":var l=j*i,m=l+i-
1,n;d.each(a,function(a,b){n=b>=l&&b<=m;c.css(a,{opacity:n?1:0,position:"absolute",zIndex:n?9:1})})}}});d.augment(l,{_switchView:function(c,h,g){var a=this,b=a.config.effect;(d.isFunction(b)?b:m[b]).call(a,function(){a._fireOnSwitch(h);g&&g.call(a)},c)}});return l},{requires:["dom","event","anim","./base"]});
KISSY.add("switchable/lazyload",function(d,c,j){var h="beforeSwitch",l="img",g="textarea",m={};m[l]="lazyImgAttribute";m[g]="lazyTextareaClass";d.mix(j.Config,{lazyImgAttribute:"data-ks-lazyload-custom",lazyTextareaClass:"ks-datalazyload-custom",lazyDataType:g});j.Plugins.push({name:"lazyload",init:function(e){function j(d){var m=a.steps,d=d.toIndex*m;k.loadCustomLazyData(e.panels.slice(d,d+m),b,i);a:{var u,t,n;if(d=(m=b===l)?"img":b===g?"textarea":""){d=c.query(d,e.container);u=0;for(n=d.length;u<
n;u++)if(t=d[u],m?c.attr(t,i):c.hasClass(t,i)){m=!1;break a}}m=!0}m&&e.detach(h,j)}var k=d.require("datalazyload"),a=e.config,b,i;"img-src"===a.lazyDataType&&(a.lazyDataType=l);"area-data"===a.lazyDataType&&(a.lazyDataType=g);b=a.lazyDataType;i=a[m[b]];if(k&&b&&i)e.on(h,j)}});return j},{requires:["dom","./base"]});
KISSY.add("switchable/slide/base",function(d,c){function j(c,d){if(!(this instanceof j))return new j(c,d);j.superclass.constructor.apply(this,arguments)}j.Config={autoplay:!0,circular:!0};j.Plugins=[];d.extend(j,c);return j},{requires:["../base"]});KISSY.add("switchable",function(d,c,j,h,l,g,m,e,o,k,a,b,i,f){d.mix(c,{Accordion:h,Carousel:e,Slide:i,Tabs:f,Aria:j});return c},{requires:"switchable/base,switchable/aria,switchable/accordion/base,switchable/accordion/aria,switchable/autoplay,switchable/autorender,switchable/carousel/base,switchable/carousel/aria,switchable/circular,switchable/effect,switchable/lazyload,switchable/slide/base,switchable/tabs/base,switchable/tabs/aria".split(",")});
KISSY.add("switchable/tabs/aria",function(d,c,j,h,l,g){function m(a){var b=null;d.each(this.triggers,function(d){if(d==a||c.contains(d,a))b=d});return b}function e(c){switch(c.keyCode){case a:case b:c.ctrlKey&&!c.altKey&&!c.shiftKey&&c.halt();break;case t:c.ctrlKey&&!c.altKey&&c.halt()}}function o(c){var d=c.target,e=c.ctrlKey&&!c.shiftKey&&!c.altKey;switch(c.keyCode){case i:case f:m.call(this,d)&&(this.prev(s(c)),c.halt());break;case v:case u:m.call(this,d)&&(this.next(s(c)),c.halt());break;case b:e&&
(c.halt(),this.next(s(c)));break;case a:e&&(c.halt(),this.prev(s(c)));break;case t:c.ctrlKey&&!c.altKey&&(c.halt(),c.shiftKey?this.prev(s(c)):this.next(s(c)))}}function k(a){var c=!(!a.originalEvent.target&&!a.originalEvent.srcElement),b=a.fromIndex,d=a.currentIndex;if(b!=d){var a=this.triggers[b],e=this.triggers[d],b=this.panels[b],d=this.panels[d];a&&n(a,"-1");n(e,"0");c&&e.focus();b&&b.setAttribute("aria-hidden","true");d.setAttribute("aria-hidden","false")}}var a=33,b=34,i=37,f=38,v=39,u=40,t=
9;d.mix(g.Config,{aria:!0});g.Plugins.push({name:"aria",init:function(a){function b(a){a.setAttribute("role","tab");n(a,"-1");a.id||(a.id=d.guid("ks-switchable"))}function f(a,b){a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden","true");a.setAttribute("aria-labelledby",b.id)}if(a.config.aria){var h=a.triggers,g=a.activeIndex,i=a.panels,l=a.container;a.nav&&c.attr(a.nav,"role","tablist");var m=0;d.each(h,b);a.on("added",function(a){var c;b(c=a.trigger);f(a.panel,c)});m=0;d.each(i,function(a){f(a,
h[m]);m++});-1<g&&(n(h[g],"0"),i[g].setAttribute("aria-hidden","false"));a.on("switch",k,a);j.on(l,"keydown",o,a);j.on(l,"keypress",e,a)}}});var n=l.setTabIndex,s=h.getDomEvent},{requires:["dom","event","../base","../aria","./base"]});KISSY.add("switchable/tabs/base",function(d,c){function j(c,d){if(!(this instanceof j))return new j(c,d);j.superclass.constructor.call(this,c,d);return 0}d.extend(j,c);j.Config={};j.Plugins=[];return j},{requires:["../base"]});
KISSY.add("switchable/touch",function(d,c,j,h,l){d.mix(h.Config,{mouseAsTouch:!1});h.Plugins.push({name:"touch",init:function(g){var m=g.config,e=m.scrollType||m.effect;if("scrolly"==e||"scrollx"==e){var o=g.content,k=g.container,a,b=m.mouseAsTouch,i,f=0,v=0,u={},t={},n="left",s,r;"scrolly"==e&&(n="top");var z=function(){if("relative"!=g.panels[g.activeIndex].style.position){g.stop&&g.stop();v=1;u=c.offset(o);var a=c.offset(k);a.bottom=a.top+k.offsetHeight;a.right=a.left+k.offsetWidth;t=a}},p=function(b){if(v){var d=
-1!=b.type.indexOf("touch")?b.originalEvent.changedTouches[0]:b,j={};"scrolly"==e?(r=g.viewSize[1],s=d.pageY-i,j.top=u.top+s,d=d.pageY>=t.top&&d.pageY<=t.bottom):(r=g.viewSize[0],s=d.pageX-a,j.left=u.left+s,d=d.pageX>=t.left&&d.pageX<=t.right);if(f||3<Math.abs(s))(-1!=b.type.indexOf("touch")&&b.preventDefault(),g.anim&&(g.anim.stop(),g.anim=l),d)?(f||(f=1,m.circular&&(b=g.activeIndex,b==g.length-1?h.adjustPosition.call(g,g.panels,!1,n,r):0==b&&h.adjustPosition.call(g,g.panels,!0,n,r))),c.offset(o,
j)):x()}},x=function(){if(f){v=f=0;var a=g.activeIndex,b=g.length-1;!m.circular&&(0>s&&a==b||0<s&&0==a)?h.Effects[e].call(g,l,!0):(0>s&&a==b||0<s&&0==a||(0==a||a==b)&&h.resetPosition.call(g,g.panels,0==a,n,r),g[0>s?"next":"prev"](),g.start&&g.start())}};j.on(o,"touchstart",function(b){z();a=b.pageX;i=b.pageY});j.on(o,"touchmove",p);j.on(o,"touchend",x);b&&!("ontouchstart"in d.Env.host.document.documentElement)&&d.use("dd",function(b,c){var d=new c.Draggable({node:o});d.on("dragstart",function(){z();
a=d.startMousePos.left;i=d.startMousePos.top});d.on("drag",p);d.on("dragend",x);g.__touchDD=d})}},destroy:function(c){var d;(d=c.__touchDD)&&d.destroy()}})},{requires:["dom","event","./base"]});
