/*
Copyright 2011, KISSY UI Library v1.1.8dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("switchable",function(b){function g(d,a){a=a||{};if(!("markupType"in a))if(a.panelCls)a.markupType=1;else if(a.panels)a.markupType=2;for(var e=this.constructor;e;){a=b.merge(e.Config,a);e=e.superclass?e.superclass.constructor:null}this.container=j.get(d);this.config=a;this.ingIndex=this.activeIndex=a.activeIndex;this._init();this._initPlugins();this.fire(v);this.activeIndex>-1||typeof a.switchTo=="number"&&this.switchTo(a.switchTo)}var j=b.DOM,p=b.Event,o=b.EventTarget,v="init",l={originalEvent:{target:1}};
g.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:0,steps:1,viewSize:[]};g.Plugins=[];b.augment(g,o,{_initPlugins:function(){for(var d=this,a=d.constructor;a;){b.each(a.Plugins,function(e){e.init&&e.init(d)});a=a.superclass?a.superclass.constructor:null}},_init:function(){var d=
this.config;this._parseMarkup();d.hasTriggers&&this._bindTriggers()},_parseMarkup:function(){var d=this.container,a=this.config,e,k,i=[],r=[];switch(a.markupType){case 0:if(e=j.get("."+a.navCls,d))i=j.children(e);k=j.get("."+a.contentCls,d);r=j.children(k);break;case 1:i=j.query("."+a.triggerCls,d);r=j.query("."+a.panelCls,d);break;case 2:i=a.triggers;r=a.panels}d=r.length;this.length=d/a.steps;if(a.hasTriggers&&d>0&&i.length===0)i=this._generateTriggersMarkup(this.length);this.triggers=b.makeArray(i);
this.panels=b.makeArray(r);this.content=k||r[0].parentNode;this.nav=e||a.hasTriggers&&i[0].parentNode},_generateTriggersMarkup:function(d){var a=this.config,e=j.create("<ul>"),k,i;e.className=a.navCls;for(i=0;i<d;i++){k=j.create("<li>");if(i===this.activeIndex)k.className=a.activeTriggerCls;k.innerHTML=i+1;e.appendChild(k)}this.container.appendChild(e);return j.children(e)},_bindTriggers:function(){var d=this,a=d.config,e=d.triggers,k,i,r=e.length;for(i=0;i<r;i++)(function(t){k=e[t];p.on(k,"click",
function(){d._onFocusTrigger(t)});if(a.triggerType==="mouse"){p.on(k,"mouseenter",function(){d._onMouseEnterTrigger(t)});p.on(k,"mouseleave",function(){d._onMouseLeaveTrigger(t)})}})(i)},_onFocusTrigger:function(d){if(this._triggerIsValid(d)){this._cancelSwitchTimer();this.switchTo(d,undefined,l)}},_onMouseEnterTrigger:function(d){var a=this;if(a._triggerIsValid(d))a.switchTimer=b.later(function(){a.switchTo(d,undefined,l)},a.config.delay*1E3)},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},
_triggerIsValid:function(d){return this.ingIndex!==d},_cancelSwitchTimer:function(){if(this.switchTimer){this.switchTimer.cancel();this.switchTimer=undefined}},switchTo:function(d,a,e,k){var i=this,r=i.config,t=i.triggers,y=i.panels,s=i.ingIndex,n=r.steps,q=s*n,z=d*n;if(!i._triggerIsValid(d))return i;if(i.fire("beforeSwitch",{toIndex:d})===false)return i;if(r.hasTriggers)i._switchTrigger(s>-1?t[s]:null,t[d]);if(a===undefined)a=d>s?"forward":"backward";i.ingIndex=d;i._switchView(s>-1?y.slice(q,q+n):
null,y.slice(z,z+n),d,a,e,function(){k&&k.call(i,d);i.activeIndex=d});return i},_switchTrigger:function(d,a){var e=this.config.activeTriggerCls;d&&j.removeClass(d,e);j.addClass(a,e)},_switchView:function(d,a,e,k,i,r){d&&j.css(d,"display","none");j.css(a,"display","block");this._fireOnSwitch(e,i);r&&r.call(this)},_fireOnSwitch:function(d,a){this.fire("switch",b.mix(a||{},{currentIndex:d}))},prev:function(d){var a=this.activeIndex;this.switchTo(a>0?a-1:this.length-1,"backward",d)},next:function(d){var a=
this.activeIndex;this.switchTo(a<this.length-1?a+1:0,"forward",d)}});return b.Switchable=g});
KISSY.add("switchable/aria",function(b,g,j,p){function o(){this.stop&&this.stop()}function v(){this.start&&this.start()}g=b.DOM;j=b.Event;p=b.Switchable;var l=!document.documentElement.hasAttribute?function(a,e){e=e.toLowerCase();var k=g.get(a).getAttributeNode(e);return!!(k&&k.specified)}:function(a,e){e=e.toLowerCase();return g.get(a).hasAttribute(e)};p.Plugins.push({name:"aria",init:function(a){if(a.config.aria){var e=a.container;j.on(e,"focusin",o,a);j.on(e,"focusout",v,a)}}});var d=["a","input",
"button","object"];p.Aria={setTabIndex:function(a,e){a.tabIndex=e;g.query("*",a).each(function(k){var i=k.nodeName.toLowerCase();if(b.inArray(i,d)){l(k,"oriTabIndex")||g.attr(k,"oriTabIndex",k.tabIndex);k.tabIndex=e!=-1?g.attr(k,"oriTabIndex"):e}})}}});
KISSY.add("switchable/accordion/base",function(b,g,j){function p(o,v){if(!(this instanceof p))return new p(o,v);p.superclass.constructor.apply(this,arguments);return 0}j=b.Switchable;g=b.DOM;b.extend(p,j,{_switchTrigger:function(o,v){var l=this.config;l.multiple?g.toggleClass(v,l.activeTriggerCls):p.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(o){return p.superclass._triggerIsValid.call(this,o)||this.config.multiple},_switchView:function(o,v,l,d,a,e){var k=v[0];if(this.config.multiple){g.toggle(k);
this._fireOnSwitch(l,a);e.call(this)}else p.superclass._switchView.apply(this,arguments)}});p.Plugins=[];p.Config={markupType:1,triggerType:"click",multiple:false};return b.Accordion=p});
KISSY.add("switchable/accordion/aria",function(b,g,j){function p(h){var w;b.each(this.triggers,function(B){if(B==h||r.contains(B,h))w=B});return w}function o(h){switch(h.keyCode){case t:case y:h.ctrlKey&&!h.altKey&&!h.shiftKey&&h.halt();break;case f:h.ctrlKey&&!h.altKey&&h.halt()}}function v(h){var w=h.target,B=this.triggers,C=!h.ctrlKey&&!h.shiftKey&&!h.altKey,E=h.ctrlKey&&!h.shiftKey&&!h.altKey;switch(h.keyCode){case A:case u:if(p.call(this,w)&&C){this.switchTo(this.focusIndex);h.halt()}break;case q:case z:if(p.call(this,
w)){d.call(this);h.halt()}break;case m:case c:if(p.call(this,w)){a.call(this);h.halt()}break;case y:if(E){h.halt();a.call(this)}break;case t:if(E){h.halt();d.call(this)}break;case n:if(C){w=this.focusIndex;this.focusIndex=0;l.call(this,w,0,true);h.halt()}break;case s:if(C){w=B.length-1;B=this.focusIndex;this.focusIndex=w;l.call(this,B,w,true);h.halt()}break;case f:if(h.ctrlKey&&!h.altKey){h.halt();h.shiftKey?d.call(this):a.call(this)}}}function l(h,w,B){var C=this.triggers;if(typeof h=="number")var E=
C[h];h=C[w];if(E){x(E,"-1");r.removeClass(E,k);E.setAttribute("aria-selected","false")}B&&h.focus();x(h,"0");r.addClass(h,k);h.setAttribute("aria-selected","true")}function d(){var h=this.triggers,w=this.focusIndex;h=this.focusIndex=w==0?h.length-1:w-1;l.call(this,w,h,true)}function a(){var h=this.focusIndex,w=this.focusIndex=h==this.triggers.length-1?0:h+1;l.call(this,h,w,true)}function e(h){var w=!!h.originalEvent.target,B=this.config.multiple,C=this.activeIndex;h=h.currentIndex;var E=this.triggers[h],
F=this.panels[h];if(C>-1){var D=this.triggers[C];C=this.panels[C];x(D,"-1");w&&E.focus();if(!B){C.setAttribute("aria-hidden","true");D.setAttribute("aria-expanded","false")}}x(E,"0");w=F.getAttribute("aria-hidden");F.setAttribute("aria-hidden",w=="false"?"true":"false");E.setAttribute("aria-expanded",w=="false"?"false":"true");l.call(this,this.focusIndex,h);this.focusIndex=h}g=b.Switchable.Aria;j=b.Accordion;var k="ks-switchable-select",i=b.Event,r=b.DOM,t=33,y=34,s=35,n=36,q=37,z=38,m=39,c=40,f=
9,u=32,A=13;b.mix(j.Config,{aria:true});j.Plugins.push({name:"aria",init:function(h){if(h.config.aria){var w=h.container,B=h.activeIndex;r.attr(w,"aria-multiselectable",h.config.multiple?"true":"false");r.attr(w,"role","tablist");var C=h.triggers,E=h.panels,F=0;b.each(E,function(D){if(!D.id)D.id=b.guid("ks-switchable-tab-panel")});b.each(C,function(D){if(!D.id)D.id=b.guid("ks-switchable-tab")});b.each(C,function(D){D.setAttribute("role","tab");D.setAttribute("aria-expanded",B==F?"true":"false");D.setAttribute("aria-selected",
B==F?"true":"false");D.setAttribute("aria-controls",E[F].id);x(D,B==F?"0":"-1");F++});F=0;b.each(E,function(D){var G=C[F];D.setAttribute("role","tabpanel");D.setAttribute("aria-hidden",B==F?"false":"true");D.setAttribute("aria-labelledby",G.id);F++});h.on("switch",e,h);if(B>-1)h.focusIndex=B;i.on(w,"keydown",v,h);i.on(w,"keypress",o,h)}}});var x=g.setTabIndex});
KISSY.add("switchable/autoplay",function(b,g,j,p){g=b.Event;j=b.Switchable;b.mix(j.Config,{autoplay:false,interval:5,pauseOnHover:true});j.Plugins.push({name:"autoplay",init:function(o){function v(){a=b.later(function(){o.paused||o.switchTo(o.activeIndex<o.length-1?o.activeIndex+1:0,"forward")},d,true)}var l=o.config,d=l.interval*1E3,a;if(l.autoplay){if(l.pauseOnHover){g.on(o.container,"mouseenter",function(){o.stop()});g.on(o.container,"mouseleave",function(){o.start()})}v();o.stop=function(){if(a){a.cancel();
a=p}o.paused=true};o.start=function(){if(a){a.cancel();a=p}o.paused=false;v()}}}});return j});KISSY.add("switchable/autorender",function(b,g,j,p){g=b.DOM;j=b.JSON;p=b.Switchable;p.autoRender=function(o,v){o="."+(o||"KS_Widget");g.query(o,v).each(function(l){var d=l.getAttribute("data-widget-type"),a;if(d&&"Switchable Tabs Slide Carousel Accordion".indexOf(d)>-1)try{if(a=l.getAttribute("data-widget-config"))a=a.replace(/'/g,'"');new b[d](l,j.parse(a))}catch(e){}})}});
KISSY.add("switchable/carousel/base",function(b,g,j,p,o){function v(l,d){if(!(this instanceof v))return new v(l,d);v.superclass.constructor.apply(this,arguments);return 0}p=b.Switchable;g=b.DOM;j=b.Event;v.Config={circular:true,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};v.Plugins=[];b.extend(v,p,{_init:function(){var l=this;v.superclass._init.call(l);var d=l.config,a=d.disableBtnCls,e=false;b.each(["prev","next"],function(k){var i=
l[k+"Btn"]=g.get("."+d[k+"BtnCls"],l.container);i&&j.on(i,"click",function(r){r.preventDefault();e||g.hasClass(i,a)||l[k]()})});if(!d.circular){l.on("beforeSwitch",function(){e=true});l.on("switch",function(k){k=k.currentIndex;k=k===0?l.prevBtn:k===l.length-1?l.nextBtn:o;g.removeClass([l.prevBtn,l.nextBtn],a);k&&g.addClass(k,a);e=false})}j.on(l.panels,"click",function(){l.fire("itemSelected",{item:this})})}});return b.Carousel=v});
KISSY.add("switchable/carousel/aria",function(b,g,j,p,o){function v(m){var c=m.currentIndex,f=this.activeIndex,u=this.panels,A=u[c*this.config.steps],x=this.triggers;c=x[c];if((m=!!m.originalEvent.target)||f==-1){b.each(x,function(h){q(h,-1)});b.each(u,function(h){q(h,-1)});c&&q(c,0);q(A,0);m&&A.focus()}}function l(m){var c;b.each(this.triggers,function(f){if(f==m||g.contains(f,m)){c=f;return false}});return c}function d(m){var c=m.target;switch(m.keyCode){case y:case t:if(c=l.call(this,c)){c=c;var f=
g.next(c),u=this.triggers;f||(f=u[0]);q(c,-1);if(f){q(f,0);f.focus()}m.halt()}break;case r:case i:if(c=l.call(this,c)){c=c;f=g.prev(c);u=this.triggers;f||(f=u[u.length-1]);q(c,-1);if(f){q(f,0);f.focus()}m.halt()}break;case n:case s:if(c=l.call(this,c)){this.switchTo(b.indexOf(c,this.triggers),undefined,z);m.halt()}}}function a(m){var c;b.each(this.panels,function(f){if(f==m||g.contains(f,m)){c=f;return false}});return c}function e(m){var c=b.indexOf(m,this.panels),f=this.config.steps,u=Math.floor(c/
f);if(u==this.activeIndex)return 1;if(c%f==0||c%f==f-1){this.switchTo(u,undefined,undefined,function(){m.focus()});return 0}return 1}function k(m){var c=m.target;switch(m.keyCode){case y:case t:if(c=a.call(this,c)){c=c;var f=g.next(c),u=this.panels;f||(f=u[0]);q(c,-1);q(f,0);e.call(this,f)&&f.focus();m.halt()}break;case r:case i:if(c=a.call(this,c)){c=c;f=g.prev(c);u=this.panels;f||(f=u[u.length-1]);q(c,-1);q(f,0);e.call(this,f)&&f.focus();m.halt()}break;case n:case s:if(c=a.call(this,c)){this.fire("itemSelected",
{item:c});m.halt()}}}g=b.DOM;j=b.Event;p=b.Switchable.Aria;o=b.Carousel;var i=37,r=38,t=39,y=40,s=32,n=13,q=p.setTabIndex,z={originalEvent:{target:1}};b.mix(o.Config,{aria:true});o.Plugins.push({name:"aria",init:function(m){if(m.config.aria){var c=m.triggers,f=m.panels,u=m.content,A=m.activeIndex;if(!u.id)u.id=b.guid("ks-switchbale-content");u.setAttribute("role","listbox");b.each(c,function(x){q(x,A==0?"0":"-1");x.setAttribute("role","button");x.setAttribute("aria-controls",u.id)});b.each(f,function(x){q(x,
-1);x.setAttribute("role","option")});m.on("switch",v,m);(c=m.nav)&&j.on(c,"keydown",d,m);j.on(u,"keydown",k,m);c=m.prevBtn;f=m.nextBtn;if(c){q(c,0);c.setAttribute("role","button");j.on(c,"keydown",function(x){if(x.keyCode==n||x.keyCode==s){m.prev(z);x.preventDefault()}})}if(f){q(f,0);f.setAttribute("role","button");j.on(f,"keydown",function(x){if(x.keyCode==n||x.keyCode==s){m.next(z);x.preventDefault()}})}}}})});
KISSY.add("switchable/effect",function(b,g,j,p,o,v){g=b.DOM;p=b.Anim;o=b.Switchable;var l;b.mix(o.Config,{effect:"none",duration:0.5,easing:"easeNone",nativeAnim:true});o.Effects={none:function(d,a,e){d&&g.css(d,"display","none");g.css(a,"display","block");e()},fade:function(d,a,e){d&&d.length!==1&&b.error("fade effect only supports steps == 1.");var k=this,i=k.config,r=d?d[0]:null,t=a[0];k.anim&&k.anim.stop();g.css(t,"opacity",1);if(r)k.anim=(new p(r,{opacity:0},i.duration,i.easing,function(){k.anim=
v;g.css(t,"z-index",9);g.css(r,"z-index",1);e&&e()},i.nativeAnim)).run();else{g.css(t,"z-index",9);e&&e()}},scroll:function(d,a,e,k){var i=this;d=i.config;a=d.effect==="scrollx";var r={};r[a?"left":"top"]=-(i.viewSize[a?0:1]*k)+"px";i.anim&&i.anim.stop();i.anim=(new p(i.content,r,d.duration,d.easing,function(){i.anim=v;e()},d.nativeAnim)).run()}};l=o.Effects;l.scrollx=l.scrolly=l.scroll;o.Plugins.push({name:"effect",init:function(d){var a=d.config,e=a.effect,k=d.panels,i=d.content,r=a.steps,t=d.activeIndex,
y=k.length;d.viewSize=[a.viewSize[0]||k[0].offsetWidth*r,a.viewSize[1]||k[0].offsetHeight*r];if(e!=="none"){b.each(k,function(z){g.css(z,"display","block")});switch(e){case "scrollx":case "scrolly":g.css(i,"position","absolute");g.css(i.parentNode,"position","relative");if(e==="scrollx"){g.css(k,"float","left");g.width(i,d.viewSize[0]*(y/r))}break;case "fade":var s=t*r,n=s+r-1,q;b.each(k,function(z,m){q=m>=s&&m<=n;g.css(z,{opacity:q?1:0,position:"absolute",zIndex:q?9:1})})}}}});b.augment(o,{_switchView:function(d,
a,e,k,i,r){var t=this,y=t.config.effect;(b.isFunction(y)?y:l[y]).call(t,d,a,function(){t._fireOnSwitch(e,i);r&&r.call(t)},e,k)}});return o});
KISSY.add("switchable/circular",function(b,g,j,p){function o(n,q,z,m,c){var f=this;n=f.config;q=f.length;var u=f.activeIndex,A=n.scrollType===s,x=A?e:k,h=f.viewSize[A?0:1];A=-h*m;var w={},B,C=c===y;if(B=C&&u===0&&m===q-1||c===t&&u===q-1&&m===0)A=v.call(f,f.panels,m,C,x,h);w[x]=A+r;f.anim&&f.anim.stop();f.anim=(new j(f.content,w,n.duration,n.easing,function(){B&&l.call(f,f.panels,m,C,x,h);f.anim=undefined;z()},n.nativeAnim)).run()}function v(n,q,z,m,c){var f=this.config.steps;q=this.length;var u=z?
q-1:0,A=(u+1)*f;for(f=u*f;f<A;f++){g.css(n[f],d,a);g.css(n[f],m,(z?-1:1)*c*q)}return z?c:-c*q}function l(n,q,z,m,c){var f=this.config.steps;q=this.length;var u=z?q-1:0,A=(u+1)*f;for(f=u*f;f<A;f++){g.css(n[f],d,i);g.css(n[f],m,i)}g.css(this.content,m,z?-c*(q-1):i)}g=b.DOM;j=b.Anim;p=b.Switchable;var d="position",a="relative",e="left",k="top",i="",r="px",t="forward",y="backward",s="scrollx";b.mix(p.Config,{circular:false});p.Plugins.push({name:"circular",init:function(n){n=n.config;if(n.circular&&(n.effect===
s||n.effect==="scrolly")){n.scrollType=n.effect;n.effect=o}}})});
KISSY.add("switchable/countdown",function(b,g,j,p,o,v){g=b.DOM;j=b.Event;p=b.Anim;o=b.Switchable;b.mix(o.Config,{countdown:false,countdownFromStyle:"",countdownToStyle:"width: 0"});o.Plugins.push({name:"countdown",init:function(l){function d(n){a();s=(new p(r[n],y,i-1)).run()}function a(){if(k){clearTimeout(k);k=null}if(s){s.stop();s=v}}var e=l.config,k,i=e.interval,r=[],t=e.countdownFromStyle,y=e.countdownToStyle,s;if(!(!e.autoplay||!e.hasTriggers||!e.countdown)){b.each(l.triggers,function(n,q){n.innerHTML=
'<div class="ks-switchable-trigger-mask"></div><div class="ks-switchable-trigger-content">'+n.innerHTML+"</div>";r[q]=n.firstChild});if(e.pauseOnHover){j.on(l.container,"mouseenter",function(){a();var n=r[l.ingIndex];if(t)s=(new p(n,t,0.2,"easeOut")).run();else g.removeAttr(n,"style")});j.on(l.container,"mouseleave",function(){a();var n=l.ingIndex;g.removeAttr(r[n],"style");k=setTimeout(function(){d(n)},200)})}l.on("beforeSwitch",function(){a();g.attr(r[l.activeIndex],"style",t||"")});l.on("switch",
function(n){l.paused||d(n.currentIndex)})}}});return o});
KISSY.add("switchable/lazyload",function(b,g,j){g=b.DOM;j=b.Switchable;var p="beforeSwitch",o="img-src",v="area-data",l={};l[o]="data-ks-lazyload-custom";l[v]="ks-datalazyload-custom";b.mix(j.Config,{lazyDataType:v});j.Plugins.push({name:"lazyload",init:function(d){function a(t){var y=k.steps;t=t.toIndex*y;e.loadCustomLazyData(d.panels.slice(t,t+y),i);a:{var s,n;if(t=(y=i===o)?"img":i===v?"textarea":""){t=g.query(t,d.container);s=0;for(n=t.length;s<n;s++)if(y?g.attr(t[s],r):g.hasClass(t[s],r)){y=
false;break a}}y=true}y&&d.detach(p,a)}var e=b.DataLazyload,k=d.config,i=k.lazyDataType,r=l[i];!e||!i||!r||d.on(p,a)}});return j});KISSY.add("switchable/slide/base",function(b,g){function j(p,o){if(!(this instanceof j))return new j(p,o);j.superclass.constructor.apply(this,arguments);return 0}g=b.Switchable;j.Config={autoplay:true,circular:true};j.Plugins=[];b.extend(j,g);return b.Slide=j});
KISSY.add("switchable/slide/aria",function(b,g,j,p,o){function v(s){var n=this.panels,q=this.__slideIndex;switch(s.keyCode){case k:case e:q++;if(q==n.length)q=0;this.__slideIndex=q;this.switchTo(q,i,undefined,function(){n[q].focus()});s.halt();break;case a:case d:q--;if(q==-1)q=n.length-1;this.__slideIndex=q;this.switchTo(q,r,undefined,function(){n[q].focus()});s.halt()}}function l(s){var n=this;if(b.inArray(s.target,n.panels)){if(y){clearTimeout(y);y=undefined}switch(s.keyCode){case k:case a:case d:case e:s.halt()}y=
setTimeout(function(){v.call(n,s);y=undefined},200)}}p=b.Switchable;g=b.DOM;j=b.Event;p=p.Aria;o=b.Slide;var d=37,a=38,e=39,k=40,i="forward",r="backward";b.mix(o.Config,{aria:true});var t=p.setTabIndex;o.Plugins.push({name:"aria",init:function(s){if(s.config.aria){var n=s.panels,q=s.activeIndex;b.each(s.triggers,function(m){t(m,-1)});b.each(n,function(m){t(m,q==0?"0":"-1");g.attr(m,"role","option")});var z=s.content;g.attr(z,"role","listbox");j.on(z,"keydown",l,s);t(n[0],0);if(q>-1)s.__slideIndex=
q;s.on("switch",function(m){m=m.currentIndex;var c=s.activeIndex;s.__slideIndex=m;c!=-1&&t(n[c],-1);t(n[m],0)})}}});var y});KISSY.add("switchable/tabs/base",function(b,g){function j(p,o){if(!(this instanceof j))return new j(p,o);j.superclass.constructor.call(this,p,o);return 0}g=b.Switchable;b.extend(j,g);j.Config={};j.Plugins=[];return b.Tabs=j});
KISSY.add("switchable/tabs/aria",function(b,g,j){function p(c){var f;b.each(this.triggers,function(u){if(u==c||a.contains(u,c))f=u});return f}function o(c){switch(c.keyCode){case e:case k:c.ctrlKey&&!c.altKey&&!c.shiftKey&&c.halt();break;case q:c.ctrlKey&&!c.altKey&&c.halt()}}function v(c){var f=c.target,u=this.triggers,A=!c.ctrlKey&&!c.shiftKey&&!c.altKey,x=c.ctrlKey&&!c.shiftKey&&!c.altKey;switch(c.keyCode){case t:case y:if(p.call(this,f)){this.prev(z);c.halt()}break;case s:case n:if(p.call(this,
f)){this.next(c);c.halt()}break;case k:if(x){c.halt();this.next(z)}break;case e:if(x){c.halt();this.prev(z)}break;case r:if(A){this.switchTo(0,undefined,z);c.halt()}break;case i:if(A){this.switchTo(u.length-1,undefined,z);c.halt()}break;case q:if(c.ctrlKey&&!c.altKey){c.halt();c.shiftKey?this.prev(z):this.next(z)}}}function l(c){var f=!!c.originalEvent.target,u=this.activeIndex,A=c.currentIndex;if(u!=A){c=this.triggers[u];var x=this.triggers[A];u=this.panels[u];A=this.panels[A];c&&m(c,"-1");m(x,"0");
f&&x.focus();u&&u.setAttribute("aria-hidden","true");A.setAttribute("aria-hidden","false")}}g=b.Switchable.Aria;j=b.Tabs;var d=b.Event,a=b.DOM,e=33,k=34,i=35,r=36,t=37,y=38,s=39,n=40,q=9,z={originalEvent:{target:1}};b.mix(j.Config,{aria:true});j.Plugins.push({name:"aria",init:function(c){if(c.config.aria){var f=c.triggers,u=c.activeIndex,A=c.panels,x=c.container;a.attr(x,"role","tablist");var h=0;b.each(f,function(w){w.setAttribute("role","tab");m(w,u==h?"0":"-1");if(!w.id)w.id=b.guid("ks-switchable");
h++});h=0;b.each(A,function(w){var B=f[h];w.setAttribute("role","tabpanel");w.setAttribute("aria-hidden",u==h?"false":"true");w.setAttribute("aria-labelledby",B.id);h++});c.on("switch",l,c);d.on(x,"keydown",v,c);d.on(x,"keypress",o,c)}}});var m=g.setTabIndex});
