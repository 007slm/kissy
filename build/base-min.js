/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Mar 1 15:54
*/
KISSY.add("base/attribute",function(k,o,g){function j(a,b){return"string"==typeof b?a[b]:b}function l(a,b,c,d,e,f,g){g=g||c;return a.fire(b+k.ucfirst(c)+"Change",{attrName:g,subAttrName:f,prevVal:d,newVal:e})}function h(a,b,c){var d=a[b]||{};c&&(a[b]=d);return d}function i(a){return h(a,"__attrs",!0)}function n(a){return h(a,"__attrVals",!0)}function r(a,b){for(var c=0,d=b.length;a!=g&&c<d;c++)a=a[b[c]];return a}function s(a){var b;-1!==a.indexOf(".")&&(b=a.split("."),a=b.shift());return{path:b,name:a}}
function t(a,b,c){var d=c;if(b){var a=d=a===g?{}:k.clone(a),e=b.length-1;if(0<=e){for(var f=0;f<e;f++)a=a[b[f]];a!=g&&(a[b[f]]=c)}}return d}function u(a,b,c,d,e){var f,i,h;f=s(b);var j=b,b=f.name;f=f.path;h=a.get(b);var l="before"+k.ucfirst(b)+"Change",l=o.getCustomEvent(a,l,1);l.defaultFn||(l.defaultFn=v);f&&(i=r(h,f));if(!f&&h===c||f&&i===c)return g;c=t(h,f,c);c={attrName:b,subAttrName:j,prevVal:h,newVal:c,_opts:d,_attrs:e};if(d.silent){if(m===v.call(a,c))return m}else if(m===a.fire("before"+k.ucfirst(b)+
"Change",c))return m;return a}function v(a){var b=a.newVal,c=a.prevVal,d=a.attrName,e=a.subAttrName,f=a._attrs,a=a._opts,b=this.setInternal(d,b);if(b===m)return b;a.silent||(b=n(this)[d],l(this,"after",d,c,b,e),f?f.push({prevVal:c,newVal:b,attrName:d,subAttrName:e}):l(this,"","*",[c],[b],[e],[d]));return g}function p(){}function q(a,b){var c=i(a),d=h(c,b),e=d.valueFn;if(e&&(e=j(a,e)))e=e.call(a),e!==g&&(d.value=e),delete d.valueFn,c[b]=d;return d.value}function w(a,b,c,d){var e,f;e=s(b);b=e.name;
if(e=e.path)f=a.get(b),c=t(f,e,c);if((e=h(i(a),b,!0).validator)&&(e=j(a,e)))if(a=e.call(a,c,b,d),a!==g&&!0!==a)return a;return g}p.INVALID={};var x=p.INVALID,m=!1;p.prototype={getAttrs:function(){return i(this)},getAttrVals:function(){var a={},b,c=i(this);for(b in c)a[b]=this.get(b);return a},addAttr:function(a,b,c){var d=i(this),e,b=k.clone(b);(e=d[a])?k.mix(e,b,c):d[a]=b;return this},addAttrs:function(a,b){var c=this;k.each(a,function(a,b){c.addAttr(b,a)});b&&c.set(b);return c},hasAttr:function(a){return i(this).hasOwnProperty(a)},
removeAttr:function(a){this.hasAttr(a)&&(delete i(this)[a],delete n(this)[a]);return this},set:function(a,b,c){if(k.isPlainObject(a)){var c=b||{},b=Object(a),d=[],e,f=[];for(a in b)(e=w(this,a,b[a],b))!==g&&f.push(e);if(f.length)return c.error&&c.error(f),m;for(a in b)u(this,a,b[a],c,d);var h=[],i=[],j=[],n=[];k.each(d,function(a){i.push(a.prevVal);j.push(a.newVal);h.push(a.attrName);n.push(a.subAttrName)});h.length&&l(this,"","*",i,j,n,h);return this}c=c||{};e=w(this,a,b);return e!==g?(c.error&&
c.error(e),m):u(this,a,b,c)},setInternal:function(a,b){var c=g,d=h(i(this),a,!0).setter;if(d&&(d=j(this,d)))c=d.call(this,b,a);if(c===x)return m;c!==g&&(b=c);n(this)[a]=b;return g},get:function(a){var b,c=n(this),d,e;-1!==a.indexOf(".")&&(b=a.split("."),a=b.shift());d=h(i(this),a).getter;e=a in c?c[a]:q(this,a);if(d&&(d=j(this,d)))e=d.call(this,e,a);!(a in c)&&e!==g&&(c[a]=e);b&&(e=r(e,b));return e},reset:function(a,b){if("string"==typeof a)return this.hasAttr(a)?this.set(a,q(this,a),b):this;var b=
a,c=i(this),d={};for(a in c)d[a]=q(this,a);this.set(d,b);return this}};return p},{requires:["event/custom"]});KISSY.add("base",function(k,o,g){function j(g){var h=this.constructor;for(this.userConfig=g;h;){var i=h.ATTRS;if(i){var j=void 0;for(j in i)this.addAttr(j,i[j],!1)}h=h.superclass?h.superclass.constructor:null}if(g)for(var k in g)this.setInternal(k,g[k])}k.augment(j,g.Target,o);j.Attribute=o;return k.Base=j},{requires:["base/attribute","event/custom"]});
