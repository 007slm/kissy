/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Aug 8 16:01
*/
KISSY.add("overlay/overlayrender",function(f,e,g,c){function a(b){return f.require("uibase/"+b)}return g.create(c.Render,[a("contentboxrender"),a("positionrender"),a("loadingrender"),e.ie==6?a("shimrender"):null,a("maskrender")],{renderUI:function(){this.get("el").addClass(this.get("prefixCls")+"overlay")}},{ATTRS:{elBefore:{valueFn:function(){return f.one(this.get("render")[0].firstChild)}},focusable:{value:false},visibleMode:{value:"visibility"}}})},{requires:["ua","uibase","component"]});
KISSY.add("overlay/ariarender",function(f,e){function g(){}function c(d){var h=d.keyCode,i=this.get("el");if(h==b){h=a(d.target);var j=this.__ariaArchor;if(h.equals(i)&&d.shiftKey){j[0].focus();d.halt()}else if(h.equals(j)&&!d.shiftKey){i[0].focus();d.halt()}else if(h.equals(i)||i.contains(h))return;d.halt()}}var a=e.all,b=e.KeyCodes.TAB;g.prototype={__renderUI:function(){var d=this.get("el"),h=this.get("header");if(this.get("aria")){d.attr("role","dialog");d.attr("tabindex",0);h.attr("id")||h.attr("id",
f.guid("ks-dialog-header"));d.attr("aria-labelledby",h.attr("id"));this.__ariaArchor=a("<div tabindex='0'></div>").appendTo(d)}},__bindUI:function(){var d=this;if(d.get("aria")){var h=d.get("el"),i;d.on("afterVisibleChange",function(j){if(j.newVal){i=document.activeElement;h[0].focus();h.attr("aria-hidden","false");h.on("keydown",c,d)}else{h.attr("aria-hidden","true");h.detach("keydown",c,d);i&&i.focus()}})}}};return g},{requires:["node"]});
KISSY.add("overlay/aria",function(f,e){function g(){}g.ATTRS={aria:{view:true}};g.prototype={__bindUI:function(){var c=this,a=c.get("el");c.get("aria")&&a.on("keydown",function(b){if(b.keyCode===e.KeyCodes.ESC){c.hide();b.halt()}})}};return g},{requires:["event"]});
KISSY.add("overlay/effect",function(f){function e(){}var g={fade:["Out","In"],slide:["Up","Down"]};e.ATTRS={effect:{value:{effect:"none",duration:0.5,easing:"easeOut"},setter:function(c){var a=c.effect;if(f.isString(a)&&!g[a])c.effect="none"}}};e.prototype={__bindUI:function(){var c=this;c.on("afterVisibleChange",function(a){var b=c.get("effect").effect;if(b!="none"){var d=a.newVal,h=c.get("el");h.stop(true);h.css("visibility","visible");h[b+g[b][Number(d)]](c.get("effect").duration,function(){h.css("display",
"block");h.css("visibility",d?"visible":"hidden")},c.get("effect").easing,false)}})}};return e},{requires:["anim"]});KISSY.add("overlay/overlay",function(f,e,g,c,a){function b(d){return f.require("uibase/"+d)}e=e.create(g.ModelControl,[b("contentbox"),b("position"),b("loading"),b("align"),b("resize"),b("mask"),a],{},{ATTRS:{handleMouseEvents:{value:false},allowTextSelection_:{value:true}}});e.DefaultRender=c;return e},{requires:["uibase","component","./overlayrender","./effect"]});
KISSY.add("overlay/dialogrender",function(f,e,g,c){return e.create(g,[f.require("uibase/stdmodrender"),f.require("uibase/closerender"),c])},{requires:["uibase","./overlayrender","./ariarender"]});
KISSY.add("overlay/dialog",function(f,e,g,c,a){function b(d){return f.require("uibase/"+d)}e=g.create(e,[b("stdmod"),b("close"),b("drag"),b("constrain"),a],{renderUI:function(){this.get("el").addClass(this.get("prefixCls")+"dialog");this.set("handlers",[this.get("header")])}});e.DefaultRender=c;return e},{requires:["overlay/overlay","uibase","overlay/dialogrender","./aria"]});
KISSY.add("overlay/popup",function(f,e,g){function c(a,b){if(f.isUndefined(b))b=a;else b.srcNode=a;c.superclass.constructor.call(this,b)}c.ATTRS={trigger:{setter:function(a){return f.one(a)}},triggerType:{value:"click"}};f.extend(c,e,{initializer:function(){var a=this;if(a.get("trigger"))if(a.get("triggerType")==="mouse"){a._bindTriggerMouse();a.on("bindUI",function(){a._bindContainerMouse()})}else a._bindTriggerClick()},_bindTriggerMouse:function(){var a=this,b=a.get("trigger"),d;a.__mouseEnterPopup=
function(){a._clearHiddenTimer();d=f.later(function(){a.show();d=g},100)};b.on("mouseenter",a.__mouseEnterPopup);a._mouseLeavePopup=function(){if(d){d.cancel();d=g}a._setHiddenTimer()};b.on("mouseleave",a._mouseLeavePopup)},_bindContainerMouse:function(){this.get("el").on("mouseleave",this._setHiddenTimer,this).on("mouseenter",this._clearHiddenTimer,this)},_setHiddenTimer:function(){var a=this;a._hiddenTimer=f.later(function(){a.hide()},100)},_clearHiddenTimer:function(){if(this._hiddenTimer){this._hiddenTimer.cancel();
this._hiddenTimer=g}},_bindTriggerClick:function(){var a=this;a.__clickPopup=function(b){b.halt();a.show()};a.get("trigger").on("click",a.__clickPopup)},destructor:function(){var a=this.get("trigger");if(a){this.__clickPopup&&a.detach("click",this.__clickPopup);this.__mouseEnterPopup&&a.detach("mouseenter",this.__mouseEnterPopup);this._mouseLeavePopup&&a.detach("mouseleave",this._mouseLeavePopup)}this.get("el")&&this.get("el").detach("mouseleave",this._setHiddenTimer,this).detach("mouseenter",this._clearHiddenTimer,
this)}});return c},{requires:["./overlay"]});KISSY.add("overlay",function(f,e,g,c,a,b){e.Render=g;c.Render=a;e.Dialog=c;f.Overlay=e;f.Dialog=c;e.Popup=f.Popup=b;return e},{requires:["overlay/overlay","overlay/overlayrender","overlay/dialog","overlay/dialogrender","overlay/popup"]});
