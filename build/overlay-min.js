/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Aug 8 17:09
*/
KISSY.add("overlay/overlayrender",function(f,e,g,d){function a(c){return f.require("uibase/"+c)}var b=f.all;return g.create(d.Render,[a("contentboxrender"),a("positionrender"),a("loadingrender"),e.ie==6?a("shimrender"):null,a("maskrender")],{renderUI:function(){this.get("el").addClass(this.get("prefixCls")+"overlay")}},{ATTRS:{elBefore:{valueFn:function(){return b("body").first()}},focusable:{value:false},visibleMode:{value:"visibility"}}})},{requires:["ua","uibase","component"]});
KISSY.add("overlay/ariarender",function(f,e){function g(){}function d(c){var h=c.keyCode,i=this.get("el");if(h==b){h=a(c.target);var j=this.__ariaArchor;if(h.equals(i)&&c.shiftKey){j[0].focus();c.halt()}else if(h.equals(j)&&!c.shiftKey){i[0].focus();c.halt()}else if(h.equals(i)||i.contains(h))return;c.halt()}}var a=e.all,b=e.KeyCodes.TAB;g.prototype={__renderUI:function(){var c=this.get("el"),h=this.get("header");if(this.get("aria")){c.attr("role","dialog");c.attr("tabindex",0);h.attr("id")||h.attr("id",
f.guid("ks-dialog-header"));c.attr("aria-labelledby",h.attr("id"));this.__ariaArchor=a("<div tabindex='0'></div>").appendTo(c)}},__bindUI:function(){var c=this;if(c.get("aria")){var h=c.get("el"),i;c.on("afterVisibleChange",function(j){if(j.newVal){i=document.activeElement;h[0].focus();h.attr("aria-hidden","false");h.on("keydown",d,c)}else{h.attr("aria-hidden","true");h.detach("keydown",d,c);i&&i.focus()}})}}};return g},{requires:["node"]});
KISSY.add("overlay/aria",function(f,e){function g(){}g.ATTRS={aria:{view:true}};g.prototype={__bindUI:function(){var d=this,a=d.get("el");d.get("aria")&&a.on("keydown",function(b){if(b.keyCode===e.KeyCodes.ESC){d.hide();b.halt()}})}};return g},{requires:["event"]});
KISSY.add("overlay/effect",function(f){function e(){}var g={fade:["Out","In"],slide:["Up","Down"]};e.ATTRS={effect:{value:{effect:"none",duration:0.5,easing:"easeOut"},setter:function(d){var a=d.effect;if(f.isString(a)&&!g[a])d.effect="none"}}};e.prototype={__bindUI:function(){var d=this;d.on("afterVisibleChange",function(a){var b=d.get("effect").effect;if(b!="none"){var c=a.newVal,h=d.get("el");h.stop(true);h.css("visibility","visible");h[b+g[b][Number(c)]](d.get("effect").duration,function(){h.css("display",
"block");h.css("visibility",c?"visible":"hidden")},d.get("effect").easing,false)}})}};return e},{requires:["anim"]});KISSY.add("overlay/overlay",function(f,e,g,d,a){function b(c){return f.require("uibase/"+c)}e=e.create(g.ModelControl,[b("contentbox"),b("position"),b("loading"),b("align"),b("resize"),b("mask"),a],{},{ATTRS:{handleMouseEvents:{value:false},allowTextSelection_:{value:true}}});e.DefaultRender=d;return e},{requires:["uibase","component","./overlayrender","./effect"]});
KISSY.add("overlay/dialogrender",function(f,e,g,d){return e.create(g,[f.require("uibase/stdmodrender"),f.require("uibase/closerender"),d])},{requires:["uibase","./overlayrender","./ariarender"]});
KISSY.add("overlay/dialog",function(f,e,g,d,a){function b(c){return f.require("uibase/"+c)}e=g.create(e,[b("stdmod"),b("close"),b("drag"),b("constrain"),a],{renderUI:function(){this.get("el").addClass(this.get("prefixCls")+"dialog");this.set("handlers",[this.get("header")])}});e.DefaultRender=d;return e},{requires:["overlay/overlay","uibase","overlay/dialogrender","./aria"]});
KISSY.add("overlay/popup",function(f,e,g){function d(a,b){if(f.isUndefined(b))b=a;else b.srcNode=a;d.superclass.constructor.call(this,b)}d.ATTRS={trigger:{setter:function(a){return f.one(a)}},triggerType:{value:"click"}};f.extend(d,e,{initializer:function(){var a=this;if(a.get("trigger"))if(a.get("triggerType")==="mouse"){a._bindTriggerMouse();a.on("bindUI",function(){a._bindContainerMouse()})}else a._bindTriggerClick()},_bindTriggerMouse:function(){var a=this,b=a.get("trigger"),c;a.__mouseEnterPopup=
function(){a._clearHiddenTimer();c=f.later(function(){a.show();c=g},100)};b.on("mouseenter",a.__mouseEnterPopup);a._mouseLeavePopup=function(){if(c){c.cancel();c=g}a._setHiddenTimer()};b.on("mouseleave",a._mouseLeavePopup)},_bindContainerMouse:function(){this.get("el").on("mouseleave",this._setHiddenTimer,this).on("mouseenter",this._clearHiddenTimer,this)},_setHiddenTimer:function(){var a=this;a._hiddenTimer=f.later(function(){a.hide()},100)},_clearHiddenTimer:function(){if(this._hiddenTimer){this._hiddenTimer.cancel();
this._hiddenTimer=g}},_bindTriggerClick:function(){var a=this;a.__clickPopup=function(b){b.halt();a.show()};a.get("trigger").on("click",a.__clickPopup)},destructor:function(){var a=this.get("trigger");if(a){this.__clickPopup&&a.detach("click",this.__clickPopup);this.__mouseEnterPopup&&a.detach("mouseenter",this.__mouseEnterPopup);this._mouseLeavePopup&&a.detach("mouseleave",this._mouseLeavePopup)}this.get("el")&&this.get("el").detach("mouseleave",this._setHiddenTimer,this).detach("mouseenter",this._clearHiddenTimer,
this)}});return d},{requires:["./overlay"]});KISSY.add("overlay",function(f,e,g,d,a,b){e.Render=g;d.Render=a;e.Dialog=d;f.Overlay=e;f.Dialog=d;e.Popup=f.Popup=b;return e},{requires:["overlay/overlay","overlay/overlayrender","overlay/dialog","overlay/dialogrender","overlay/popup"]});
