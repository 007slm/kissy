/*
Copyright 2010, KISSY UI Library v1.1.5
MIT Licensed
build time: Nov 2 13:10
*/
KISSY.add("dd",function(d){function g(){g.superclass.constructor.apply(this,arguments);this._init()}function i(a,c,e){e=e||150;if(e===-1)return function(){a.apply(c,arguments)};var h=d.now();return function(){var k=d.now();if(k-h>e){h=k;a.apply(c,arguments)}}}var f=d.Event,j=d.DOM,b=d.Node;d.DD={};g.ATTRS={bufferTime:{value:200},activeDrag:{}};d.extend(g,d.Base,{_init:function(){this._showShimMove=i(this._move,this,30)},_move:function(a){var c=this.get("activeDrag");a.preventDefault();c&&c._move(a)},
_start:function(a){var c=this,e=c.get("bufferTime")||0;c._registerEvent();if(e)c._bufferTimer=setTimeout(function(){c._bufferStart(a)},e);else c._bufferStart(a)},_bufferStart:function(a){this.set("activeDrag",a);this._activeShim();a._start()},_end:function(a){var c=this.get("activeDrag");if(this._bufferTimer){clearTimeout(this._bufferTimer);this._bufferTimer=null}this._shim&&this._shim.css({display:"none"});if(c){c._end(a);this.set("activeDrag",null)}},_activeShim:function(){var a=document;this._shim=
(new b("<div style='background-color:red;position:absolute;left:0;width:100%;top:0;z-index:999999;'></div>")).appendTo(a.body);this._shim.css("opacity",0);this._activeShim=this._showShim},_showShim:function(){this._shim.css({display:"",height:j.docHeight()});if(window.getSelection)window.getSelection().removeAllRanges();else document.selection&&document.selection.clear()},_registerEvent:function(){var a=document;f.on(a,"mouseup",this._end,this);f.on(a,"mousemove",this._showShimMove,this)},_unregisterEvent:function(){var a=
document;f.remove(a,"mousemove",this._showShimMove,this);f.remove(a,"mouseup",this._end,this)}});d.DD.DDM=new g});
KISSY.add("dd-draggable",function(d){function g(){g.superclass.constructor.apply(this,arguments);this._init()}function i(b,a){if(!b&&!a)return true;if(!b||!a)return false;return(b[0]||b)===(a[0]||a)}var f=d.UA;g.ATTRS={node:{},handlers:{value:{}}};d.extend(g,d.Base,{_init:function(){var b=this.get("node"),a=this.get("handlers");if(d.isEmptyObject(a))a[b[0].id]=b;for(var c in a)if(a.hasOwnProperty(c)){var e=a[c],h=e.css("cursor");if(!i(e,b)){if(!h||h==="auto")e.css("cursor","move");j(e)}}b.on("mousedown",
this._handleMouseDown,this)},_check:function(b){var a=this.get("handlers"),c;for(c in a)if(a.hasOwnProperty(c))if(a[c].contains(b)||i(a[c],b))return true;return false},_handleMouseDown:function(b){if(this._check(new d.Node(b.target))){f.webkit||b.preventDefault();d.DD.DDM._start(this);var a=this.get("node"),c=b.pageX;b=b.pageY;a=a.offset();this.startMousePos={left:c,top:b};this.startNodePos=a;this._diff={left:c-a.left,top:b-a.top};this.set("diff",this._diff)}},_move:function(b){var a=this.get("diff");
this.fire("drag",{left:b.pageX-a.left,top:b.pageY-a.top})},_end:function(){this.fire("dragend")},_start:function(){this.fire("dragstart")}});d.Draggable=g;var j=f.gecko?function(b){b=b[0]||b;b.style.MozUserSelect="none"}:f.webkit?function(b){b=b[0]||b;b.style.KhtmlUserSelect="none"}:function(b){b=b[0]||b;if(f.ie||f.opera){var a,c=0;for(b.unselectable="on";a=b.all[c++];)switch(a.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:a.unselectable="on"}}}},{host:"dd"});
