/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("anim/base",function(g,e,l,f,m,r,a){function s(b,c,d,i,h,p){if(b=e.get(b)){if(!(this instanceof s))return new s(b,c,d,i,h,p);var q=g.isPlainObject(d);c=c;this.domEl=b;if(g.isPlainObject(c))c=String(g.param(c,";")).replace(/=/g,":").replace(/%23/g,"#").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();var B=c,v=b,w;b={};var D=u.length;v=e.insertAfter(v.cloneNode(true),v);w=v.style;for(j(v,B);D--;){var x=u[D];if(w[x])b[x]=(o[x]||o["*"]).getter(v,x)}B=n(B);for(var C in B)b[C]=(o[C]||o["*"]).getter(v,
C);e.remove(v);this.props=b;this.targetStyle=c;if(q)q=g.merge(E,d);else{q=g.clone(E);if(d)q.duration=parseFloat(d)||1;if(g.isString(i)||g.isFunction(i))q.easing=i;if(g.isFunction(h))q.complete=h;if(p!==a)q.nativeSupport=p}if(!g.isEmptyObject(n(c)))q.nativeSupport=false;this.config=q;if(q.nativeSupport&&y()&&g.isString(i=q.easing))if(/cubic-bezier\([\s\d.,]+\)/.test(i)||(i=f.NativeTimeFunction[i])){q.easing=i;this.transitionName=y()}if(g.isFunction(h))this.callback=h}}function z(b,c){return c}function j(b,
c){if(m.ie&&c.indexOf(A)>-1){var d=c.match(/opacity\s*:\s*([^;]+)(;|$)/);d&&e.css(b,A,parseFloat(d[1]))}b.style.cssText+=";"+c;d=n(c);for(var i in d)b[i]=d[i]}function n(b){for(var c={},d=0;d<t.length;d++){var i=t[d].replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(i=b.match(RegExp(i+"\\s*:([^;]+)(;|$)")))c[t[d]]=g.trim(i[1])}return c}var u,t,A,E,k;l=l.Target;u="borderBottomWidth borderBottomStyle borderLeftWidth borderLeftStyle borderRightWidth borderRightStyle borderSpacing borderTopWidth borderTopStyle bottom fontFamily fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop maxHeight maxWidth minHeight minWidth opacity outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex".split(" ");
t=[];A="opacity";E={duration:1,easing:"easeNone",nativeSupport:true};s.PROPS=u;s.CUSTOM_ATTRS=t;s.PROP_OPS={"*":{getter:function(b,c){var d=e.css(b,c),i=parseFloat(d);d=(d+"").replace(/^[-\d.]+/,"");if(isNaN(i))return{v:d,u:"",f:z};return{v:i,u:d,f:this.interpolate}},setter:function(b,c,d){return e.css(b,c,d)},interpolate:function(b,c,d){return(b+(c-b)*d).toFixed(3)},eq:function(b,c){return b.v==c.v&&b.u==c.u}}};var o=s.PROP_OPS;g.augment(s,l,{isRunning:false,elapsedTime:0,start:0,finish:0,duration:0,
run:function(){var b=this.config,c=this.domEl,d,i=this.props,h={},p;if(!this.isRunning)if(this.fire("start")!==false){this.stop();this.duration=d=b.duration*1E3;if(this.transitionName)this._nativeRun();else{for(p in i)h[p]=(o[p]||o["*"]).getter(c,p);this.source=h;c=g.now();d=c+d;b=b.easing;if(g.isString(b))b=f[b]||f.easeNone;this.start=c;this.finish=d;this.easing=b;r.start(this)}this.isRunning=true;return this}},_complete:function(){this.fire("complete");this.callback&&this.callback()},_runFrame:function(){var b=
this.domEl,c=this.finish,d=this.start,i=this.duration,h=g.now(),p=this.source,q=this.easing,B=this.props,v;d=h-d;i=h>c?1:d/i;var w,D;this.elapsedTime=d;for(v in B){d=p[v];w=B[v];var x;x=w;var C=d,F=o[v];x=F&&F.eq?F.eq(x,C):o["*"].eq(x,C);if(!x){if(w.v==0)w.u=d.u;if(d.u!==w.u){d.v=0;d.u=w.u}x=w.f(d.v,w.v,q(i))+w.u;(o[v]||o["*"]).setter(b,v,x);if(w.f==z){d.v=w.v;d.u=w.u}}}if(this.fire("step")===false||(D=h>c)){this.stop();D&&this._complete()}},_nativeRun:function(){var b=this,c=b.domEl,d=b.duration,
i=b.config.easing,h=b.transitionName,p={};p[h+"Property"]="all";p[h+"Duration"]=d+"ms";p[h+"TimingFunction"]=i;e.css(c,p);g.later(function(){j(c,b.targetStyle)},0);g.later(function(){b.stop(true)},d)},stop:function(b){if(this.isRunning){if(this.transitionName)this._nativeStop(b);else{if(b){j(this.domEl,this.targetStyle);this._complete()}r.stop(this)}this.isRunning=false;return this}},_nativeStop:function(b){var c=this.domEl,d=this.transitionName,i=this.props,h;if(b){e.css(c,d+"Property","none");this._complete()}else{for(h in i)e.css(c,
h,e._getComputedStyle(c,h));e.css(c,d+"Property","none")}}});s.supportTransition=function(){if(k)return k;var b="transition",c,d=document.body;if(d.style[b]!==a)c=b;else g.each(["Webkit","Moz","O"],function(i){if(d.style[b=i+"Transition"]!==a){c=b;return false}});return k=c};var y=s.supportTransition;return s},{requires:["dom","event","./easing","ua","./manager"]});
KISSY.add("anim/color",function(g,e,l){function f(j){j=j.toLowerCase();var n;if(n=j.match(r))return[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];else if(n=j.match(a)){for(j=1;j<n.length;j++)if(n[j].length<2)n[j]+=n[j];return[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]}if(m[j])return m[j];return[255,255,255]}var m={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],
olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]},r=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,a=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i,s="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),z=l.PROP_OPS;l=l.PROPS;l.push.apply(l,s);z.color={getter:function(j,n){return{v:f(e.css(j,n)),u:"",f:this.interpolate}},setter:z["*"].setter,interpolate:function(j,n,u){var t=
z["*"].interpolate;return"rgb("+[Math.floor(t(j[0],n[0],u)),Math.floor(t(j[1],n[1],u)),Math.floor(t(j[2],n[2],u))].join(", ")+")"},eq:function(j,n){return j.v+""==n.v+""}};g.each(s,function(j){z[j]=z.color})},{requires:["dom","./base"]});
KISSY.add("anim/easing",function(){var g=Math,e=g.PI,l=g.pow,f=g.sin,m=1.70158,r={easeNone:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return(2-a)*a},easeBoth:function(a){return(a*=2)<1?0.5*a*a:0.5*(1- --a*(a-2))},easeInStrong:function(a){return a*a*a*a},easeOutStrong:function(a){return 1- --a*a*a*a},easeBothStrong:function(a){return(a*=2)<1?0.5*a*a*a*a:0.5*(2-(a-=2)*a*a*a)},elasticIn:function(a){if(a===0||a===1)return a;return-(l(2,10*(a-=1))*f((a-0.075)*2*e/0.3))},elasticOut:function(a){if(a===
0||a===1)return a;return l(2,-10*a)*f((a-0.075)*2*e/0.3)+1},elasticBoth:function(a){if(a===0||(a*=2)===2)return a;if(a<1)return-0.5*l(2,10*(a-=1))*f((a-0.1125)*2*e/0.45);return l(2,-10*(a-=1))*f((a-0.1125)*2*e/0.45)*0.5+1},backIn:function(a){if(a===1)a-=0.0010;return a*a*((m+1)*a-m)},backOut:function(a){return(a-=1)*a*((m+1)*a+m)+1},backBoth:function(a){if((a*=2)<1)return 0.5*a*a*(((m*=1.525)+1)*a-m);return 0.5*((a-=2)*a*(((m*=1.525)+1)*a+m)+2)},bounceIn:function(a){return 1-r.bounceOut(1-a)},bounceOut:function(a){return a<
1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bounceBoth:function(a){if(a<0.5)return r.bounceIn(a*2)*0.5;return r.bounceOut(a*2-1)*0.5+0.5}};r.NativeTimeFunction={easeNone:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeBoth:"ease-in-out",easeInStrong:"cubic-bezier(0.9, 0.0, 0.9, 0.5)",easeOutStrong:"cubic-bezier(0.1, 0.5, 0.1, 1.0)",easeBothStrong:"cubic-bezier(0.9, 0.0, 0.1, 1.0)"};return r});
KISSY.add("anim/manager",function(g){function e(f){f[l]=f[l]||g.guid("anim-");return f[l]}var l=g.guid("anim-");return{interval:20,runnings:{},timer:null,start:function(f){var m=e(f);if(!this.runnings[m]){this.runnings[m]=f;this.startTimer()}},stop:function(f){this.notRun(f)},notRun:function(f){delete this.runnings[e(f)];g.isEmptyObject(this.runnings)&&this.stopTimer()},pause:function(f){this.notRun(f)},resume:function(f){this.start(f)},startTimer:function(){var f=this;if(!f.timer)f.timer=setTimeout(function(){if(f.runFrames())f.stopTimer();
else{f.timer=null;f.startTimer()}},f.interval)},stopTimer:function(){var f=this.timer;if(f){clearTimeout(f);this.timer=null}},runFrames:function(){var f=true,m=this.runnings,r;for(r in m)if(m.hasOwnProperty(r)){f=false;m[r]._runFrame()}return f}}});
KISSY.add("anim/node-plugin",function(g,e,l,f,m){function r(k,o,y,b,c,d,i){if(o==="toggle"){c=e.css(k,s)===z?1:0;o="show"}if(c)e.css(k,s,e.data(k,s)||"");var h={},p={};g.each(E[o],function(q){if(q===j){h[j]=e.css(k,j);e.css(k,j,n)}else if(q===u){h[u]=e.css(k,u);p.opacity=c?1:0;c&&e.css(k,u,0)}else if(q===t){h[t]=e.css(k,t);p.height=c?e.css(k,t)||k.naturalHeight:0;c&&e.css(k,t,0)}else if(q===A){h[A]=e.css(k,A);p.width=c?e.css(k,A)||k.naturalWidth:0;c&&e.css(k,A,0)}});return(new l(k,p,y,d||"easeOut",
function(){if(!c){var q=k.style,B=q[s];if(B!==z){B&&e.data(k,s,B);q[s]=z}h[t]&&e.css(k,{height:h[t]});h[A]&&e.css(k,{width:h[A]});h[u]&&e.css(k,{opacity:h[u]});h[j]&&e.css(k,{overflow:h[j]})}b&&g.isFunction(b)&&b()},i)).run()}f=g.require("node/node").prototype;var a=g.require("node/nodelist").prototype,s="display",z="none",j="overflow",n="hidden",u="opacity",t="height",A="width",E={show:[j,u,t,A],fade:[u],slide:[j,t]};g.each([f,a],function(k){k.animate=function(){var o=this,y=g.makeArray(arguments);
o.__anims=o.__anims||[];g.each(this,function(b){o.__anims.push(l.apply(m,[b].concat(y)).run())});return this};k.stopAnimate=function(o){g.each(this.__anims,function(y){y.stop(o)});this.__anims=[]};g.each({show:["show",1],hide:["show",0],toggle:["toggle"],fadeIn:["fade",1],fadeOut:["fade",0],slideDown:["slide",1],slideUp:["slide",0]},function(o,y){k[y]=function(b,c,d,i){var h=this;h.__anims=h.__anims||[];e[y]&&arguments.length===0?e[y](this):g.each(this,function(p){h.__anims.push(r(p,o[0],b,c,o[1],
d,i))});return this}})})},{requires:["dom","anim/base","node"]});KISSY.add("anim/scroll",function(g,e,l){var f=l.PROP_OPS;l.CUSTOM_ATTRS.push("scrollLeft","scrollTop");f.scrollLeft=f.scrollTop={getter:function(m,r){return{v:m[r],u:"",f:f["*"].interpolate}},setter:function(m,r,a){m[r]=a}}},{requires:["dom","./base"]});KISSY.add("anim",function(g,e,l){e.Easing=l;return e},{requires:["anim/base","anim/easing","anim/node-plugin","anim/color","anim/scroll"]});
