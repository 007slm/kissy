/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("anim/base",function(h,f,m,g,n,p,a){function u(b,d,c,e,l,o){if(b=f.get(b)){if(!(this instanceof u))return new u(b,d,c,e,l,o);var r=h.isPlainObject(c);d=d;this.domEl=b;if(h.isPlainObject(d))d=String(h.param(d,";")).replace(/=/g,":").replace(/%23/g,"#").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();var C=d,z=b;b={};var x=s.length,B=z.cloneNode(true);f.insertAfter(B,z);z=B.style;for(k(B,C);x--;){var y=s[x];if(z[y])b[y]=(q[y]||q["*"]).getter(B,y)}C=i(C);for(var D in C)b[D]=(q[D]||q["*"]).getter(B,
D);f.remove(B);this.props=b;this.targetStyle=d;if(r)r=h.merge(j,c);else{r=h.clone(j);if(c)r.duration=parseFloat(c)||1;if(h.isString(e)||h.isFunction(e))r.easing=e;if(h.isFunction(l))r.complete=l;if(o!==a)r.nativeSupport=o}if(!h.isEmptyObject(i(d)))r.nativeSupport=false;this.config=r;if(r.nativeSupport&&A()&&h.isString(e=r.easing))if(/cubic-bezier\([\s\d.,]+\)/.test(e)||(e=g.NativeTimeFunction[e])){r.easing=e;this.transitionName=A()}if(h.isFunction(l))this.callback=l}}function v(b,d){return d}function k(b,
d){if(n.ie&&d.indexOf(E)>-1){var c=d.match(/opacity\s*:\s*([^;]+)(;|$)/);c&&f.css(b,E,parseFloat(c[1]))}b.style.cssText+=";"+d;c=i(d);for(var e in c)b[e]=c[e]}function i(b){for(var d={},c=0;c<t.length;c++){var e=t[c].replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(e=b.match(RegExp(e+"\\s*:([^;]+)(;|$)")))d[t[c]]=h.trim(e[1])}return d}var s,t,E,j,w;m=m.Target;s="borderBottomWidth borderBottomStyle borderLeftWidth borderLeftStyle borderRightWidth borderRightStyle borderSpacing borderTopWidth borderTopStyle bottom fontFamily fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop maxHeight maxWidth minHeight minWidth opacity outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex".split(" ");
t=[];E="opacity";j={duration:1,easing:"easeNone",nativeSupport:true};u.PROPS=s;u.CUSTOM_ATTRS=t;u.PROP_OPS={"*":{getter:function(b,d){var c=f.css(b,d),e=parseFloat(c);c=(c+"").replace(/^[-\d.]+/,"");if(isNaN(e))return{v:c,u:"",f:v};return{v:e,u:c,f:this.interpolate}},setter:function(b,d,c){return f.css(b,d,c)},interpolate:function(b,d,c){return(b+(d-b)*c).toFixed(3)},eq:function(b,d){return b.v==d.v&&b.u==d.u}}};var q=u.PROP_OPS;h.augment(u,m,{isRunning:false,elapsedTime:0,start:0,finish:0,duration:0,
run:function(){var b=this.config,d=this.domEl,c,e=this.props,l={},o;if(!this.isRunning)if(this.fire("start")!==false){this.stop();this.duration=c=b.duration*1E3;if(this.transitionName)this._nativeRun();else{for(o in e)l[o]=(q[o]||q["*"]).getter(d,o);this.source=l;d=h.now();c=d+c;b=b.easing;if(h.isString(b))b=g[b]||g.easeNone;this.start=d;this.finish=c;this.easing=b;p.start(this)}this.isRunning=true;return this}},_complete:function(){this.fire("complete");this.callback&&this.callback()},_runFrame:function(){var b=
this.domEl,d=this.finish,c=this.start,e=this.duration,l=h.now(),o=this.source,r=this.easing,C=this.props,z;c=l-c;e=l>d?1:c/e;var x,B;this.elapsedTime=c;for(z in C){c=o[z];x=C[z];var y;y=x;var D=c,F=q[z];y=F&&F.eq?F.eq(y,D):q["*"].eq(y,D);if(!y){if(x.v==0)x.u=c.u;if(c.u!==x.u){c.v=0;c.u=x.u}y=x.f(c.v,x.v,r(e))+x.u;(q[z]||q["*"]).setter(b,z,y);if(x.f==v){c.v=x.v;c.u=x.u}}}if(this.fire("step")===false||(B=l>d)){this.stop();B&&this._complete()}},_nativeRun:function(){var b=this,d=b.domEl,c=b.duration,
e=b.config.easing,l=b.transitionName,o={};o[l+"Property"]="all";o[l+"Duration"]=c+"ms";o[l+"TimingFunction"]=e;f.css(d,o);h.later(function(){k(d,b.targetStyle)},0);h.later(function(){b.stop(true)},c)},stop:function(b){if(this.isRunning){if(this.transitionName)this._nativeStop(b);else{if(b){k(this.domEl,this.targetStyle);this._complete()}p.stop(this)}this.isRunning=false;return this}},_nativeStop:function(b){var d=this.domEl,c=this.transitionName,e=this.props,l;if(b){f.css(d,c+"Property","none");this._complete()}else{for(l in e)f.css(d,
l,f._getComputedStyle(d,l));f.css(d,c+"Property","none")}}});u.supportTransition=function(){if(w)return w;var b="transition",d,c=document.body;if(c.style[b]!==a)d=b;else h.each(["Webkit","Moz","O"],function(e){if(c.style[b=e+"Transition"]!==a){d=b;return false}});return w=d};var A=u.supportTransition;return u},{requires:["dom","event","./easing","ua","./manager"]});
KISSY.add("anim/color",function(h,f,m){function g(k){k=k.toLowerCase();var i;if(i=k.match(p))return[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])];else if(i=k.match(a)){for(k=1;k<i.length;k++)if(i[k].length<2)i[k]+=i[k];return[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]}if(n[k])return n[k];return[255,255,255]}var n={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],
olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]},p=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,a=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i,u="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),v=m.PROP_OPS;m=m.PROPS;m.push.apply(m,u);v.color={getter:function(k,i){return{v:g(f.css(k,i)),u:"",f:this.interpolate}},setter:v["*"].setter,interpolate:function(k,i,s){var t=
v["*"].interpolate;return"rgb("+[Math.floor(t(k[0],i[0],s)),Math.floor(t(k[1],i[1],s)),Math.floor(t(k[2],i[2],s))].join(", ")+")"},eq:function(k,i){return k.v+""==i.v+""}};h.each(u,function(k){v[k]=v.color})},{requires:["dom","./base"]});
KISSY.add("anim/easing",function(){var h=Math,f=h.PI,m=h.pow,g=h.sin,n=1.70158,p={easeNone:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return(2-a)*a},easeBoth:function(a){return(a*=2)<1?0.5*a*a:0.5*(1- --a*(a-2))},easeInStrong:function(a){return a*a*a*a},easeOutStrong:function(a){return 1- --a*a*a*a},easeBothStrong:function(a){return(a*=2)<1?0.5*a*a*a*a:0.5*(2-(a-=2)*a*a*a)},elasticIn:function(a){if(a===0||a===1)return a;return-(m(2,10*(a-=1))*g((a-0.075)*2*f/0.3))},elasticOut:function(a){if(a===
0||a===1)return a;return m(2,-10*a)*g((a-0.075)*2*f/0.3)+1},elasticBoth:function(a){if(a===0||(a*=2)===2)return a;if(a<1)return-0.5*m(2,10*(a-=1))*g((a-0.1125)*2*f/0.45);return m(2,-10*(a-=1))*g((a-0.1125)*2*f/0.45)*0.5+1},backIn:function(a){if(a===1)a-=0.0010;return a*a*((n+1)*a-n)},backOut:function(a){return(a-=1)*a*((n+1)*a+n)+1},backBoth:function(a){if((a*=2)<1)return 0.5*a*a*(((n*=1.525)+1)*a-n);return 0.5*((a-=2)*a*(((n*=1.525)+1)*a+n)+2)},bounceIn:function(a){return 1-p.bounceOut(1-a)},bounceOut:function(a){return a<
1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bounceBoth:function(a){if(a<0.5)return p.bounceIn(a*2)*0.5;return p.bounceOut(a*2-1)*0.5+0.5}};p.NativeTimeFunction={easeNone:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeBoth:"ease-in-out",easeInStrong:"cubic-bezier(0.9, 0.0, 0.9, 0.5)",easeOutStrong:"cubic-bezier(0.1, 0.5, 0.1, 1.0)",easeBothStrong:"cubic-bezier(0.9, 0.0, 0.1, 1.0)"};return p});
KISSY.add("anim/manager",function(h){function f(g){g[m]=g[m]||h.guid("anim-");return g[m]}var m=h.guid("anim-");return{interval:20,runnings:{},timer:null,start:function(g){var n=f(g);if(!this.runnings[n]){this.runnings[n]=g;this.startTimer()}},stop:function(g){this.notRun(g)},notRun:function(g){delete this.runnings[f(g)];h.isEmptyObject(this.runnings)&&this.stopTimer()},pause:function(g){this.notRun(g)},resume:function(g){this.start(g)},startTimer:function(){var g=this;if(!g.timer)g.timer=setTimeout(function(){if(g.runFrames())g.stopTimer();
else{g.timer=null;g.startTimer()}},g.interval)},stopTimer:function(){var g=this.timer;if(g){clearTimeout(g);this.timer=null}},runFrames:function(){var g=true,n=this.runnings,p;for(p in n)if(n.hasOwnProperty(p)){g=false;n[p]._runFrame()}return g}}});
KISSY.add("anim/node-plugin",function(h,f,m,g,n){function p(j,w,q,A,b,d,c){if(w==="toggle"){b=f.css(j,a)===u?1:0;w="show"}if(b)f.css(j,a,f.data(j,a)||"");var e={},l={};h.each(E[w],function(o){if(o===v){e[v]=f.css(j,v);f.css(j,v,k)}else if(o===i){e[i]=f.css(j,i);l.opacity=b?1:0;b&&f.css(j,i,0)}else if(o===s){e[s]=f.css(j,s);l.height=b?f.css(j,s)||j.naturalHeight:0;b&&f.css(j,s,0)}else if(o===t){e[t]=f.css(j,t);l.width=b?f.css(j,t)||j.naturalWidth:0;b&&f.css(j,t,0)}});return(new m(j,l,q,d||"easeOut",
function(){if(!b){var o=j.style,r=o[a];if(r!==u){r&&f.data(j,a,r);o[a]=u}e[s]&&f.css(j,{height:e[s]});e[t]&&f.css(j,{width:e[t]});e[i]&&f.css(j,{opacity:e[i]});e[v]&&f.css(j,{overflow:e[v]})}A&&h.isFunction(A)&&A()},c)).run()}var a="display",u="none",v="overflow",k="hidden",i="opacity",s="height",t="width",E={show:[v,i,s,t],fade:[i],slide:[v,s]};(function(j){j.animate=function(){var w=this,q=h.makeArray(arguments);w.__anims=w.__anims||[];h.each(this,function(A){w.__anims.push(m.apply(n,[A].concat(q)).run())});
return this};j.stopAnimate=function(w){h.each(this.__anims,function(q){q.stop(w)});this.__anims=[]};h.each({show:["show",1],hide:["show",0],toggle:["toggle"],fadeIn:["fade",1],fadeOut:["fade",0],slideDown:["slide",1],slideUp:["slide",0]},function(w,q){j[q]=function(A,b,d,c){var e=this;e.__anims=e.__anims||[];f[q]&&arguments.length===0?f[q](this):h.each(this,function(l){e.__anims.push(p(l,w[0],A,b,w[1],d,c))});return this}})})(g.List.prototype)},{requires:["dom","anim/base","node"]});
KISSY.add("anim/scroll",function(h,f,m){var g=m.PROP_OPS;m.CUSTOM_ATTRS.push("scrollLeft","scrollTop");g.scrollLeft=g.scrollTop={getter:function(n,p){return{v:n[p],u:"",f:g["*"].interpolate}},setter:function(n,p,a){n[p]=a}}},{requires:["dom","./base"]});KISSY.add("anim",function(h,f,m){f.Easing=m;return f},{requires:["anim/base","anim/easing","anim/node-plugin","anim/color","anim/scroll"]});
