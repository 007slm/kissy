/*
Copyright 2012, KISSY UI Library v1.30dev
MIT Licensed
build time: Mar 6 18:05
*/
KISSY.add("htmlparser/Parser",function(k,o,n,m,h,i,p,r){function e(a,d){this.originalHtml=a=k.trim(a);a=/^(<!doctype|<html|<body)/i.test(a)?"<document>"+a+"</document>":"<body>"+a+"</body>";this.lexer=new i(a);this.opts=d||{}}function j(a){var d=f(a,"body",3);if(d){a=d.parentNode;var l=a.childNodes,g=k.indexOf(d,l);if(g!=l.length-1){l=l.slice(g+1,l.length);for(g=0;g<l.length;g++){a.removeChild(l[g]);l[g].tagName=="body"?k.each(l[g].childNodes,function(q){d.appendChild(q)}):d.appendChild(l[g])}}}return d}
function b(a){var d=a.childNodes,l,g,q=o.p,s=0;for(g=0;g<d.length;g++){l=d[g];if(l.nodeType==3||l.nodeType==1&&q[l.nodeName]){s=1;break}}if(s){s=[];var t=new n;t.nodeName=t.tagName="p";for(g=0;g<d.length;g++){l=d[g];if(l.nodeType==3||l.nodeType==1&&q[l.nodeName])t.appendChild(l);else{if(t.childNodes.length){s.push(t);t=t.clone()}s.push(l)}}t.childNodes.length&&s.push(t);a.empty();for(g=0;g<s.length;g++)a.appendChild(s[g])}}function f(a,d,l){if(l===0)return 0;k.isNumber(l)&&l--;var g=a.childNodes;
if(g)for(var q=0;q<g.length;q++){if(g[q].tagName===d)return g[q];if(a=f(g[q],d,l))return a}return 0}function c(a){for(var d=[].concat(a.childNodes),l=0;l<d.length;l++)if(d[l].nodeName=="html"){for(var g=d[l],q=0;q<l;q++)d[q].nodeType==3&&!k.trim(d[q].toHtml())&&a.removeChild(d[q]);for(;g.firstChild&&g.firstChild.nodeType==3&&!k.trim(g.firstChild.toHtml());)g.removeChild(g.firstChild);break}}e.prototype={elements:function(){var a,d,l=this.lexer,g=this.opts;d=a=l.nextNode();if(a.tagName!="document"){d=
new p;d.appendChild(a)}d.nodeType=9;r.getScanner("div").scan(a,l,g);(a=j(d))&&g.autoParagraph&&b(a);c(d);g=this.originalHtml;var q=new m;d=/^(<!doctype|<html|<body)/i.test(g)?d.childNodes:a.childNodes;k.each(d,function(s){q.appendChild(s)});return q},parse:function(){return this.elements()}};return e},{requires:["./dtd","./nodes/Tag","./nodes/Fragment","./lexer/Cursor","./lexer/Lexer","./nodes/Document","./Scanner"]});
KISSY.add("htmlparser/Scanner",function(k,o,n){return{getScanner:function(m){return n[m]||o}}},{requires:["./scanners/TagScanner","./scanners/SpecialScanners","./scanners/QuoteCdataScanner","./scanners/TextareaScanner"]});
KISSY.add("htmlparser/Utils",function(){return{collapseWhitespace:function(k){return k.replace(/[\s\xa0]+/g," ")},isLetter:function(k){return"a"<=k&&"z">=k||"A"<=k&&"Z">=k},isValidAttributeNameStartChar:function(k){return!this.isWhitespace(k)&&k!='"'&&k!="'"&&k!=">"&&k!="<"&&k!="/"&&k!="="},isWhitespace:function(k){return/^[\s\xa0]$/.test(k)}}});
KISSY.add("htmlparser/dtd",function(k){k=k.merge;var o={isindex:1,fieldset:1},n={input:1,button:1,select:1,textarea:1,label:1},m=k({a:1},n),h=k({iframe:1},m),i={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},p={ins:1,del:1,script:1,style:1},r=k({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},p),e=k({sub:1,img:1,object:1,sup:1,
basefont:1,map:1,applet:1,font:1,big:1,small:1},r),j=k({p:1},e);n=k({iframe:1},e,n);e={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,
address:1,q:1,pre:1,p:1,em:1,dfn:1};var b=k({a:1},n),f={tr:1},c={"#":1},a=k({param:1},e),d=k({form:1},o,h,i,j),l={li:1},g={base:1,link:1,meta:1,title:1},q=k(g,{style:1,script:1}),s={head:1,body:1},t={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1},u={$nonBodyContent:k({html:1},s,g),$block:t,$blockLimit:{body:1,div:1,td:1,th:1,caption:1,form:1},$inline:b,$body:k({script:1,style:1},t),$cdata:{script:1,
style:1},$empty:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},$listItem:{dd:1,dt:1,li:1},$list:{ul:1,ol:1,dl:1},$nonEditable:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},$removeEmpty:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},
$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:s,head:q,style:c,body:d,base:{},link:{},meta:{},title:c,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:d,td:d,br:{},th:d,center:d,kbd:b,button:k(j,i),basefont:{},h5:b,h4:b,samp:b,h6:b,ol:l,h1:b,h3:b,option:c,h2:b,form:k(o,h,i,j),select:{optgroup:1,option:1},font:b,ins:b,menu:l,abbr:b,label:b,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:b,script:c,tfoot:f,cite:b,li:d,input:{},iframe:d,
strong:b,textarea:c,noframes:d,big:b,small:b,span:b,hr:{},dt:b,sub:b,optgroup:{option:1},param:{},bdo:b,"var":b,div:d,object:a,sup:b,dd:d,strike:b,area:{},dir:l,map:k({area:1,form:1,p:1},o,p,i),applet:a,dl:{dt:1,dd:1},del:b,isindex:{},fieldset:k({legend:1},e),thead:f,ul:l,acronym:b,b:b,a:n,blockquote:d,caption:b,i:b,u:b,tbody:f,s:b,address:k(h,j),tt:b,legend:b,q:b,pre:k(r,m),p:b,em:b,dfn:b};(function(){var v,w=["article","figure","nav","aside","section","footer"],x;for(x in u)for(var y in u[x])if(y==
"div")for(v=0;v<w.length;v++)u[x][w[v]]=u[x][y];for(v=0;v<w.length;v++)u[w[v]]=u.div;u.$empty["!doctype"]=1})();return u});
KISSY.add("htmlparser",function(k,o,n,m,h,i,p,r,e,j,b,f,c){return{CData:e,Comment:j,Node:b,Tag:f,Text:c,Lexer:n,Parser:m,BasicWriter:h,BeautifyWriter:i,MinifyWriter:p,Filter:r,DTD:o}},{requires:["htmlparser/dtd","htmlparser/lexer/Lexer","htmlparser/Parser","htmlparser/writer/basic","htmlparser/writer/beautify","htmlparser/writer/minify","htmlparser/writer/filter","htmlparser/nodes/CData","htmlparser/nodes/Comment","htmlparser/nodes/Node","htmlparser/nodes/Tag","htmlparser/nodes/Text"]});
KISSY.add("htmlparser/lexer/Cursor",function(){function k(o){this.position=o||0}k.prototype={advance:function(){this.position++},retreat:function(){this.position=Math.max(--this.position,0)}};return k});
KISSY.add("htmlparser/lexer/Index",function(){function k(){this.lineCursors=[]}function o(m,h){for(var i=0;i<m.length;i++)if(m[i].position===h.position)return i;return-1}function n(m,h){for(var i=0;i<m.length;i++)if(m[i].position>h.position)break;return i}k.prototype={add:function(m){o(this.lineCursors,m)==-1&&this.lineCursors.splice(n(this.lineCursors,m),0,m)},remove:function(m){var h=this.lineCursors;m=o(this.lineCursors,m);m!=-1&&h.splice(m,1)},row:function(m){return n(this.lineCursors,m)-1},col:function(m){var h=
n(this.lineCursors,m)-1;return m.position-this.lineCursors[h]}};return k});
KISSY.add("htmlparser/lexer/Lexer",function(k,o,n,m,h,i,p,r,e){function j(b){this.page=new n(b);this.cursor=new o;this.nodeFactory=this}j.prototype={setPosition:function(b){this.cursor.position=b},getPosition:function(){return this.cursor.position},nextNode:function(b){var f,c,a=this.cursor,d=this.page;f=a.position;c=d.getChar(a);switch(c){case -1:b=null;break;case "<":c=d.getChar(a);if(c==-1)b=this.makeString(f,a.position);else if(c=="/"||i.isLetter(c)){d.ungetChar(a);b=this.parseTag(f)}else if("!"==
c||"?"==c){c=d.getChar(a);if(c==-1)b=this.makeString(f,a.position);else if(">"==c)b=this.makeComment(f,a.position);else{d.ungetChar(a);if("-"==c)b=this.parseComment(f,b);else{d.ungetChar(a);b=this.parseTag(f)}}}else{d.ungetChar(a);b=this.parseString(f,b)}break;default:d.ungetChar(a);b=this.parseString(f,b)}return b},makeComment:function(b,f){var c;c=f-b;if(0!=c){if(2>c)return this.makeString(b,f);c=this.nodeFactory.createCommentNode(this.page,b,f)}else c=null;return c},makeString:function(b,f){var c=
null;if(f-b>0)c=this.nodeFactory.createStringNode(this.page,b,f);return c},makeCData:function(b,f){var c=null;if(f-b>0)c=this.nodeFactory.createCDataNode(this.page,b,f);return c},makeTag:function(b,f,c){var a;a=f-b;if(0!=a){if(2>a)return this.makeString(b,f);b=this.nodeFactory.createTagNode(this.page,b,f,c)}else b=null;return b},createTagNode:function(b,f,c,a){return new r(b,f,c,a)},createStringNode:function(b,f,c){return new m(b,f,c)},createCDataNode:function(b,f,c){return new h(b,f,c)},createCommentNode:function(b,
f,c){return new e(b,f,c)},parseTag:function(b){var f,c=[],a=[],d,l=this.page,g=0,q=this.cursor;for(c[0]=q.position;!f;){c[g+1]=q.position;d=l.getChar(q);switch(g){case 0:if(d==-1||">"==d||"<"==d){if("<"==d){l.ungetChar(q);c[g+1]=q.position}f=true}else if(d=="/"||i.isValidAttributeNameStartChar(d))g=1;break;case 1:if(-1==d||">"==d||"<"==d){if("<"==d){l.ungetChar(q);c[g+1]=q.getPosition}this.standalone(a,c);f=true}else if(i.isWhitespace(d)){c[6]=c[2];g=6}else if("="==d)g=2;break;case 2:if(-1==d||">"==
d){this.standalone(a,c);f=true}else if("'"==d){g=4;c[4]=c[3]}else if('"'==d){g=5;c[5]=c[3]}else i.isWhitespace(d)||(g=3);break;case 3:if(-1==d||">"==d){this.naked(a,c);f=true}else if(i.isWhitespace(d)){this.naked(a,c);c[0]=c[4];g=0}break;case 4:if(-1==d){this.single_quote(a,c);f=true}else if("'"==d){this.single_quote(a,c);c[0]=c[5]+1;g=0}break;case 5:if(-1==d){this.double_quote(a,c);f=true}else if('"'==d){this.double_quote(a,c);c[0]=c[6]+1;g=0}break;case 6:if(-1==d){this.standalone(a,c);c[0]=c[6];
l.ungetChar(q);g=0}else if(!i.isWhitespace(d))if("="==d){c[2]=c[6];c[3]=c[7];g=2}else{this.standalone(a,c);c[0]=c[6];l.ungetChar(q);g=0}break;default:throw Error("how ** did we get in state "+g);}}return this.makeTag(b,q.position,a)},parseComment:function(b,f){var c,a,d=this.page,l=this.cursor,g;c=false;for(g=0;!c;){a=d.getChar(l);if(-1==a)c=true;else switch(g){case 0:if(">"==a)c=true;if("-"==a)g=1;else return this.parseString(b,f);break;case 1:if("-"==a){a=d.getChar(l);if(-1==a)c=true;else if(">"==
a)c=true;else{d.ungetChar(l);g=2}}else return this.parseString(b,f);break;case 2:if("-"==a)g=3;else if(-1==a)return this.parseString(b,f);break;case 3:g="-"==a?4:2;break;case 4:if(">"==a)c=true;else i.isWhitespace(a)||(g=2);break;default:throw Error("how ** did we get in state "+g);}}return this.makeComment(b,l.position)},parseString:function(b,f){for(var c=0,a,d=this.page,l=this.cursor,g=0;!c;){a=d.getChar(l);if(-1==a)c=1;else if(f&&0==g&&("'"==a||'"'==a))g=a;else if(f&&0!=g&&"\\"==a){a=d.getChar(l);
-1!=a&&"\\"!=a&&a!=g&&d.ungetChar(l)}else if(f&&a==g)g=0;else if(f&&0==g&&a=="/"){a=d.getChar(l);if(-1==a)c=1;else if("/"==a){do a=d.getChar(l);while(-1!=a&&"\n"!=a)}else if("*"==a){do{do a=d.getChar(l);while(-1!=a&&"*"!=a);a=d.getChar(l);a=="*"&&d.ungetChar(l)}while(-1!=a&&"/"!=a)}else d.ungetChar(l)}else if(0==g&&"<"==a){a=d.getChar(l);if(-1==a)c=1;else{if("/"==a||i.isLetter(a)||"!"==a||"?"==a){c=1;d.ungetChar(l)}d.ungetChar(l)}}}return this.makeString(b,l.position)},parseCDATA:function(b,f){var c,
a,d,l,g,q,s=this.cursor,t=this.page;c=s.position;a=0;d=false;l="";for(q=false;!d;){g=t.getChar(s);switch(a){case 0:switch(g){case -1:d=true;break;case "'":if(b&&!q)if(""==l)l="'";else if("'"==l)l="";break;case '"':if(b&&!q)if(""==l)l='"';else if('"'==l)l="";break;case "\\":if(b)if(""!=l){g=t.getChar(s);if(-1==g)d=true;else g!="\\"&&g!=l&&t.ungetChar(s)}break;case "/":if(b)if(""==l){g=t.getChar(s);if(-1==g)d=true;else if("/"==g)q=true;else if("*"==g){do{do g=t.getChar(s);while(-1!=g&&"*"!=g);g=t.getChar(s);
g=="*"&&t.ungetChar(s)}while(-1!=g&&"/"!=g)}else t.ungetChar(s)}break;case "\n":q=false;break;case "<":if(b){if(""==l)a=1}else a=1}break;case 1:switch(g){case -1:d=true;break;case "/":a=!f||t.getText(s.position,s.position+f.length)===f&&!t.getText(s.position+f.length,s.position+f.length+1).match(/\w/)?2:0;break;case "!":g=t.getChar(s);if(-1==g)d=true;else if("-"==g){g=t.getChar(s);if(-1==g)d=true;else a="-"==g?3:0}else a=0;break;default:a=0}break;case 2:q=false;if(-1==g)d=true;else if(i.isLetter(g)){d=
true;t.ungetChar(s);t.ungetChar(s);t.ungetChar(s)}else a=0;break;case 3:q=false;if(-1==g)d=true;else if("-"==g){g=t.getChar(s);if(-1==g)d=true;else if("-"==g){g=t.getChar(s);if(-1==g)d=true;else if(">"==g)a=0;else{t.ungetChar(s);t.ungetChar(s)}}else t.ungetChar(s)}break;default:throw Error("unexpected "+a);}}return this.makeCData(c,s.position)},single_quote:function(b,f){var c=this.page;b.push(new p(c.getText(f[1],f[2]),"=",c.getText(f[4]+1,f[5]),"'"))},double_quote:function(b,f){var c=this.page;
b.push(new p(c.getText(f[1],f[2]),"=",c.getText(f[5]+1,f[6]),'"'))},standalone:function(b,f){b.push(new p(this.page.getText(f[1],f[2])))},naked:function(b,f){var c=this.page;b.push(new p(c.getText(f[1],f[2]),"=",c.getText(f[3],f[4])))}};return j},{requires:["./Cursor","./Page","../nodes/Text","../nodes/CData","../Utils","../nodes/Attribute","../nodes/Tag","../nodes/Comment"]});
KISSY.add("htmlparser/lexer/Page",function(k,o){function n(m){this.source=m;this.lineIndex=new o}n.prototype={getChar:function(m){var h=this.source,i=m.position;if(i>=h.length)return-1;var p=h.charAt(i);m.advance();if("\r"===p){p="\n";i=m.position;h.charAt(i)==="\n"&&m.advance()}"\n"===p&&this.lineIndex.add(m);return p},ungetChar:function(m){var h=this.source;m.retreat();var i=m.position,p=h.charAt(i);if(p==="\n"&&0!=i){p=h.charAt(i-1);"\r"===p&&m.retreat()}},getText:function(m,h){return this.source.slice(m,
h)},row:function(m){return this.lineIndex.row(m)},col:function(m){return this.lineIndex.col(m)}};return n},{requires:["./Index"]});KISSY.add("htmlparser/nodes/Attribute",function(k){function o(n,m,h,i){this.nodeType=2;this.name=n;this.assignMent=m;this.value=h;this.quote=i}k.augment(o,{clone:function(){var n=new o;k.mix(n,this);return n},equals:function(n){return this.name==n.name&&this.value==n.value&&this.nodeType==n.nodeType}});o.prototype.clone=function(){var n=new o;k.mix(n,this);return n};return o});
KISSY.add("htmlparser/nodes/CData",function(k,o){function n(){n.superclass.constructor.apply(this,arguments);this.nodeType=4;this.nodeName="#cdata"}k.extend(n,o,{writeHtml:function(m,h){var i=this.toHtml();if(!h||h.onCData(this)!==false)m.cdata(i)}});return n},{requires:["./Text"]});
KISSY.add("htmlparser/nodes/Comment",function(k,o){function n(){n.superclass.constructor.apply(this,arguments);this.nodeType=8;this.nodeName="#comment"}k.extend(n,o,{writeHtml:function(m,h){var i=this.toHtml();if(!h||h.onComment(this)!==false)m.comment(i)}});return n},{requires:["./Tag"]});
KISSY.add("htmlparser/nodes/Document",function(k,o){function n(){this.childNodes=[];this.nodeType=9;this.nodeName="#document"}k.extend(n,o,{writeHtml:function(m,h){this.__filter=h;this._writeChildrenHtml(m)}});return n},{requires:["./Tag"]});
KISSY.add("htmlparser/nodes/Fragment",function(k,o){function n(){this.childNodes=[];this.nodeType=9;this.nodeName="#fragment"}k.extend(n,o,{writeHtml:function(m,h){this.__filter=h;this.isChildrenFiltered=0;h&&h.onFragment(this);this._writeChildrenHtml(m)}});return n},{requires:["./Tag"]});
KISSY.add("htmlparser/nodes/Node",function(k){function o(n,m,h){this.parentNode=null;this.page=n;this.startPosition=m;this.endPosition=h;this.nextSibling=this.previousSibling=this.nodeName=null;if(k.Config.debug)this.toHtmlContent=this.toHtml()}o.prototype={toHtml:function(){if(this.page&&this.page.getText)return this.page.getText(this.startPosition,this.endPosition)},toString:function(){var n=[];n.push(this.nodeName+"  ["+this.startPosition+":"+this.endPosition+"]\n");n.push(this.toHtml());return n.join("")}};
return o});
KISSY.add("htmlparser/nodes/Tag",function(k,o,n,m){function h(e,j,b){e.nodeName=e.tagName=j.toLowerCase();e._updateSelfClosed();k.each(b,function(f,c){e.setAttribute(c,f)})}function i(e,j,b,f){this.childNodes=[];this.lastChild=this.firstChild=null;this.attributes=f||[];this.nodeType=1;if(k.isString(e)){i.superclass.constructor.apply(this);h.apply(null,[this].concat(k.makeArray(arguments)))}else{i.superclass.constructor.apply(this,arguments);f=this.attributes;if(f[0]){this.nodeName=f[0].name.toLowerCase();this.tagName=
this.nodeName.replace(/\//,"");this._updateSelfClosed();f.splice(0,1)}var c=f[f.length-1];if(c=!!(c&&/\/$/.test(c.name)))f.length-=1;this.closed=this.isSelfClosed=this.isSelfClosed||c}this.closedEndPosition=this.closedStartPosition=-1}function p(e){var j=e.childNodes;e.firstChild=j[0];e.lastChild=j[j.length-1];if(j.length>=1){j[0].nextSibling=j[0].nextSibling=null;j[0].parentNode=e}if(j.length>1){for(var b=0;b<j.length-1;b++){j[b].nextSibling=j[b+1];j[b+1].previousSibling=j[b];j[b+1].parentNode=e}j[j.length-
1].nextSibling=null}}function r(e,j){for(var b=0;b<e.length;b++)if(e[b].name==j)return e[b];return null}k.extend(i,o,{_updateSelfClosed:function(){this.isSelfClosed=!!m.$empty[this.nodeName];if(!this.isSelfClosed)this.isSelfClosed=/\/$/.test(this.nodeName);this.closed=this.isSelfClosed},clone:function(){var e=new i,j=[];k.each(this.attributes,function(b){j.push(b.clone())});k.mix(e,{childNodes:[],firstChild:null,lastChild:null,attributes:j,nodeType:this.nodeType,nodeName:this.nodeName,tagName:this.tagName,
isSelfClosed:this.isSelfClosed,closed:this.closed,closedStartPosition:this.closedStartPosition,closedEndPosition:this.closedEndPosition});return e},setTagName:function(e){this.nodeName=this.tagName=e;this._updateSelfClosed()},equals:function(e){if(!e||this.nodeName!=e.nodeName)return 0;if(this.nodeType!=e.nodeType)return 0;if(this.attributes.length!=e.attributes.length)return 0;for(var j=0;j<this.attributes.length;j++)if(!this.attributes[j].equals(e.attributes[j]))return 0;return 1},isEndTag:function(){return/^\//.test(this.nodeName)},
appendChild:function(e){this.childNodes.push(e);p(this)},replace:function(e){var j=e.parentNode.childNodes,b=k.indexOf(e,j);j[b]=this;p(e.parentNode)},prepend:function(e){this.childNodes.unshift(e);p(this)},insertBefore:function(e){var j=e.parentNode.childNodes,b=k.indexOf(e,j);j.splice(b,0,this);p(e.parentNode)},insertAfter:function(e){var j=e.parentNode.childNodes,b=k.indexOf(e,j);b==j.length-1?e.parentNode.appendChild(this):this.insertBefore(e.parentNode.childNodes[[b+1]])},empty:function(){this.childNodes=
[];p(this)},removeChild:function(e){var j=e.parentNode.childNodes,b=k.indexOf(e,j);j.splice(b,1);p(e.parentNode)},getAttribute:function(e){return(e=r(this.attributes,e))&&e.value},setAttribute:function(e,j){var b=r(this.attributes,e);if(b)b.value=j;else this.attributes.push(new n(e,"=",j,'"'))},removeAttribute:function(e){(e=r(this.attributes,e))&&this.attributes.splice(k.indexOf(e,this.attributes),1)},filterChildren:function(){var e=this;if(!e.isChildrenFiltered){var j=new (k.require("htmlparser/writer/basic"));
e._writeChildrenHtml(j);j=(new (k.require("htmlparser/Parser"))(j.getHtml())).parse().childNodes;e.empty();k.each(j,function(b){e.appendChild(b)});e.isChildrenFiltered=1}},writeHtml:function(e,j){var b=this,f;f=b.tagName;if(f=="!doctype")e.append(this.toHtml()+"\n");else{b.__filter=j;b.isChildrenFiltered=0;if(j){if(!(f=j.onTagName(f)))return;b.tagName=f;f=j.onTag(b);if(f===false)return;if(f)b=f;if(b.nodeType!==1){b.writeHtml(e,j);return}if(!b.tagName){b._writeChildrenHtml(e);return}}e.openTag(b);
for(var c=b.attributes,a=0;a<c.length;a++){var d=c[a];f=d.name;if(j){if(!j.onAttributeName(f,b))continue;if(j.onAttribute(d,b)===false)continue}e.attribute(d,b)}e.openTagClose(b);if(!b.isSelfClosed){b._writeChildrenHtml(e);e.closeTag(b)}}},_writeChildrenHtml:function(e){var j=this.isChildrenFiltered?0:this.__filter;k.each(this.childNodes,function(b){b.writeHtml(e,j)})}});return i},{requires:["./Node","./Attribute","../dtd"]});
KISSY.add("htmlparser/nodes/Text",function(k,o){function n(m){if(k.isString(m)){this.nodeValue=m;n.superclass.constructor.apply(this,[null,-1,-1])}else{n.superclass.constructor.apply(this,arguments);this.nodeValue=this.toHtml()}this.nodeType=3;this.nodeName="#text"}k.extend(n,o,{writeHtml:function(m,h){var i=this.nodeValue;if(!h||h.onText(this)!==false)m.text(i)},toHtml:function(){return this.nodeValue?this.nodeValue:n.superclass.toHtml.apply(this,arguments)}});return n},{requires:["./Node"]});
KISSY.add("htmlparser/scanners/CdataScanner",function(){return{scan:function(k,o,n){n=o.parseCDATA(n.quoteSmart,k.nodeName);var m=o.getPosition(),h=o.nextNode();if(h)if(h.nodeType!=1||!(h.isEndTag()&&h.tagName==k.tagName))o.setPosition(m);k.closed=true;n&&k.appendChild(n)}}});KISSY.add("htmlparser/scanners/QuoteCdataScanner",function(k,o,n,m){k={scan:function(i,p,r){r=r||{};r.quoteSmart=1;o.scan(i,p,r);r.quoteSmart=0}};for(var h in n.$cdata)m[h]=k;return k},{requires:["./CdataScanner","../dtd","./SpecialScanners"]});
KISSY.add("htmlparser/scanners/SpecialScanners",function(){return{}});
KISSY.add("htmlparser/scanners/TagScanner",function(k,o,n,m){function h(e,j){function b(){if(a.childNodes.length){a.insertAfter(d);d=a;a=e.clone()}}e.closed=1;if(!j.fixByDtd)return 0;var f=1,c=[].concat(e.childNodes);k.each(c,function(u){if(!i(e,u)){f=0;return false}});if(f)return 0;for(var a=e.clone(),d=e,l=[],g=0;g<c.length;g++){var q=c[g];if(i(a,q))a.appendChild(q);else if(q.nodeType==1){var s=q.tagName;if(o.$listItem[s]){b();q=p[q.tagName];var t=new n;for(t.nodeName=t.tagName=q;g<c.length;){if(c[g].tagName==
s)t.appendChild(c[g]);else if(!(c[g].nodeType==3&&!k.trim(c[g].toHtml())))if(c[g].nodeType==3)break;g++}t.insertAfter(d);d=t;g--}else{b();if(q.equals(a)){q.insertAfter(d);d=q}else if(i(q,a)){a=e.clone();k.each(q.childNodes,function(u){a.appendChild(u)});q.empty();q.insertAfter(d);d=q;q.appendChild(a);l.push(a);a=e.clone()}else{q.insertAfter(d);d=q}}}}a.childNodes.length&&a.insertAfter(d);e.parentNode.removeChild(e);k.each(l,function(u){h(u,j)});return 1}function i(e,j){if(e.nodeType==9)return 1;if(j.nodeType==
8)return 1;var b=j.tagName||j.nodeName;if(j.nodeType==3)b="#";return!!o[e.tagName][b]}var p={li:"ul",dt:"dl",dd:"dl"},r={dd:"dl",dt:"dl",li:"ul",option:"select",optgroup:"select"};return{scan:function(e,j,b){function f(q,s){for(d=q;d>s;d--){var t=l[d];l[d-1].appendChild(t);h(t,b)}e=l[s];l.length=s}function c(q){var s=0,t;if(t=r[q.tagName]){for(var u=l.length-1,v=l[u];v&&v.tagName!=t;){if(v.tagName==q.tagName){s=1;break}u--;v=l[u]}s&&f(l.length-1,u-1)}return s}var a,d,l;l=b.stack=b.stack||[];do{if(a=
j.nextNode())if(a.nodeType===1)if(a.isEndTag()&&a.tagName==e.tagName)a=null;else if(a.isEndTag()){if(a.isEndTag()){var g=-1;for(d=l.length-1;d>=0;d--)if(l[d].tagName===a.tagName){g=d;break}if(g!=-1){l[l.length-1].appendChild(e);h(e,b);f(l.length-1,g);a=null}}}else if(m[a.tagName]){m[a.tagName].scan(a,j,b);e.appendChild(a)}else if(a.isSelfClosed)e.appendChild(a);else{l.push(e);c(a)&&l.push(e);e=a}else e.appendChild(a);if(a==null)if(l.length>0){a=l[l.length-1];if(m[a.tagName])a=null;else{l.length-=
1;a.appendChild(e);h(e,b);e=a}}}while(a);h(e,b)}}},{requires:["../dtd","../nodes/Tag","./SpecialScanners"]});KISSY.add("htmlparser/scanners/TextareaScanner",function(k,o,n){return n.textarea={scan:function(m,h,i){i=i||{};o.scan(m,h,i)}}},{requires:["./CdataScanner","./SpecialScanners"]});
KISSY.add("htmlparser/writer/basic",function(){function k(){this.output=[]}k.prototype={append:function(){for(var o=this.output,n=arguments,m,h=0;h<n.length;h++){m=n[h];if(m.length>1)for(var i=0;i<m.length;i++)o.push(m.charAt(i));else o.push(m)}return this},openTag:function(o){this.append("<",o.tagName)},openTagClose:function(o){o.isSelfClosed&&this.append(" ","/");this.append(">")},closeTag:function(o){this.append("</",o.tagName,">")},attribute:function(o){this.append(" ",o.name,'="',(o.value||o.name).replace(/"/g,
"&quote;"),'"')},text:function(o){this.append(o)},cdata:function(o){this.append(o)},comment:function(o){this.append(o)},getHtml:function(){return this.output.join("")}};return k});
KISSY.add("htmlparser/writer/beautify",function(k,o,n,m){function h(){h.superclass.constructor.apply(this,arguments);this.inPre=0;this.indentChar="\t";this.allowIndent=this.indentLevel=0;this.rules={};for(var i in k.merge(n.$nonBodyContent,n.$block,n.$listItem,n.$tableContent,{select:1,script:1,style:1}))this.setRules(i,{allowIndent:1,breakBeforeOpen:1,breakAfterOpen:1,breakBeforeClose:1,breakAfterClose:1});this.setRules("option",{breakBeforeOpen:1});this.setRules("optiongroup",{breakBeforeOpen:1});
this.setRules("br",{breakAfterOpen:1});this.setRules("title",{allowIndent:0,breakBeforeClose:0,breakAfterOpen:0});this.setRules("pre",{allowIndent:0})}k.extend(h,o,{indentation:function(){this.inPre||this.append(Array(this.indentLevel+1).join(this.indentChar));this.allowIndent=0},lineBreak:function(){var i=this.output;if(!this.inPre&&i.length){for(var p=i.length-1;p>=0;p--)if(!/[\r\n\t ]/.test(i[p]))break;i.length=p+1;this.append("\n")}this.allowIndent=1},setRules:function(i,p){this.rules[i]||(this.rules[i]=
{});k.mix(this.rules[i],p)},openTag:function(i){var p=this.rules[i.tagName]||{};if(this.allowIndent)this.indentation();else if(p.breakBeforeOpen){this.lineBreak();this.indentation()}h.superclass.openTag.apply(this,arguments)},openTagClose:function(i){var p=i.tagName,r=this.rules[p]||{};if(i.isSelfClosed)this.append(" />");else{this.append(">");r.allowIndent&&this.indentLevel++}r.breakAfterOpen&&this.lineBreak();if(p==="pre")this.inPre=1},closeTag:function(i){var p=i.tagName,r=this.rules[p]||{};r.allowIndent&&
this.indentLevel--;if(this.allowIndent)this.indentation();else if(r.breakBeforeClose){this.lineBreak();this.indentation()}h.superclass.closeTag.apply(this,arguments);if(p==="pre")this.inPre=0;r.breakAfterClose&&this.lineBreak()},text:function(i){this.allowIndent&&this.indentation();this.inPre||(i=m.collapseWhitespace(i));this.append(i)},comment:function(i){this.allowIndent&&this.indentation();this.append(i)},cdata:function(i){this.allowIndent&&this.indentation();this.append(i)}});return h},{requires:["./basic",
"../dtd","../Utils"]});
KISSY.add("htmlparser/writer/filter",function(k){function o(){this.tagNames=[];this.attributeNames=[];this.tags=[];this.comment=[];this.text=[];this.cdata=[];this.attributes=[];this.root=[]}function n(h,i){for(var p=0;h&&p<h.length;p++)k.each(h[p].value,function(r){i=i.replace(r[0],r[1])});return i}function m(h,i,p){for(var r=0;h&&r<h.length;r++)if(h[r].value.apply(null,i)===false)return false;return p}o.prototype={addRules:function(h,i){i=i||10;for(var p in h)if(h.hasOwnProperty(p)){var r=this[p];
if(r){var e;a:{for(e=0;r&&e<r.length;e++)if(r[e].priority>i){e=e;break a}e=r.length}r.splice(e,0,{value:h[p],priority:i})}}},onTagName:function(h){return n(this.tagNames,h)},onAttributeName:function(h){return n(this.attributeNames,h)},onText:function(h){return m(this.text,[h.toHtml(),h],h)},onCData:function(h){return m(this.cdata,[h.toHtml(),h],h)},onAttribute:function(h,i){var p;a:{p=this.attributes;for(var r=0;p&&r<p.length;r++){var e=p[r].value,j=h.name;if(e[j]&&e[j].call(null,h.value,i)===false){p=
false;break a}}p=h}return p},onComment:function(h){return m(this.comment,[h.toHtml(),h],h)},onNode:function(h){var i=h.nodeType;if(i===1)return this.onTag(h);else if(i===3)return this.onText(h);else if(i===8)return this.onComment(h)},onFragment:function(h){return m(this.root,[h],h)},onTag:function(h){for(var i=["^",h.tagName,"$"],p=this.tags,r,e=0;e<i.length;e++)for(var j=i[e],b=0;b<p.length;b++){r=p[b].value;if(r[j]){if((r=r[j](h))===false)return false;if(r&&r!=h)return this.onNode(r);if(!h.tagName)return h}}return h}};
return o});
KISSY.add("htmlparser/writer/minify",function(k,o,n){function m(j){return j.replace(/"/g,"&quote;")}function h(j,b){var f=j.nodeName,c=b.name,a=b.value||"";if(/^on[a-z]+/.test(c))a=p(a).replace(/^javascript:[\s\xa0]*/i,"").replace(/[\s\xa0]*;$/,"");else if(c==="class")a=r(p(a));else if(/^(?:a|area|link|base)$/.test(f)&&c==="href"||f==="img"&&/^(?:src|longdesc|usemap)$/.test(c)||f==="object"&&/^(?:classid|codebase|data|usemap)$/.test(c)||f==="q"&&c==="cite"||f==="blockquote"&&c==="cite"||(f==="ins"||
f==="del")&&c==="cite"||f==="form"&&c==="action"||f==="input"&&(c==="src"||c==="usemap")||f==="head"&&c==="profile"||f==="script"&&(c==="src"||c==="for")||/^(?:a|area|object|button)$/.test(f)&&c==="tabindex"||f==="input"&&(c==="maxlength"||c==="tabindex")||f==="select"&&(c==="size"||c==="tabindex")||f==="textarea"&&/^(?:rows|cols|tabindex)$/.test(c)||f==="colgroup"&&c==="span"||f==="col"&&c==="span"||(f==="th"||f=="td")&&(c==="rowspan"||c==="colspan"))a=p(a);else if(c==="style")a=p(a).replace(/[\s\xa0]*;[\s\xa0]*$/,
"");return a}function i(){i.superclass.constructor.apply(this,arguments);this.inPre=0}var p=k.trim,r=n.collapseWhitespace,e=RegExp("^(?:class|id|style|title|lang|dir|on(?:focus|blur|change|click|dblclick|mouse(?:down|up|over|move|out)|key(?:press|down|up)))$");k.extend(i,o,{comment:function(j){if(/\[if[^\]]+\]/.test(j)){j=j.replace(/^(\[[^\]]+\]>)[\s\xa0]*/,"$1").replace(/[\s\xa0]*(<!\[endif\])$/,"$1");i.superclass.comment.call(this,j)}},openTag:function(j){if(j.tagName=="pre")this.inPre=1;i.superclass.openTag.apply(this,
arguments)},closeTag:function(j){if(j.tagName=="pre")this.inPre=0;i.superclass.closeTag.apply(this,arguments)},cdata:function(j){j=p(j).replace(/^(?:[\s\xa0]*\/\*[\s\xa0]*<!\[CDATA\[[\s\xa0]*\*\/|[\s\xa0]*\/\/[\s\xa0]*<!\[CDATA\[.*)/,"").replace(/(?:\/\*[\s\xa0]*\]\]>[\s\xa0]*\*\/|\/\/[\s\xa0]*\]\]>)[\s\xa0]*$/,"");i.superclass.cdata.call(this,j)},attribute:function(j,b){var f=j.name,c=j.value||"",a;a=j.name;a=p(j.value||"")?0:b==="input"&&a==="value"||e.test(a);if(!(a=a)){a=b.nodeName;var d=j.name,
l=j.value||"";l=p(l.toLowerCase());a=a==="script"&&d==="language"&&l==="javascript"||a==="form"&&d==="method"&&l==="get"||a==="input"&&d==="type"&&l==="text"||a==="script"&&d==="type"&&l==="text/javascript"||a==="style"&&d==="type"&&l==="text/css"||a==="area"&&d==="shape"&&l==="rect"}if(!a)if(/^(?:checked|disabled|selected|readonly|defer|multiple|nohref|noshape|nowrap|noresize|compact|ismap)$/i.test(f))this.append(" ",f);else!/[ "'=<>`]/.test(c)?this.append(" ",f,"=",m(h(b,j))):this.append(" ",f,
'="',m(h(b,j)),'"')},text:function(j){this.inPre||this.append(r(j))}});return i},{requires:["./basic","../Utils"]});
