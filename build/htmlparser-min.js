/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Nov 28 12:39
*/
KISSY.add("htmlparser/Parser",function(k,n,o){function g(b,m){this.lexer=b;this.opts=m}function f(b,m){this.lexer=new o(b);this.opts=m||{}}g.prototype={nextNode:function(){var b,m,l,q=this.lexer;if(b=q.nextNode())if(b.nodeType==1)if(b.isEndTag())return this.nextNode();else if(l=b.scanner){m=[];b=l.scan(b,q,m,this.opts)}return b}};f.prototype={elements:function(){return new g(this.lexer,this.opts)},parse:function(){for(var b=[],m,l=this.elements();m=l.nextNode();)b.push(m);return b}};return f},{requires:["./lexer/Cursor",
"./lexer/Lexer"]});KISSY.add("htmlparser/Utils",function(){return{collapseWhitespace:function(k){return k.replace(/[\s\xa0]+/g," ")},isLetter:function(k){return"a"<=k&&"z">=k||"A"<=k&&"Z">=k},isWhitespace:function(k){return/^[\s\xa0]$/.test(k)}}});
KISSY.add("htmlparser/dtd",function(k){k=k.merge;var n={isindex:1,fieldset:1},o={input:1,button:1,select:1,textarea:1,label:1},g=k({a:1},o),f=k({iframe:1},g),b={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},m={ins:1,del:1,script:1,style:1},l=k({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},m),q=k({sub:1,img:1,object:1,sup:1,
basefont:1,map:1,applet:1,font:1,big:1,small:1},l),p=k({p:1},q);o=k({iframe:1},q,o);q={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,
address:1,q:1,pre:1,p:1,em:1,dfn:1};var e=k({a:1},o),h={tr:1},c={"#":1},a=k({param:1},q),d=k({form:1},n,f,b,p),j={li:1},i={base:1,link:1,meta:1,title:1},s=k(i,{style:1,script:1}),r={head:1,body:1},t={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1},u={$nonBodyContent:k({html:1},r,i),$block:t,$blockLimit:{body:1,div:1,td:1,th:1,caption:1,form:1},$inline:e,$body:k({script:1,style:1},t),$cdata:{script:1,
style:1},$empty:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},$listItem:{dd:1,dt:1,li:1},$list:{ul:1,ol:1,dl:1},$nonEditable:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},$removeEmpty:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},
$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:r,head:s,style:c,body:d,base:{},link:{},meta:{},title:c,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:d,td:d,br:{},th:d,center:d,kbd:e,button:k(p,b),basefont:{},h5:e,h4:e,samp:e,h6:e,ol:j,h1:e,h3:e,option:c,h2:e,form:k(n,f,b,p),select:{optgroup:1,option:1},font:e,ins:e,menu:j,abbr:e,label:e,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:e,script:c,tfoot:h,cite:e,li:d,input:{},iframe:d,
strong:e,textarea:c,noframes:d,big:e,small:e,span:e,hr:{},dt:e,sub:e,optgroup:{option:1},param:{},bdo:e,"var":e,div:d,object:a,sup:e,dd:d,strike:e,area:{},dir:j,map:k({area:1,form:1,p:1},n,m,b),applet:a,dl:{dt:1,dd:1},del:e,isindex:{},fieldset:k({legend:1},q),thead:h,ul:j,acronym:e,b:e,a:o,blockquote:d,caption:e,i:e,u:e,tbody:h,s:e,address:k(f,p),tt:e,legend:e,q:e,pre:k(l,g),p:e,em:e,dfn:e};(function(){var v,w=["article","figure","nav","aside","section","footer"],x;for(x in u)for(var y in u[x])if(y==
"div")for(v=0;v<w.length;v++)u[x][w[v]]=u[x][y];for(v=0;v<w.length;v++)u[w[v]]=u.div})();return u});KISSY.add("htmlparser/lexer/Cursor",function(){function k(n){this.position=n||0}k.prototype={advance:function(){this.position++},retreat:function(){this.position=Math.max(--this.position,0)}};return k});
KISSY.add("htmlparser/lexer/Index",function(){function k(){this.lineCursors=[]}function n(g,f){for(var b=0;b<g.length;b++)if(g[b].position===f.position)return b;return-1}function o(g,f){for(var b=0;b<g.length;b++)if(g[b].position>f.position)break;return b}k.prototype={add:function(g){n(this.lineCursors,g)==-1&&this.lineCursors.splice(o(this.lineCursors,g),0,g)},remove:function(g){var f=this.lineCursors;g=n(this.lineCursors,g);g!=-1&&f.splice(g,1)},row:function(g){return o(this.lineCursors,g)-1},col:function(g){var f=
o(this.lineCursors,g)-1;return g.position-this.lineCursors[f]}};return k});
KISSY.add("htmlparser/lexer/Lexer",function(k,n,o,g,f,b,m,l,q){function p(e){this.page=new o(e);this.cursor=new n;this.nodeFactory=this}p.prototype={setPosition:function(e){this.cursor.position=e},getPosition:function(){return this.cursor.position},nextNode:function(e){var h,c,a=this.cursor,d=this.page;h=a.position;c=d.getChar(a);switch(c){case -1:e=null;break;case "<":c=d.getChar(a);if(c==-1)e=this.makeString(h,a.position);else if(c=="/"||b.isLetter(c)){d.ungetChar(a);e=this.parseTag(h)}else if("!"==
c){c=d.getChar(a);if(c==-1)e=this.makeString(h,a.position);else if(">"==c)e=this.makeComment(h,a.position);else{d.ungetChar(a);if("-"==c)e=this.parseComment(h,e);else{d.ungetChar(a);e=this.parseTag(h)}}}else{d.ungetChar(a);e=this.parseString(h,e)}break;default:d.ungetChar(a);e=this.parseString(h,e)}return e},makeComment:function(e,h){var c;c=h-e;if(0!=c){if(2>c)return this.makeString(e,h);c=this.nodeFactory.createCommentNode(this.page,e,h)}else c=null;return c},makeString:function(e,h){var c=null;
if(h-e>0)c=this.nodeFactory.createStringNode(this.page,e,h);return c},makeCData:function(e,h){var c=null;if(h-e>0)c=this.nodeFactory.createCDataNode(this.page,e,h);return c},makeTag:function(e,h,c){var a;a=h-e;if(0!=a){if(2>a)return this.makeString(e,h);e=this.nodeFactory.createTagNode(this.page,e,h,c)}else e=null;return e},createTagNode:function(e,h,c,a){return new l(e,h,c,a)},createStringNode:function(e,h,c){return new g(e,h,c)},createCDataNode:function(e,h,c){return new f(e,h,c)},createCommentNode:function(e,
h,c){return new q(e,h,c)},parseTag:function(e){var h,c=[],a=[],d,j=this.page,i=0,s=this.cursor;for(c[0]=s.position;!h;){c[i+1]=s.position;d=j.getChar(s);switch(i){case 0:if(d==-1||">"==d||"<"==d){if("<"==d){j.ungetChar(s);c[i+1]=s.position}h=true}else b.isWhitespace(d)||(i=1);break;case 1:if(-1==d||">"==d||"<"==d){if("<"==d){j.ungetChar(s);c[i+1]=s.getPosition}this.standalone(a,c);h=true}else if(b.isWhitespace(d)){c[6]=c[2];i=6}else if("="==d)i=2;break;case 2:if(-1==d||">"==d){this.standalone(a,c);
h=true}else if("'"==d){i=4;c[4]=c[3]}else if('"'==d){i=5;c[5]=c[3]}else b.isWhitespace(d)||(i=3);break;case 3:if(-1==d||">"==d){this.naked(a,c);h=true}else if(b.isWhitespace(d)){this.naked(a,c);c[0]=c[4];i=0}break;case 4:if(-1==d){this.single_quote(a,c);h=true}else if("'"==d){this.single_quote(a,c);c[0]=c[5]+1;i=0}break;case 5:if(-1==d){this.double_quote(a,c);h=true}else if('"'==d){this.double_quote(a,c);c[0]=c[6]+1;i=0}break;case 6:if(-1==d){this.standalone(a,c);c[0]=c[6];j.ungetChar(s);i=0}else if(!b.isWhitespace(d))if("="==
d){c[2]=c[6];c[3]=c[7];i=2}else{this.standalone(a,c);c[0]=c[6];j.ungetChar(s);i=0}break;default:throw Error("how ** did we get in state "+i);}}return this.makeTag(e,s.position,a)},parseComment:function(e,h){var c,a,d=this.page,j=this.cursor,i;c=false;for(i=0;!c;){a=d.getChar(j);if(-1==a)c=true;else switch(i){case 0:if(">"==a)c=true;if("-"==a)i=1;else return this.parseString(e,h);break;case 1:if("-"==a){a=d.getChar(j);if(-1==a)c=true;else if(">"==a)c=true;else{d.ungetChar(j);i=2}}else return this.parseString(e,
h);break;case 2:if("-"==a)i=3;else if(-1==a)return this.parseString(e,h);break;case 3:i="-"==a?4:2;break;case 4:if(">"==a)c=true;else b.isWhitespace(a)||(i=2);break;default:throw Error("how ** did we get in state "+i);}}return this.makeComment(e,j.position)},parseString:function(e,h){for(var c=0,a,d=this.page,j=this.cursor,i=0;!c;){a=d.getChar(j);if(-1==a)c=1;else if(h&&0==i&&("'"==a||'"'==a))i=a;else if(h&&0!=i&&"\\"==a){a=d.getChar(j);-1!=a&&"\\"!=a&&a!=i&&d.ungetChar(j)}else if(h&&a==i)i=0;else if(h&&
0==i&&a=="/"){a=d.getChar(j);if(-1==a)c=1;else if("/"==a){do a=d.getChar(j);while(-1!=a&&"\n"!=a)}else if("*"==a){do{do a=d.getChar(j);while(-1!=a&&"*"!=a);a=d.getChar(j);a=="*"&&d.ungetChar(j)}while(-1!=a&&"/"!=a)}else d.ungetChar(j)}else if(0==i&&"<"==a){a=d.getChar(j);if(-1==a)c=1;else{if("/"==a||b.isLetter(a)||"!"==a){c=1;d.ungetChar(j)}d.ungetChar(j)}}}return this.makeString(e,j.position)},parseCDATA:function(e,h){var c,a,d,j,i,s,r=this.cursor,t=this.page;c=r.position;a=0;d=false;j="";for(s=
false;!d;){i=t.getChar(r);switch(a){case 0:switch(i){case -1:d=true;break;case "'":if(e&&!s)if(""==j)j="'";else if("'"==j)j="";break;case '"':if(e&&!s)if(""==j)j='"';else if('"'==j)j="";break;case "\\":if(e)if(""!=j){i=t.getChar(r);if(-1==i)d=true;else i!="\\"&&i!=j&&t.ungetChar(r)}break;case "/":if(e)if(""==j){i=t.getChar(r);if(-1==i)d=true;else if("/"==i)s=true;else if("*"==i){do{do i=t.getChar(r);while(-1!=i&&"*"!=i);i=t.getChar(r);i=="*"&&t.ungetChar(r)}while(-1!=i&&"/"!=i)}else t.ungetChar(r)}break;
case "\n":s=false;break;case "<":if(e){if(""==j)a=1}else a=1}break;case 1:switch(i){case -1:d=true;break;case "/":a=!h||t.getText(r.position,r.position+h.length)===h&&!t.getText(r.position+h.length,r.position+h.length+1).match(/\w/)?2:0;break;case "!":i=t.getChar(r);if(-1==i)d=true;else if("-"==i){i=t.getChar(r);if(-1==i)d=true;else a="-"==i?3:0}else a=0;break;default:a=0}break;case 2:s=false;if(-1==i)d=true;else if(b.isLetter(i)){d=true;t.ungetChar(r);t.ungetChar(r);t.ungetChar(r)}else a=0;break;
case 3:s=false;if(-1==i)d=true;else if("-"==i){i=t.getChar(r);if(-1==i)d=true;else if("-"==i){i=t.getChar(r);if(-1==i)d=true;else if(">"==i)a=0;else{t.ungetChar(r);t.ungetChar(r)}}else t.ungetChar(r)}break;default:throw Error("unexpected "+a);}}return this.makeCData(c,r.position)},single_quote:function(e,h){var c=this.page;e.push(new m(c.getText(h[1],h[2]),"=",c.getText(h[4]+1,h[5]),"'"))},double_quote:function(e,h){var c=this.page;e.push(new m(c.getText(h[1],h[2]),"=",c.getText(h[5]+1,h[6]),'"'))},
standalone:function(e,h){e.push(new m(this.page.getText(h[1],h[2])))},naked:function(e,h){var c=this.page;e.push(new m(c.getText(h[1],h[2]),"=",c.getText(h[3],h[4])))}};return p},{requires:["./Cursor","./Page","../nodes/Text","../nodes/CData","../Utils","../nodes/Attribute","../nodes/Tag","../nodes/Comment"]});
KISSY.add("htmlparser/lexer/Page",function(k,n){function o(g){this.source=g;this.lineIndex=new n}o.prototype={getChar:function(g){var f=this.source,b=g.position;if(b>=f.length)return-1;var m=f.charAt(b);g.advance();if("\r"===m){m="\n";b=g.position;f.charAt(b)==="\n"&&g.advance()}"\n"===m&&this.lineIndex.add(g);return m},ungetChar:function(g){var f=this.source;g.retreat();var b=g.position,m=f.charAt(b);if(m==="\n"&&0!=b){m=f.charAt(b-1);"\r"===m&&g.retreat()}},getText:function(g,f){return this.source.slice(g,
f)},row:function(g){return this.lineIndex.row(g)},col:function(g){return this.lineIndex.col(g)}};return o},{requires:["./Index"]});KISSY.add("htmlparser/nodes/Attribute",function(){return function(k,n,o,g){this.nodeType=2;this.name=k;this.assignMent=n;this.value=o;this.quote=g}});
KISSY.add("htmlparser/nodes/CData",function(k,n){function o(){o.superclass.constructor.apply(this,arguments);this.nodeType=4;this.nodeName="#cdata"}k.extend(o,n,{writeHtml:function(g,f){var b=this.toHtml();if(!f||f.onCData(this)!==false)g.cdata(b)}});return o},{requires:["./Text"]});
KISSY.add("htmlparser/nodes/Comment",function(k,n){function o(){o.superclass.constructor.apply(this,arguments);this.nodeType=8;this.nodeName="#comment"}k.extend(o,n,{writeHtml:function(g,f){var b=this.toHtml();if(!f||f.onComment(this)!==false)g.comment(b)}});return o},{requires:["./Tag"]});
KISSY.add("htmlparser/nodes/Node",function(k){function n(o,g,f){this.parentNode=null;this.page=o;this.startPosition=g;this.endPosition=f;this.nextSibling=this.previousSibling=this.nodeName=null;if(k.Config.debug)this.toHtmlContent=this.toHtml()}n.prototype={toHtml:function(){if(this.page)return this.page.getText(this.startPosition,this.endPosition)},toString:function(){var o=[];o.push(this.nodeName+"  ["+this.startPosition+":"+this.endPosition+"]\n");o.push(this.toHtml());return o.join("")}};return n});
KISSY.add("htmlparser/nodes/Tag",function(k,n,o,g,f,b,m){function l(a,d,j,i){l.superclass.constructor.apply(this,arguments);this.childNodes=[];this.lastChild=this.firstChild=null;this.attributes=i||[];this.nodeType=1;i=this.attributes;if(i[0]){this.nodeName=i[0].name.toLowerCase();this.tagName=this.nodeName.replace(/\//,"");this.isEmptyXmlTag=!!m.$empty[this.nodeName];if(!this.isEmptyXmlTag)this.isEmptyXmlTag=/\/$/.test(this.nodeName);i.splice(0,1)}var s=i[i.length-1];if(s=!!(s&&/\/$/.test(s.name)))i.length-=
1;this.closed=this.isEmptyXmlTag=this.isEmptyXmlTag||s;this.closedEndPosition=this.closedStartPosition=-1;this.scanner=h[this.nodeName]||o}function q(a){var d=a.childNodes;a.firstChild=d[0];a.lastChild=d[d.length-1];if(d.length>=1){d[0].nextSibling=d[0].nextSibling=null;d[0].parentNode=a}if(d.length>1){for(var j=0;j<d.length-1;j++){d[j].nextSibling=d[j+1];d[j+1].previousSibling=d[j];d[j+1].parentNode=a}d[d.length-1].nextSibling=null}}function p(a,d){for(var j=0;j<a.length;j++)if(a[j].name==d)return a[j];
return null}var e=m.$cdata,h={textarea:f},c;for(c in e)h[c]=g;k.extend(l,n,{isEndTag:function(){return/^\//.test(this.nodeName)},appendChild:function(a){this.childNodes.push(a);q(this)},insertBefore:function(a){var d=a.parentNode.childNodes,j=k.indexOf(a,d);d.splice(j,0,this);q(a.parentNode)},removeChild:function(a){var d=a.parentNode.childNodes,j=k.indexOf(a,d);d.splice(j,1);q(a.parentNode)},getAttribute:function(a){return(a=p(this.attributes,a))&&a.value},setAttribute:function(a,d){var j=p(this.attributes,
a);if(j)j.value=d;else this.attributes.push(new b(a,"=",d,'"'))},removeAttribute:function(a){(a=p(this.attributes,a))&&this.attributes.splice(k.indexOf(a,this.attributes),1)},writeHtml:function(a,d){var j=this,i;i=j.tagName;if(d){if(!(i=d.onTagName(i)))return;j.tagName=i;i=d.onTag(j);if(i===false)return;if(i)j=i;if(j.nodeType!==1){j.writeHtml(a,d);return}if(!j.tagName){k.each(j.childNodes,function(u){u.writeHtml(a,d)});return}}a.openTag(j);for(var s=j.attributes,r=0;r<s.length;r++){var t=s[r];i=t.name;
if(d){if(!(i=d.onAttributeName(i)))continue;if(d.onAttribute(t)===false)continue}a.attribute(t,j)}a.openTagClose(j);if(!j.isEmptyXmlTag){k.each(j.childNodes,function(u){u.writeHtml(a,d)});a.closeTag(j)}}});return l},{requires:["./Node","../scanners/TagScanner","../scanners/QuoteCdataScanner","../scanners/TextareaScanner","./Attribute","../dtd"]});
KISSY.add("htmlparser/nodes/Text",function(k,n){function o(){o.superclass.constructor.apply(this,arguments);this.nodeType=3;this.nodeName="#text"}k.extend(o,n,{writeHtml:function(g,f){var b=this.toHtml();if(!f||f.onText(this)!==false)g.text(b)}});return o},{requires:["./Node"]});
KISSY.add("htmlparser/scanners/CdataScanner",function(){return{scan:function(k,n,o,g){o=n.parseCDATA(g,k.nodeName);g=n.getPosition();var f=n.nextNode();if(f)if(f.nodeType!=1||!(f.isEndTag()&&f.tagName==k.tagName))n.setPosition(g);k.closed=true;o&&k.appendChild(o);return k}}});KISSY.add("htmlparser/scanners/QuoteCdataScanner",function(k,n){return{scan:function(o,g,f){return n.scan(o,g,f,true)}}},{requires:["./CdataScanner"]});
KISSY.add("htmlparser/scanners/TagScanner",function(k,n){var o={scan:function(g,f,b,m){var l,q;if(g.isEmptyXmlTag)g.closed=true;else{do{if(l=f.nextNode())if(l.nodeType===1)if(l.isEndTag()&&l.tagName==g.tagName){g.closed=true;l=null}else if(m.fixByDtd&&!l.isEndTag()&&!this.canHasNodeAsChild(g,l)){f.setPosition(l.startPosition);l=null}else if(l.isEndTag()){if(l.isEndTag()){var p=-1;for(q=b.length-1;q>=0;q--){var e=b[q];if(e.tagName===l.tagName){p=q;break}else if(m.fixByDtd&&!this.canHasNodeAsChild(e,
l)){p=q;break}}if(p!=-1){g.closed=true;b[b.length-1].appendChild(g);for(q=b.length-1;q>p;q--){g=b[q];l=b[q-1];g.closed=true;l.appendChild(g)}g=b[p];b.length=p;l=null}}}else if(q=l.scanner)if(q===o)if(l.isEmptyXmlTag)g.appendChild(l);else{b.push(g);g=l}else{l=q.scan(l,f,b,m);g.appendChild(l)}else g.appendChild(l);else g.appendChild(l);if(l==null)if(b.length>0){l=b[b.length-1];if(l.nodeType==1)if(l.scanner===o){b.length-=1;g.closed=true;l.appendChild(g);g=l}else l=null;else l=null}}while(l);g.closed=
true}return g},canHasNodeAsChild:function(g,f){var b=f.nodeName;if(f.nodeType==3)b="#";return!!n[g.tagName][b]}};return o},{requires:["../dtd"]});KISSY.add("htmlparser/scanners/TextareaScanner",function(k,n){return{scan:function(o,g,f){return n.scan(o,g,f,false)}}},{requires:["./CdataScanner"]});
KISSY.add("htmlparser/writer/basic",function(){function k(){this.output=[]}k.prototype={append:function(){for(var n=this.output,o=arguments,g,f=0;f<o.length;f++){g=o[f];if(g.length>1)for(var b=0;b<g.length;b++)n.push(g.charAt(b));else n.push(g)}return this},openTag:function(n){this.append("<",n.tagName)},openTagClose:function(n){n.isEmptyXmlTag&&this.append(" ","/");this.append(">")},closeTag:function(n){this.append("</",n.tagName,">")},attribute:function(n){this.append(" ",n.name,'="',(n.value||
n.name).replace(/"/g,"&quote;"),'"')},text:function(n){this.append(n)},cdata:function(n){this.append(n)},comment:function(n){this.append(n)},getHtml:function(){return this.output.join("")}};return k});
KISSY.add("htmlparser/writer/beautify",function(k,n,o,g){function f(){f.superclass.constructor.apply(this,arguments);this.inPre=0;this.indentChar="\t";this.allowIndent=this.indentLevel=0;this.rules={};for(var b in k.merge(o.$nonBodyContent,o.$block,o.$listItem,o.$tableContent,{select:1,script:1,style:1}))this.setRules(b,{allowIndent:1,breakBeforeOpen:1,breakAfterOpen:1,breakBeforeClose:1,breakAfterClose:1});this.setRules("option",{breakBeforeOpen:1});this.setRules("optiongroup",{breakBeforeOpen:1});
this.setRules("br",{breakAfterOpen:1});this.setRules("title",{allowIndent:0,breakBeforeClose:0,breakAfterOpen:0});this.setRules("pre",{allowIndent:0})}k.extend(f,n,{indentation:function(){this.inPre||this.append(Array(this.indentLevel+1).join(this.indentChar));this.allowIndent=0},lineBreak:function(){var b=this.output;if(!this.inPre&&b.length){for(var m=b.length-1;m>=0;m--)if(!/[\r\n\t ]/.test(b[m]))break;b.length=m+1;this.append("\n")}this.allowIndent=1},setRules:function(b,m){this.rules[b]||(this.rules[b]=
{});k.mix(this.rules[b],m)},openTag:function(b){var m=this.rules[b.tagName]||{};if(this.allowIndent)this.indentation();else if(m.breakBeforeOpen){this.lineBreak();this.indentation()}f.superclass.openTag.apply(this,arguments)},openTagClose:function(b){var m=b.tagName,l=this.rules[m]||{};if(b.isEmptyXmlTag)this.append(" />");else{this.append(">");l.allowIndent&&this.indentLevel++}l.breakAfterOpen&&this.lineBreak();if(m==="pre")this.inPre=1},closeTag:function(b){var m=b.tagName,l=this.rules[m]||{};l.allowIndent&&
this.indentLevel--;if(this.allowIndent)this.indentation();else if(l.breakBeforeClose){this.lineBreak();this.indentation()}f.superclass.closeTag.apply(this,arguments);if(m==="pre")this.inPre=0;l.breakAfterClose&&this.lineBreak()},text:function(b){this.allowIndent&&this.indentation();this.inPre||(b=g.collapseWhitespace(b));this.append(b)},comment:function(b){this.allowIndent&&this.indentation();this.append(b)},cdata:function(b){this.allowIndent&&this.indentation();this.append(b)}});return f},{requires:["./basic",
"../dtd","../Utils"]});
KISSY.add("htmlparser/writer/filter",function(k){function n(){this.tagNames=[];this.attributeNames=[];this.tags=[];this.comments=[];this.texts=[];this.cdatas=[];this.attributes=[]}function o(f,b){for(var m=0;m<f.length;m++)k.each(f[m].value,function(l){b=b.replace(l[0],l[1])});return b}function g(f,b,m){for(var l=0;l<f.length;l++)if(f[l].value.apply(null,b)===false)return false;return m}n.prototype={addRules:function(f,b){b=b||10;for(var m in f){var l=this[m],q;a:{for(q=0;q<l.length;q++)if(l[q].priority>
b){q=q;break a}q=l.length}l.splice(q,0,{value:f[m],priority:b})}},onTagName:function(f){return o(this.tagNames,f)},onAttributeName:function(f){return o(this.attributeNames,f)},onText:function(f){return g(this.texts,[f.toHtml(),f],f)},onCData:function(f){return g(this.cdatas,[f.toHtml(),f],f)},onAttribute:function(f,b){return g(this.attributes,[b,f],b)},onComment:function(f){return g(this.comments,[f.toHtml(),f],f)},onNode:function(f){var b=f.nodeType;if(b===1)return this.onTag(f);else if(b===3)return this.onText(f.toHtml(),
f);else if(b===8)return this.onComment(f.toHtml(),f)},onTag:function(f){for(var b=["^",f.tagName,"$"],m=this.tags,l,q=0;q<b.length;q++)for(var p=b[q],e=0;e<m.length;e++){var h=m[e].value;if(h[p]){if((l=h[p](f))===false)return false;if(l&&l!=h)return this.onNode(l);if(!f.name)return f}}return f}};return n});
KISSY.add("htmlparser/writer/minify",function(k,n,o){function g(p){return p.replace(/"/g,"&quote;")}function f(p,e){var h=p.nodeName,c=e.name,a=e.value||"";if(/^on[a-z]+/.test(c))a=m(a).replace(/^javascript:[\s\xa0]*/i,"").replace(/[\s\xa0]*;$/,"");else if(c==="class")a=l(m(a));else if(/^(?:a|area|link|base)$/.test(h)&&c==="href"||h==="img"&&/^(?:src|longdesc|usemap)$/.test(c)||h==="object"&&/^(?:classid|codebase|data|usemap)$/.test(c)||h==="q"&&c==="cite"||h==="blockquote"&&c==="cite"||(h==="ins"||
h==="del")&&c==="cite"||h==="form"&&c==="action"||h==="input"&&(c==="src"||c==="usemap")||h==="head"&&c==="profile"||h==="script"&&(c==="src"||c==="for")||/^(?:a|area|object|button)$/.test(h)&&c==="tabindex"||h==="input"&&(c==="maxlength"||c==="tabindex")||h==="select"&&(c==="size"||c==="tabindex")||h==="textarea"&&/^(?:rows|cols|tabindex)$/.test(c)||h==="colgroup"&&c==="span"||h==="col"&&c==="span"||(h==="th"||h=="td")&&(c==="rowspan"||c==="colspan"))a=m(a);else if(c==="style")a=m(a).replace(/[\s\xa0]*;[\s\xa0]*$/,
"");return a}function b(){b.superclass.constructor.apply(this,arguments);this.inPre=0}var m=k.trim,l=o.collapseWhitespace,q=RegExp("^(?:class|id|style|title|lang|dir|on(?:focus|blur|change|click|dblclick|mouse(?:down|up|over|move|out)|key(?:press|down|up)))$");k.extend(b,n,{comment:function(p){if(/\[if[^\]]+\]/.test(p)){p=p.replace(/^(\[[^\]]+\]>)[\s\xa0]*/,"$1").replace(/[\s\xa0]*(<!\[endif\])$/,"$1");b.superclass.comment.call(this,p)}},openTag:function(p){if(p.tagName=="pre")this.inPre=1;b.superclass.openTag.apply(this,
arguments)},closeTag:function(p){if(p.tagName=="pre")this.inPre=0;b.superclass.closeTag.apply(this,arguments)},cdata:function(p){p=m(p).replace(/^(?:[\s\xa0]*\/\*[\s\xa0]*<!\[CDATA\[[\s\xa0]*\*\/|[\s\xa0]*\/\/[\s\xa0]*<!\[CDATA\[.*)/,"").replace(/(?:\/\*[\s\xa0]*\]\]>[\s\xa0]*\*\/|\/\/[\s\xa0]*\]\]>)[\s\xa0]*$/,"");b.superclass.cdata.call(this,p)},attribute:function(p,e){var h=p.name,c=p.value||"",a;a=p.name;a=m(p.value||"")?0:e==="input"&&a==="value"||q.test(a);if(!(a=a)){a=e.nodeName;var d=p.name,
j=p.value||"";j=m(j.toLowerCase());a=a==="script"&&d==="language"&&j==="javascript"||a==="form"&&d==="method"&&j==="get"||a==="input"&&d==="type"&&j==="text"||a==="script"&&d==="type"&&j==="text/javascript"||a==="style"&&d==="type"&&j==="text/css"||a==="area"&&d==="shape"&&j==="rect"}if(!a)if(/^(?:checked|disabled|selected|readonly|defer|multiple|nohref|noshape|nowrap|noresize|compact|ismap)$/i.test(h))this.append(" ",h);else/^[a-zA-Z0-9-._:]+$/.test(c)?this.append(" ",h,"=",g(f(e,p))):this.append(" ",
h,'="',g(f(e,p)),'"')},text:function(p){this.inPre||this.append(l(p))}});return b},{requires:["./basic","../Utils"]});KISSY.add("htmlparser",function(k,n,o,g,f,b,m){return{Lexer:n,Parser:o,BasicWriter:g,BeautifyWriter:f,MinifyWriter:b,Filter:m}},{requires:["htmlparser/lexer/Lexer","htmlparser/Parser","htmlparser/writer/basic","htmlparser/writer/beautify","htmlparser/writer/minify","htmlparser/writer/filter"]});
