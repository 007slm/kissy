/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Oct 17 17:51
*/
KISSY.add("event/base",function(a,c,d,r){function m(e,g,k){if((k=a.trim(k))&&k.indexOf(s)>0){var q=j(arguments);o(k.split(/\s+/),function(u){var n=[].concat(q);n.splice(0,3,g,u);v[e].apply(v,n)});return true}return 0}function i(e){return e&&e.nodeType!==3&&e.nodeType!==8}function l(e,g,k,q,u){var n=B[g]||{};if(!q.length&&(!n.setup||n.setup.call(e)===false))f(e,g,k);n.add&&n.add.call(e,u)}var h=document,b=c._nodeName,j=a.makeArray,f=h.addEventListener?function(e,g,k,q){e.addEventListener&&e.addEventListener(g,
k,!!q)}:function(e,g,k){e.attachEvent&&e.attachEvent("on"+g,k)},p=h.removeEventListener?function(e,g,k,q){e.removeEventListener&&e.removeEventListener(g,k,!!q)}:function(e,g,k){e.detachEvent&&e.detachEvent("on"+g,k)},s=" ",o=a.each,t="",x="trigger-none-"+a.now(),B={},F="ksEventTargetId"+a.now(),v={_clone:function(e,g){if(!(g.nodeType!==c.ELEMENT_NODE||!v._hasData(e))){var k=v._data(e).events;o(k,function(q,u){o(q,function(n){v.on(g,u,n.fn,n.scope,n.data)})})}},_hasData:function(e){return c.hasData(e,
F)},_data:function(){var e=j(arguments);e.splice(1,0,F);return c.data.apply(c,e)},_removeData:function(){var e=j(arguments);e.splice(1,0,F);return c.removeData.apply(c,e)},special:B,__add:function(e,g,k,q,u,n){var w;if(!(!g||!a.isFunction(q)||e&&!i(g))){(w=v._data(g))||v._data(g,w={});var y=w.events=w.events||{};y=y[k]=y[k]||[];q={fn:q,scope:u,data:n};var A=w.handler;if(!A){A=w.handler=function(z,C){if(!(z&&z.type==t)){var D=A.target;if(!z||!z.fixed)z=new d(D,z);a.isPlainObject(C)&&a.mix(z,C);return v._handle(D,
z)}};A.target=g}if(e){l(g,k,A,y,q);g=null}y.push(q)}},add:function(e,g,k,q,u){if(m("add",e,g,k,q,u))return e;c.query(e).each(function(n){v.__add(true,n,g,k,q,u)});return e},__getListeners:function(e,g){return(v.__getEvents(e)||{})[g]||[]},__getEvents:function(e){return(e=v._data(e))&&e.events},__remove:function(e,g,k,q,u,n){if(!(!g||e&&!i(g))){var w=v._data(g),y=w&&w.events,A,z,C,D,G,I=e&&B[k]||{};if(y)if(k===r)for(k in y)v.remove.call(v,g,k);else{u=u||g;if(A=y[k]){z=A.length;if(q&&z){D=C=0;for(G=
[];C<z;++C){var J=false,E=A[C],K=E.scope||g;if(q!==E.fn||u!==K){G[D++]=E;J=true}else if(n!==H){var H=E.data;if(!n&&H||H&&!n){G[D++]=E;J=true}else if(n&&H)if(n.equals&&H.equals)if(!H.equals(n)){G[D++]=E;J=true}}!J&&I.remove&&I.remove.call(g,E)}y[k]=G;z=G.length}if(q===r||z===0){if(e&&(!I.tearDown||I.tearDown.call(g)===false))p(g,k,w.handler);delete y[k]}}if(a.isEmptyObject(y)){w.handler.target=null;delete w.handler;delete w.events;v._removeData(g)}}}},remove:function(e,g,k,q,u){if(m("remove",e,g,k,
q))return e;c.query(e).each(function(n){v.__remove(true,n,g,k,q,u)});return e},_handle:function(e,g){for(var k=v.__getListeners(e,g.type).slice(0),q,u,n=0,w=k.length;n<w;++n){q=k[n];q=q.fn.call(q.scope||e,g,q.data);if(q!==r){if(u!==false)u=q;q===false&&g.halt()}if(g.isImmediatePropagationStopped)break}return u},fire:function(e,g,k,q){if(!m("fire",e,g,k,q)){k=k||{};k.type=g;c.query(e).each(function(u){var n=k;if(i(u)){var w=new d(u,r,g);a.mix(w,n);q&&w.halt();n=u;var y="on"+g;do{w.currentTarget=n;
v._handle(n,w);n[y]&&n[y].call(n)===false&&w.preventDefault();n=n.parentNode||n.ownerDocument||n===u.ownerDocument&&window}while(n&&!w.isPropagationStopped);if(!w.isDefaultPrevented)if(!(g==="click"&&b(u,"a"))){var A;try{if(y&&u[g]){if(A=u[y])u[y]=null;t=g;u[g]()}}catch(z){}if(A)u[y]=A;t=x}}})}},__batchForType:m};v.on=v.add;v.detach=v.remove;return v},{requires:["dom","event/object"]});
KISSY.add("event/change",function(a,c,d,r){a=document.documentMode;if(c.ie&&(c.ie<9||a&&a<9)){var m=/^(?:textarea|input|select)$/i,i=function(f){f=f.type;return f=="checkbox"||f=="radio"};d.special.change={setup:function(){if(m.test(this.nodeName))if(i(this)){d.on(this,"propertychange",l);d.on(this,"click",h)}else return false;else d.on(this,"beforeactivate",b)},tearDown:function(){if(m.test(this.nodeName))if(i(this)){d.remove(this,"propertychange",l);d.remove(this,"click",h)}else return false;else{d.remove(this,
"beforeactivate",b);r.query("textarea,input,select",this).each(function(f){if(f.__changeHandler){f.__changeHandler=0;d.remove(f,"change",j)}})}}};var l=function(f){if(f.originalEvent.propertyName=="checked")this.__changed=1},h=function(f){if(this.__changed){this.__changed=0;d.fire(this,"change",f)}},b=function(f){f=f.target;if(m.test(f.nodeName)&&!f.__changeHandler){f.__changeHandler=1;d.on(f,"change",j)}},j=function(f){if(!i(this)){var p;if(p=this.parentNode)d.fire(p,"change",f)}}}},{requires:["ua",
"./base","dom"]});
KISSY.add("event/delegate",function(a,c,d){function r(b){return b.fn===undefined&&b.selector===undefined?true:b.fn===undefined?this.selector==b.selector:this.fn==b.fn&&this.selector==b.selector&&this.scope==b.scope}function m(b,j){var f=c.closest(b.target,[j.selector],this),p;if(f)for(var s=0;s<f.length;s++){b.currentTarget=f[s];var o=j.fn.call(j.scope||this,b);if(o===false||b.isPropagationStopped||b.isImmediatePropagationStopped){if(o===false)p=o;if(b.isPropagationStopped||b.isImmediatePropagationStopped)break}}return p}function i(b,
j){var f=b.target,p=b.relatedTarget;b.type=j.preType;if(f=c.closest(f,j.selector,this))if(f!==p&&(!p||!c.contains(f,p))){b.currentTarget=f;return j.fn.call(j.scope||this,b)}}var l=d.__batchForType,h={focus:{type:"focusin"},blur:{type:"focusout"},mouseenter:{type:"mouseover",handler:i},mouseleave:{type:"mouseout",handler:i}};a.mix(d,{delegate:function(b,j,f,p,s){if(l("delegate",b,j,f,p,s))return b;c.query(b).each(function(o){var t=j,x=m;if(h[j]){j=h[t].type;x=h[t].handler||x}d.on(o,j,x,o,{fn:p,selector:f,
preType:t,scope:s,equals:r})});return b},undelegate:function(b,j,f,p,s){if(l("undelegate",b,j,f,p,s))return b;c.query(b).each(function(o){var t=j,x=m;if(h[j]){j=h[t].type;x=h[t].handler||x}d.remove(o,j,x,o,{fn:p,selector:f,preType:t,scope:s,equals:r})});return b}});return d},{requires:["dom","./base"]});
KISSY.add("event/focusin",function(a,c,d){c.ie||a.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(r){function m(l){return d.fire(l.target,r.name)}var i=0;d.special[r.name]={setup:function(){i++===0&&document.addEventListener(r.fix,m,true)},tearDown:function(){--i===0&&document.removeEventListener(r.fix,m,true)}}});return d},{requires:["ua","./base"]});
KISSY.add("event/hashchange",function(a,c,d,r){r=l||r.ie;if(!("onhashchange"in window)||r<8){l=document;var m=window,i="<html><title>"+(l.title||"")+" - {hash}</title><body>{hash}</body></html>",l=l.documentMode,h=function(){return"#"+location.href.replace(/^[^#]*#?(.*)$/,"$1")},b,j=h(),f=function(){var x=h();if(x!==j){p(x);j=x}b=setTimeout(f,50)},p=r<8?function(x){x=a.substitute(i,{hash:x});var B=t.contentWindow.document;try{B.open();B.write(x);B.close();return true}catch(F){return false}}:function(){c.fire(m,
"hashchange")},s=function(){b||f()},o=function(){b&&clearTimeout(b);b=null},t;if(r<8){s=function(){if(!t){t=d.create('<iframe style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');d.prepend(t,document.documentElement);c.add(t,"load",function(){c.remove(t,"load");p(h());c.add(t,"load",x);f()});var x=function(){var B=a.trim(d.html(t.contentWindow.document.body)),F=h();if(B!=F)j=location.hash=B;c.fire(m,"hashchange")}}};o=function(){b&&clearTimeout(b);b=null;c.detach(t);d.remove(t);
t=null}}c.special.hashchange={setup:function(){this===m&&s()},tearDown:function(){this===m&&o()}}}},{requires:["./base","dom","ua"]});
KISSY.add("event/keycodes",function(){var a={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,
WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,
MAC_FF_META:224,WIN_IME:229};a.isTextModifyingKeyEvent=function(c){if(c.altKey&&!c.ctrlKey||c.metaKey||c.keyCode>=a.F1&&c.keyCode<=a.F12)return false;switch(c.keyCode){case a.ALT:case a.CAPS_LOCK:case a.CONTEXT_MENU:case a.CTRL:case a.DOWN:case a.END:case a.ESC:case a.HOME:case a.INSERT:case a.LEFT:case a.MAC_FF_META:case a.META:case a.NUMLOCK:case a.NUM_CENTER:case a.PAGE_DOWN:case a.PAGE_UP:case a.PAUSE:case a.PHANTOM:case a.PRINT_SCREEN:case a.RIGHT:case a.SHIFT:case a.UP:case a.WIN_KEY:case a.WIN_KEY_RIGHT:return false;
default:return true}};a.isCharacterKey=function(c){if(c>=a.ZERO&&c<=a.NINE)return true;if(c>=a.NUM_ZERO&&c<=a.NUM_MULTIPLY)return true;if(c>=a.A&&c<=a.Z)return true;if(goog.userAgent.WEBKIT&&c==0)return true;switch(c){case a.SPACE:case a.QUESTION_MARK:case a.NUM_PLUS:case a.NUM_MINUS:case a.NUM_PERIOD:case a.NUM_DIVISION:case a.SEMICOLON:case a.DASH:case a.EQUALS:case a.COMMA:case a.PERIOD:case a.SLASH:case a.APOSTROPHE:case a.SINGLE_QUOTE:case a.OPEN_SQUARE_BRACKET:case a.BACKSLASH:case a.CLOSE_SQUARE_BRACKET:return true;
default:return false}};return a});KISSY.add("event/mouseenter",function(a,c,d,r){r.ie||a.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(m){function i(l){var h=l.relatedTarget;l.type=m.name;try{if(!(h&&h!==document&&!h.parentNode))if(h!==this&&(!h||!d.contains(this,h)))c._handle(this,l)}catch(b){}}c.special[m.name]={setup:function(){c.add(this,m.fix,i)},tearDown:function(){c.remove(this,m.fix,i)}}});return c},{requires:["./base","dom","ua"]});
KISSY.add("event/object",function(a,c){function d(i,l,h){this.currentTarget=i;this.originalEvent=l||{};if(l){this.type=l.type;this._fix()}else{this.type=h;this.target=i}this.currentTarget=i;this.fixed=true}var r=document,m="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
a.augment(d,{_fix:function(){var i=this.originalEvent,l=m.length,h,b=this.currentTarget;for(b=b.nodeType===9?b:b.ownerDocument||r;l;){h=m[--l];this[h]=i[h]}if(!this.target)this.target=this.srcElement||r;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===c&&this.clientX!==c){i=b.documentElement;l=b.body;this.pageX=this.clientX+(i&&i.scrollLeft||l&&l.scrollLeft||
0)-(i&&i.clientLeft||l&&l.clientLeft||0);this.pageY=this.clientY+(i&&i.scrollTop||l&&l.scrollTop||0)-(i&&i.clientTop||l&&l.clientTop||0)}if(this.which===c)this.which=this.charCode===c?this.keyCode:this.charCode;if(this.metaKey===c)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==c)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var i=this.originalEvent;if(i.preventDefault)i.preventDefault();else i.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var i=
this.originalEvent;if(i.stopPropagation)i.stopPropagation();else i.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=true;this.stopPropagation()},halt:function(i){i?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return d});
KISSY.add("event/submit",function(a,c,d,r){a=document.documentMode;if(c.ie&&(c.ie<9||a&&a<9)){var m=r._nodeName;d.special.submit={setup:function(){if(m(this,"form"))return false;d.on(this,"click keypress",i)},tearDown:function(){if(m(this,"form"))return false;d.remove(this,"click keypress",i);r.query("form",this).each(function(h){if(h.__submit__fix){h.__submit__fix=0;d.remove(h,"submit",l)}})}};var i=function(h){h=h.target;if((h=m(h,"input")||m(h,"button")?h.form:null)&&!h.__submit__fix){h.__submit__fix=
1;d.on(h,"submit",l)}},l=function(h){this.parentNode&&d.fire(this.parentNode,"submit",h)}}},{requires:["ua","./base","dom"]});
KISSY.add("event/target",function(a,c,d){function r(b){b[l]=b[l]||{};return b[l]}function m(b){b[h]=b[h]||{};return b[h]}function i(b){return function(j,f,p){var s=this;a.each(a.trim(j).split(/\s+/),function(o){c["__"+b](false,s,o,f,p)});return s}}var l="__~ks_publish",h="__~ks_bubble_targets";return{fire:function(b,j){var f,p;if(j instanceof d){j.currentTarget=this;p=j}else{f=new d(this,undefined,b);a.isPlainObject(j)&&a.mix(f,j);p=f}f=c._handle(this,p);var s;if(s=!p.isPropagationStopped){s=r(this);
s=s[b]&&s[b].bubbles||s["*"]&&s["*"].bubbles}if(s){p=this.bubble(b,p);if(p===false)f=p}return f},publish:function(b,j){r(this)[b]=j},bubble:function(b,j){var f,p=m(this);a.each(p,function(s){s=s.fire(b,j);if(f!==false)f=s});return f},addTarget:function(b){m(this)[a.stamp(b)]=b},removeTarget:function(b){delete m(this)[a.stamp(b)]},on:i("add"),detach:i("remove")}},{requires:["./base","./object"]});
KISSY.add("event/valuechange",function(a,c,d){function r(o){d.removeData(o,f);if(d.hasData(o,p)){var t=d.data(o,p);clearTimeout(t);d.removeData(o,p)}}function m(o){r(o.target)}function i(o){d.hasData(o,p)||d.data(o,p,setTimeout(function(){var t=o.value,x=d.data(o,f);if(t!==x){c.fire(o,b,{prevVal:x,newVal:t},true);d.data(o,f,t)}d.data(o,p,setTimeout(arguments.callee,s))},s))}function l(o){var t=o.target;o.type=="focus"&&d.data(t,f,t.value);i(t)}function h(o){r(o);c.remove(o,"blur",m);c.remove(o,"mousedown keyup keydown focus",
l)}var b="valuechange",j=d._nodeName,f="event/valuechange/history",p="event/valuechange/poll",s=50;c.special[b]={setup:function(){if(j(this,"input")||j(this,"textarea")){h(this);c.on(this,"blur",m);c.on(this,"mousedown keyup keydown focus",l)}},tearDown:function(){h(this)}};return c},{requires:["./base","dom"]});
KISSY.add("event",function(a,c,d,r,m){d.KeyCodes=c;d.Target=r;d.Object=m;return d},{requires:["event/keycodes","event/base","event/target","event/object","event/focusin","event/hashchange","event/valuechange","event/delegate","event/mouseenter","event/submit","event/change"]});
