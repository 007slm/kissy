/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Jul 15 14:17
*/
KISSY.add("event/base",function(m,c,n,j){function p(a,d,l){if((l=m.trim(l))&&l.indexOf(r)>0){var q=m.makeArray(arguments);m.each(l.split(r),function(k){var h=m.clone(q);h.splice(0,3,d,k);b[a].apply(b,h)});return true}return j}function e(a){return a&&a.nodeType!==3&&a.nodeType!==8}function o(a,d,l,q,k){var h=b.special[d]||{};if(!q.length&&(!h.setup||h.setup.call(a)===false))i(a,d,l);h.add&&h.add.call(a,k)}var f=document,i=f.addEventListener?function(a,d,l,q){a.addEventListener&&a.addEventListener(d,
l,!!q)}:function(a,d,l){a.attachEvent&&a.attachEvent("on"+d,l)},u=f.removeEventListener?function(a,d,l,q){a.removeEventListener&&a.removeEventListener(d,l,!!q)}:function(a,d,l){a.detachEvent&&a.detachEvent("on"+d,l)},r=" ",t="",g="trigger-none-"+m.now(),z="ksEventTargetId"+m.now(),b={_data:function(){var a=m.makeArray(arguments);a.splice(1,0,z);return c.data.apply(c,a)},_removeData:function(){var a=m.makeArray(arguments);a.splice(1,0,z);return c.removeData.apply(c,a)},special:{},add:function(a,d,
l,q,k){if(p("add",a,d,l,q,k))return a;c.query(a).each(function(h){var w=!h.isCustomEventTarget,s;if(!(!h||!d||!m.isFunction(l)||w&&!e(h))){(s=b._data(h))||b._data(h,s={});var v=s.events=s.events||{};v=v[d]=v[d]||[];var A={fn:l,scope:q||h,data:k},x=s.handler;if(!x){x=s.handler=function(y,B){if(!(y&&y.type==t)){var D=x.target;if(!y||!y.fixed)y=new n(D,y);m.isPlainObject(B)&&m.mix(y,B);return b._handle(D,y)}};x.target=h}if(w){o(h,d,x,v,A);h=null}v.push(A)}});return a},__getListeners:function(a,d){return(b.__getEvents(a)||
{})[d]||[]},__getEvents:function(a){return(a=b._data(a))&&a.events},remove:function(a,d,l,q,k){if(p("remove",a,d,l,q))return a;c.query(a).each(function(h){var w=b._data(h),s=w&&w.events,v,A,x,y,B,D=!h.isCustomEventTarget,F=D&&b.special[d]||{};if(!(!h||!D&&!e(h)||!s))if(d===j)for(d in s)b.remove(h,d);else{q=q||h;if(v=s[d]){A=v.length;if(m.isFunction(l)&&A){y=x=0;for(B=[];x<A;++x){var G=false,C=v[x];if(l!==C.fn||q!==C.scope){B[y++]=C;G=true}else if(k!==E){var E=C.data;if(!k&&E||E&&!k){B[y++]=C;G=true}else if(k&&
E)if(!k.equals||!E.equals)m.error("no equals in data");else if(!E.equals(k)){B[y++]=C;G=true}}!G&&F.remove&&F.remove.call(h,C)}s[d]=B;A=B.length}if(l===j||A===0){if(D&&(!F.tearDown||F.tearDown.call(h)===false))u(h,d,w.handler);delete s[d]}}if(m.isEmptyObject(s)){w.handler.target=null;delete w.handler;delete w.events;b._removeData(h)}}});return a},_handle:function(a,d){for(var l=b.__getListeners(a,d.type).slice(0),q,k,h=0,w=l.length;h<w;++h){q=l[h];q=q.fn.call(q.scope,d,q.data);if(q!==j){if(k!==false)k=
q;q===false&&d.halt()}if(d.isImmediatePropagationStopped)break}return k},fire:function(a,d,l){if(!p("fire",a,d,l)){var q;c.query(a).each(function(k){var h=!k.isCustomEventTarget;l=l||{};l.type=d;if(h){h=l;var w;if(e(k)){h=new n(k,h);var s=h.target=k,v="on"+d;do{var A=(b._data(s)||{}).handler;h.currentTarget=s;A&&A.call(s,h);if(s[v]&&s[v].call(s)===false){w=false;h.preventDefault()}s=s.parentNode||s.ownerDocument||s===k.ownerDocument&&window}while(s&&!h.isPropagationStopped);if(!h.isDefaultPrevented)if(!(d===
"click"&&k.nodeName.toLowerCase()=="a")){var x;try{if(v&&k[d]){if(x=k[v])k[v]=null;t=d;k[d]()}}catch(y){}if(x)k[v]=x;t=g}}k=w;if(k!==j)q=k}else if((k=b._data(k))&&m.isFunction(k.handler))q=k.handler(j,l)});return q}},_batchForType:p,_simpleAdd:i,_simpleRemove:u};b.on=b.add;b.detach=b.remove;return b},{requires:["dom","event/object"]});
KISSY.add("event/delegate",function(m,c,n){function j(f){return f.fn===undefined&&f.selector===undefined?true:f.fn===undefined?this.selector==f.selector:this.fn==f.fn&&this.selector==f.selector&&this.scope==f.scope}function p(f,i){var u,r=c.closest(f.target,[i.selector],this);if(r)for(var t=0;t<r.length;t++){f.currentTarget=r[t];var g=i.fn.call(i.scope||this,f);if(g===false||f.isPropagationStopped||f.isImmediatePropagationStopped){if(g===false)u=g;if(f.isPropagationStopped||f.isImmediatePropagationStopped)break}}return u}
var e=n._batchForType,o={focus:"focusin",blur:"focusout"};m.mix(n,{delegate:function(f,i,u,r,t){if(e("delegate",f,i,u,r,t))return f;c.query(f).each(function(g){if(!g.isCustomEventTarget){i=o[i]||i;n.on(g,i,p,g,{fn:r,selector:u,scope:t,equals:j})}});return f},undelegate:function(f,i,u,r,t){if(e("undelegate",f,i,u,r,t))return f;c.query(f).each(function(g){if(!g.isCustomEventTarget){i=o[i]||i;n.remove(g,i,p,g,{fn:r,selector:u,scope:t,equals:j})}});return f}});return n},{requires:["dom","./base"]});
KISSY.add("event/focusin",function(m,c,n){c.ie||m.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(j){function p(o){return n.fire(o.target,j.name)}var e=0;n.special[j.name]={setup:function(){e++===0&&document.addEventListener(j.fix,p,true)},tearDown:function(){--e===0&&document.removeEventListener(j.fix,p,true)}}});return n},{requires:["ua","./base"]});
KISSY.add("event/hashchange",function(m,c,n,j){j=document.documentMode||j.ie;if(!("onhashchange"in window)||j<8){var p=function(){return"#"+location.href.replace(/^[^#]*#?(.*)$/,"$1")},e=function(){o()},o=function(){var g=p();if(g!==t){f(g);t=g}u=setTimeout(o,50)},f=function(g){i(g)},i=function(g){m.log("hash changed : "+g);for(g=0;g<r.length;g++)c._handle(r[g],{type:"hashchange"})},u,r=[],t=p();c.special.hashchange={setup:function(){-1===m.indexOf(this,r)&&r.push(this);u||e()},tearDown:function(){var g=
m.indexOf(this,r);g>=0&&r.splice(g,1);if(r.length===0){u&&clearTimeout(u);u=null}}};j<8&&function(){var g;e=function(){if(!g){g=n.create('<iframe style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');n.prepend(g,document.documentElement);c.add(g,"load",function(){c.remove(g,"load");f(p());c.add(g,"load",z);o()});var z=function(){var b=m.trim(g.contentWindow.document.body.innerHTML),a=p();if(b!=a)t=location.hash=b;i(b)}}};f=function(z){z="<html><body>"+z+"</body></html>";var b=
g.contentWindow.document;try{b.open();b.write(z);b.close();return true}catch(a){return false}}}()}},{requires:["./base","dom","ua"]});
KISSY.add("event/mouseenter",function(m,c,n,j){j.ie||m.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(p){function e(o){var f=this,i=o.relatedTarget;o.type=p.name;try{if(!(i&&i!==document&&!i.parentNode)){i=n.closest(i,function(r){return r==f});i!==f&&c._handle(f,o)}}catch(u){m.log("withinElement :"+u)}}c.special[p.name]={setup:function(){c.add(this,p.fix,e)},tearDown:function(){c.remove(this,p.fix,e)}}});return c},{requires:["./base","dom","ua"]});
KISSY.add("event/object",function(m,c){function n(e,o,f){this.currentTarget=e;this.originalEvent=o||{};if(o){this.type=o.type;this._fix()}else{this.type=f;this.target=e}this.currentTarget=e;this.fixed=true}var j=document,p="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
m.augment(n,{_fix:function(){var e=this.originalEvent,o=p.length,f,i=this.currentTarget;for(i=i.nodeType===9?i:i.ownerDocument||j;o;){f=p[--o];this[f]=e[f]}if(!this.target)this.target=this.srcElement||j;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===c&&this.clientX!==c){e=i.documentElement;o=i.body;this.pageX=this.clientX+(e&&e.scrollLeft||o&&o.scrollLeft||
0)-(e&&e.clientLeft||o&&o.clientLeft||0);this.pageY=this.clientY+(e&&e.scrollTop||o&&o.scrollTop||0)-(e&&e.clientTop||o&&o.clientTop||0)}if(this.which===c)this.which=this.charCode!==c?this.charCode:this.keyCode;if(this.metaKey===c)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==c)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var e=this.originalEvent;if(e.preventDefault)e.preventDefault();else e.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var e=
this.originalEvent;if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var e=this.originalEvent;e.stopImmediatePropagation?e.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(e){e?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return n});
KISSY.add("event/target",function(m,c){return{isCustomEventTarget:true,fire:function(n,j){return c.fire(this,n,j)},on:function(n,j,p){c.add(this,n,j,p);return this},detach:function(n,j,p){c.remove(this,n,j,p);return this}}},{requires:["./base","dom"]});
KISSY.add("event/valuechange",function(m,c,n){function j(b){var a=n.data(b,r);if(!a){a=+new Date;n.data(b,r,a)}return a}function p(b){b=j(b);delete t[b];if(g[b]){clearTimeout(g[b]);delete g[b]}}function e(b){p(b.target)}function o(b){var a=j(b);g[a]||(g[a]=setTimeout(function(){var d=b.value;if(d!==t[a]){c._handle(b,{type:u,prevVal:t[a],newVal:d});t[a]=d}g[a]=setTimeout(arguments.callee,z)},z))}function f(b){var a=b.target;if(b.type=="focus"){b=j(a);t[b]=a.value}o(a)}function i(b){p(b);c.remove(b,
"blur",e);c.remove(b,"mousedown keyup keydown focus",f);n.removeData(b,r)}var u="valueChange",r="event/valuechange",t={},g={},z=50;c.special[u]={fix:false,setup:function(){var b=this.nodeName.toLowerCase();if("input"==b||"textarea"==b){i(this);c.on(this,"blur",e);c.on(this,"mousedown keyup keydown focus",f)}},tearDown:function(){i(this)}};return c},{requires:["./base","dom"]});
KISSY.add("event",function(m,c,n,j){c.Target=n;c.Object=j;return c},{requires:["event/base","event/target","event/object","event/focusin","event/hashchange","event/valuechange","event/delegate","event/mouseenter"]});
