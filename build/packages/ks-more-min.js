/*
Copyright 2010, KISSY UI Library v1.1.2dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("json",function(g){function w(e){return e<10?"0"+e:e}function q(e){m.lastIndex=0;return m.test(e)?'"'+e.replace(m,function(k){var o=n[k];return typeof o==="string"?o:"\\u"+("0000"+k.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function u(e,k){var o,v,x=i,r,a=k[e];if(a&&typeof a==="object"&&typeof a.toJSON==="function")a=a.toJSON(e);if(typeof l==="function")a=l.call(k,e,a);switch(typeof a){case "string":return q(a);case "number":return isFinite(a)?String(a):"null";case "boolean":case "null":return String(a);
case "object":if(!a)return"null";i+=d;r=[];if(Object.prototype.toString.apply(a)==="[object Array]"){v=a.length;for(e=0;e<v;e+=1)r[e]=u(e,a)||"null";k=r.length===0?"[]":i?"[\n"+i+r.join(",\n"+i)+"\n"+x+"]":"["+r.join(",")+"]";i=x;return k}if(l&&typeof l==="object"){v=l.length;for(e=0;e<v;e+=1){o=l[e];if(typeof o==="string")if(k=u(o,a))r.push(q(o)+(i?": ":":")+k)}}else for(o in a)if(Object.hasOwnProperty.call(a,o))if(k=u(o,a))r.push(q(o)+(i?": ":":")+k);k=r.length===0?"{}":i?"{\n"+i+r.join(",\n"+i)+
"\n"+x+"}":"{"+r.join(",")+"}";i=x;return k}}g=g.JSON=window.JSON||{};if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+w(this.getUTCMonth()+1)+"-"+w(this.getUTCDate())+"T"+w(this.getUTCHours())+":"+w(this.getUTCMinutes())+":"+w(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var s=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
m=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,d,n={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;if(typeof g.stringify!=="function")g.stringify=function(e,k,o){var v;d=i="";if(typeof o==="number")for(v=0;v<o;v+=1)d+=" ";else if(typeof o==="string")d=o;if((l=k)&&typeof k!=="function"&&(typeof k!=="object"||typeof k.length!=="number"))throw new Error("JSON.stringify");return u("",
{"":e})};if(typeof g.parse!=="function")g.parse=function(e,k){function o(v,x){var r,a,c=v[x];if(c&&typeof c==="object")for(r in c)if(Object.hasOwnProperty.call(c,r)){a=o(c,r);if(a!==undefined)c[r]=a;else delete c[r]}return k.call(v,x,c)}e=String(e);s.lastIndex=0;if(s.test(e))e=e.replace(s,function(v){return"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=eval("("+e+")");return typeof k==="function"?o({"":e},""):e}throw new SyntaxError("JSON.parse");}});
(function(){function g(a,c,h,b,f,j){f=0;for(var t=b.length;f<t;f++){var p=b[f];if(p){p=p[a];for(var y=false;p;){if(p.sizcache===h){y=b[p.sizset];break}if(p.nodeType===1&&!j){p.sizcache=h;p.sizset=f}if(p.nodeName.toLowerCase()===c){y=p;break}p=p[a]}b[f]=y}}}function w(a,c,h,b,f,j){f=0;for(var t=b.length;f<t;f++){var p=b[f];if(p){p=p[a];for(var y=false;p;){if(p.sizcache===h){y=b[p.sizset];break}if(p.nodeType===1){if(!j){p.sizcache=h;p.sizset=f}if(typeof c!=="string"){if(p===c){y=true;break}}else if(d.filter(c,
[p]).length>0){y=p;break}}p=p[a]}b[f]=y}}}var q=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,u=0,s=Object.prototype.toString,m=false,i=true;[0,0].sort(function(){i=false;return 0});var d=function(a,c,h,b){h=h||[];var f=c=c||document;if(c.nodeType!==1&&c.nodeType!==9)return[];if(!a||typeof a!=="string")return h;var j=[],t,p,y,C,z=true,A=d.isXML(c),B=a,D;do{q.exec("");if(t=q.exec(B)){B=t[3];j.push(t[1]);if(t[2]){C=
t[3];break}}}while(t);if(j.length>1&&l.exec(a))if(j.length===2&&n.relative[j[0]])p=r(j[0]+j[1],c);else for(p=n.relative[j[0]]?[c]:d(j.shift(),c);j.length;){a=j.shift();if(n.relative[a])a+=j.shift();p=r(a,p)}else{if(!b&&j.length>1&&c.nodeType===9&&!A&&n.match.ID.test(j[0])&&!n.match.ID.test(j[j.length-1])){t=d.find(j.shift(),c,A);c=t.expr?d.filter(t.expr,t.set)[0]:t.set[0]}if(c){t=b?{expr:j.pop(),set:o(b)}:d.find(j.pop(),j.length===1&&(j[0]==="~"||j[0]==="+")&&c.parentNode?c.parentNode:c,A);p=t.expr?
d.filter(t.expr,t.set):t.set;if(j.length>0)y=o(p);else z=false;for(;j.length;){t=D=j.pop();if(n.relative[D])t=j.pop();else D="";if(t==null)t=c;n.relative[D](y,t,A)}}else y=[]}y||(y=p);y||d.error(D||a);if(s.call(y)==="[object Array]")if(z)if(c&&c.nodeType===1)for(a=0;y[a]!=null;a++){if(y[a]&&(y[a]===true||y[a].nodeType===1&&d.contains(c,y[a])))h.push(p[a])}else for(a=0;y[a]!=null;a++)y[a]&&y[a].nodeType===1&&h.push(p[a]);else h.push.apply(h,y);else o(y,h);if(C){d(C,f,h,b);d.uniqueSort(h)}return h};
d.uniqueSort=function(a){if(x){m=i;a.sort(x);if(m)for(var c=1;c<a.length;c++)a[c]===a[c-1]&&a.splice(c--,1)}return a};d.matches=function(a,c){return d(a,null,null,c)};d.find=function(a,c,h){var b;if(!a)return[];for(var f=0,j=n.order.length;f<j;f++){var t=n.order[f],p;if(p=n.leftMatch[t].exec(a)){var y=p[1];p.splice(1,1);if(y.substr(y.length-1)!=="\\"){p[1]=(p[1]||"").replace(/\\/g,"");b=n.find[t](p,c,h);if(b!=null){a=a.replace(n.match[t],"");break}}}}b||(b=c.getElementsByTagName("*"));return{set:b,
expr:a}};d.filter=function(a,c,h,b){for(var f=a,j=[],t=c,p,y,C=c&&c[0]&&d.isXML(c[0]);a&&c.length;){for(var z in n.filter)if((p=n.leftMatch[z].exec(a))!=null&&p[2]){var A=n.filter[z],B,D;D=p[1];y=false;p.splice(1,1);if(D.substr(D.length-1)!=="\\"){if(t===j)j=[];if(n.preFilter[z])if(p=n.preFilter[z](p,t,h,j,b,C)){if(p===true)continue}else y=B=true;if(p)for(var E=0;(D=t[E])!=null;E++)if(D){B=A(D,p,E,t);var F=b^!!B;if(h&&B!=null)if(F)y=true;else t[E]=false;else if(F){j.push(D);y=true}}if(B!==undefined){h||
(t=j);a=a.replace(n.match[z],"");if(!y)return[];break}}}if(a===f)if(y==null)d.error(a);else break;f=a}return t};d.error=function(a){throw"Syntax error, unrecognized expression: "+a;};var n=d.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,
POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")}},relative:{"+":function(a,c){var h=typeof c==="string",b=h&&!/\W/.test(c);h=h&&!b;if(b)c=c.toLowerCase();b=0;for(var f=a.length,j;b<f;b++)if(j=a[b]){for(;(j=j.previousSibling)&&j.nodeType!==1;);a[b]=h||j&&j.nodeName.toLowerCase()===
c?j||false:j===c}h&&d.filter(c,a,true)},">":function(a,c){var h=typeof c==="string",b,f=0,j=a.length;if(h&&!/\W/.test(c))for(c=c.toLowerCase();f<j;f++){if(b=a[f]){h=b.parentNode;a[f]=h.nodeName.toLowerCase()===c?h:false}}else{for(;f<j;f++)if(b=a[f])a[f]=h?b.parentNode:b.parentNode===c;h&&d.filter(c,a,true)}},"":function(a,c,h){var b=u++,f=w,j;if(typeof c==="string"&&!/\W/.test(c)){j=c=c.toLowerCase();f=g}f("parentNode",c,b,a,j,h)},"~":function(a,c,h){var b=u++,f=w,j;if(typeof c==="string"&&!/\W/.test(c)){j=
c=c.toLowerCase();f=g}f("previousSibling",c,b,a,j,h)}},find:{ID:function(a,c,h){if(typeof c.getElementById!=="undefined"&&!h)return(a=c.getElementById(a[1]))?[a]:[]},NAME:function(a,c){if(typeof c.getElementsByName!=="undefined"){var h=[];c=c.getElementsByName(a[1]);for(var b=0,f=c.length;b<f;b++)c[b].getAttribute("name")===a[1]&&h.push(c[b]);return h.length===0?null:h}},TAG:function(a,c){return c.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,c,h,b,f,j){a=" "+a[1].replace(/\\/g,"")+" ";
if(j)return a;j=0;for(var t;(t=c[j])!=null;j++)if(t)if(f^(t.className&&(" "+t.className+" ").replace(/[\t\n]/g," ").indexOf(a)>=0))h||b.push(t);else if(h)c[j]=false;return false},ID:function(a){return a[1].replace(/\\/g,"")},TAG:function(a){return a[1].toLowerCase()},CHILD:function(a){if(a[1]==="nth"){var c=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=c[1]+(c[2]||1)-0;a[3]=c[3]-0}a[0]=u++;return a},ATTR:function(a,c,h,b,f,j){c=
a[1].replace(/\\/g,"");if(!j&&n.attrMap[c])a[1]=n.attrMap[c];if(a[2]==="~=")a[4]=" "+a[4]+" ";return a},PSEUDO:function(a,c,h,b,f){if(a[1]==="not")if((q.exec(a[3])||"").length>1||/^\w/.test(a[3]))a[3]=d(a[3],null,null,c);else{a=d.filter(a[3],c,h,true^f);h||b.push.apply(b,a);return false}else if(n.match.POS.test(a[0])||n.match.CHILD.test(a[0]))return true;return a},POS:function(a){a.unshift(true);return a}},filters:{enabled:function(a){return a.disabled===false&&a.type!=="hidden"},disabled:function(a){return a.disabled===
true},checked:function(a){return a.checked===true},selected:function(a){return a.selected===true},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,c,h){return!!d(h[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){return"text"===a.type},radio:function(a){return"radio"===a.type},checkbox:function(a){return"checkbox"===a.type},file:function(a){return"file"===a.type},password:function(a){return"password"===a.type},submit:function(a){return"submit"===
a.type},image:function(a){return"image"===a.type},reset:function(a){return"reset"===a.type},button:function(a){return"button"===a.type||a.nodeName.toLowerCase()==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},setFilters:{first:function(a,c){return c===0},last:function(a,c,h,b){return c===b.length-1},even:function(a,c){return c%2===0},odd:function(a,c){return c%2===1},lt:function(a,c,h){return c<h[3]-0},gt:function(a,c,h){return c>h[3]-0},nth:function(a,c,h){return h[3]-
0===c},eq:function(a,c,h){return h[3]-0===c}},filter:{PSEUDO:function(a,c,h,b){var f=c[1],j=n.filters[f];if(j)return j(a,h,c,b);else if(f==="contains")return(a.textContent||a.innerText||d.getText([a])||"").indexOf(c[3])>=0;else if(f==="not"){c=c[3];h=0;for(b=c.length;h<b;h++)if(c[h]===a)return false;return true}else d.error("Syntax error, unrecognized expression: "+f)},CHILD:function(a,c){var h=c[1],b=a;switch(h){case "only":case "first":for(;b=b.previousSibling;)if(b.nodeType===1)return false;if(h===
"first")return true;b=a;case "last":for(;b=b.nextSibling;)if(b.nodeType===1)return false;return true;case "nth":h=c[2];var f=c[3];if(h===1&&f===0)return true;c=c[0];var j=a.parentNode;if(j&&(j.sizcache!==c||!a.nodeIndex)){var t=0;for(b=j.firstChild;b;b=b.nextSibling)if(b.nodeType===1)b.nodeIndex=++t;j.sizcache=c}a=a.nodeIndex-f;return h===0?a===0:a%h===0&&a/h>=0}},ID:function(a,c){return a.nodeType===1&&a.getAttribute("id")===c},TAG:function(a,c){return c==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===
c},CLASS:function(a,c){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(c)>-1},ATTR:function(a,c){var h=c[1];a=n.attrHandle[h]?n.attrHandle[h](a):a[h]!=null?a[h]:a.getAttribute(h);h=a+"";var b=c[2];c=c[4];return a==null?b==="!=":b==="="?h===c:b==="*="?h.indexOf(c)>=0:b==="~="?(" "+h+" ").indexOf(c)>=0:!c?h&&a!==false:b==="!="?h!==c:b==="^="?h.indexOf(c)===0:b==="$="?h.substr(h.length-c.length)===c:b==="|="?h===c||h.substr(0,c.length+1)===c+"-":false},POS:function(a,c,h,b){var f=n.setFilters[c[2]];
if(f)return f(a,h,c,b)}}},l=n.match.POS,e=function(a,c){return"\\"+(c-0+1)};for(var k in n.match){n.match[k]=new RegExp(n.match[k].source+/(?![^\[]*\])(?![^\(]*\))/.source);n.leftMatch[k]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[k].source.replace(/\\(\d+)/g,e))}var o=function(a,c){a=Array.prototype.slice.call(a,0);if(c){c.push.apply(c,a);return c}return a};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(v){o=function(a,c){c=c||[];var h=0;if(s.call(a)==="[object Array]")Array.prototype.push.apply(c,
a);else if(typeof a.length==="number")for(var b=a.length;h<b;h++)c.push(a[h]);else for(;a[h];h++)c.push(a[h]);return c}}var x;if(document.documentElement.compareDocumentPosition)x=function(a,c){if(!a.compareDocumentPosition||!c.compareDocumentPosition){if(a==c)m=true;return a.compareDocumentPosition?-1:1}a=a.compareDocumentPosition(c)&4?-1:a===c?0:1;if(a===0)m=true;return a};else if("sourceIndex"in document.documentElement)x=function(a,c){if(!a.sourceIndex||!c.sourceIndex){if(a==c)m=true;return a.sourceIndex?
-1:1}a=a.sourceIndex-c.sourceIndex;if(a===0)m=true;return a};else if(document.createRange)x=function(a,c){if(!a.ownerDocument||!c.ownerDocument){if(a==c)m=true;return a.ownerDocument?-1:1}var h=a.ownerDocument.createRange(),b=c.ownerDocument.createRange();h.setStart(a,0);h.setEnd(a,0);b.setStart(c,0);b.setEnd(c,0);a=h.compareBoundaryPoints(Range.START_TO_END,b);if(a===0)m=true;return a};d.getText=function(a){for(var c="",h,b=0;a[b];b++){h=a[b];if(h.nodeType===3||h.nodeType===4)c+=h.nodeValue;else if(h.nodeType!==
8)c+=d.getText(h.childNodes)}return c};(function(){var a=document.createElement("div"),c="script"+(new Date).getTime();a.innerHTML="<a name='"+c+"'/>";var h=document.documentElement;h.insertBefore(a,h.firstChild);if(document.getElementById(c)){n.find.ID=function(b,f,j){if(typeof f.getElementById!=="undefined"&&!j)return(f=f.getElementById(b[1]))?f.id===b[1]||typeof f.getAttributeNode!=="undefined"&&f.getAttributeNode("id").nodeValue===b[1]?[f]:undefined:[]};n.filter.ID=function(b,f){var j=typeof b.getAttributeNode!==
"undefined"&&b.getAttributeNode("id");return b.nodeType===1&&j&&j.nodeValue===f}}h.removeChild(a);h=a=null})();(function(){var a=document.createElement("div");a.appendChild(document.createComment(""));if(a.getElementsByTagName("*").length>0)n.find.TAG=function(c,h){h=h.getElementsByTagName(c[1]);if(c[1]==="*"){c=[];for(var b=0;h[b];b++)h[b].nodeType===1&&c.push(h[b]);h=c}return h};a.innerHTML="<a href='#'></a>";if(a.firstChild&&typeof a.firstChild.getAttribute!=="undefined"&&a.firstChild.getAttribute("href")!==
"#")n.attrHandle.href=function(c){return c.getAttribute("href",2)};a=null})();document.querySelectorAll&&function(){var a=d,c=document.createElement("div");c.innerHTML="<p class='TEST'></p>";if(!(c.querySelectorAll&&c.querySelectorAll(".TEST").length===0)){d=function(b,f,j,t){f=f||document;if(!t&&f.nodeType===9&&!d.isXML(f))try{return o(f.querySelectorAll(b),j)}catch(p){}return a(b,f,j,t)};for(var h in a)d[h]=a[h];c=null}}();(function(){var a=document.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";
if(!(!a.getElementsByClassName||a.getElementsByClassName("e").length===0)){a.lastChild.className="e";if(a.getElementsByClassName("e").length!==1){n.order.splice(1,0,"CLASS");n.find.CLASS=function(c,h,b){if(typeof h.getElementsByClassName!=="undefined"&&!b)return h.getElementsByClassName(c[1])};a=null}}})();d.contains=document.compareDocumentPosition?function(a,c){return!!(a.compareDocumentPosition(c)&16)}:function(a,c){return a!==c&&(a.contains?a.contains(c):true)};d.isXML=function(a){return(a=(a?
a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":false};var r=function(a,c){var h=[],b="",f;for(c=c.nodeType?[c]:c;f=n.match.PSEUDO.exec(a);){b+=f[0];a=a.replace(n.match.PSEUDO,"")}a=n.relative[a]?a+"*":a;f=0;for(var j=c.length;f<j;f++)d(a,c[f],h);return d.filter(b,h)};KISSY.ExternalSelector=d;KISSY.ExternalSelector._filter=function(a,c){return d.matches(c,KISSY.query(a))}})();
KISSY.add("anim-easing",function(g){var w=Math,q=w.PI,u=w.pow,s=w.sin,m=1.70158,i={easeNone:function(d){return d},easeIn:function(d){return d*d},easeOut:function(d){return(2-d)*d},easeBoth:function(d){return(d*=2)<1?0.5*d*d:0.5*(1- --d*(d-2))},easeInStrong:function(d){return d*d*d*d},easeOutStrong:function(d){return 1- --d*d*d*d},easeBothStrong:function(d){return(d*=2)<1?0.5*d*d*d*d:0.5*(2-(d-=2)*d*d*d)},elasticIn:function(d){if(d===0||d===1)return d;return-(u(2,10*(d-=1))*s((d-0.075)*2*q/0.3))},
elasticOut:function(d){if(d===0||d===1)return d;return u(2,-10*d)*s((d-0.075)*2*q/0.3)+1},elasticBoth:function(d){if(d===0||(d*=2)===2)return d;if(d<1)return-0.5*u(2,10*(d-=1))*s((d-0.1125)*2*q/0.45);return u(2,-10*(d-=1))*s((d-0.1125)*2*q/0.45)*0.5+1},backIn:function(d){if(d===1)d-=0.0010;return d*d*((m+1)*d-m)},backOut:function(d){return(d-=1)*d*((m+1)*d+m)+1},backBoth:function(d){if((d*=2)<1)return 0.5*d*d*(((m*=1.525)+1)*d-m);return 0.5*((d-=2)*d*(((m*=1.525)+1)*d+m)+2)},bounceIn:function(d){return 1-
i.bounceOut(1-d)},bounceOut:function(d){return d<1/2.75?7.5625*d*d:d<2/2.75?7.5625*(d-=1.5/2.75)*d+0.75:d<2.5/2.75?7.5625*(d-=2.25/2.75)*d+0.9375:7.5625*(d-=2.625/2.75)*d+0.984375},bounceBoth:function(d){if(d<0.5)return i.bounceIn(d*2)*0.5;return i.bounceOut(d*2-1)*0.5+0.5}};g.Easing=i});
KISSY.add("anim",function(g,w){function q(r,a,c,h,b){if(r=g.get(r)){if(!(this instanceof q))return new q(r,a,c,h,b);var f=g.isPlainObject(c);a=a;this.domEl=r;if(g.isPlainObject(a))a=g.param(a,";").replace(/=/g,":");this.props=u(a);this.targetStyle=a;if(f)r=g.merge(x,c);else{r=g.clone(x);c&&(r.duration=e(c,10)||1);g.isString(h)&&(h=l[h]);g.isFunction(h)&&(r.easing=h);g.isFunction(b)&&(r.complete=b)}this.config=r;g.isFunction(b)&&this.on(v,b)}}function u(r){var a={},c=o.length,h;k.innerHTML='<div style="'+
r+'"></div>';for(r=k.firstChild.style;c--;)if(h=r[o[c]])a[o[c]]=s(h);return a}function s(r){var a=e(r);r=(r+"").replace(/^[-\d\.]+/,"");return isNaN(a)?{v:r,u:"",f:i}:{v:a,u:r,f:m}}function m(r,a,c){return(r+(a-r)*c).toFixed(3)}function i(r,a,c){for(var h=2,b,f,j=[],t=[];b=3,f=arguments[h-1],h--;)if(d(f,0,4)==="rgb(")for(f=f.match(/\d+/g);b--;)j.push(~~f[b]);else if(d(f,0)==="#"){if(f.length===4)f="#"+d(f,1)+d(f,1)+d(f,2)+d(f,2)+d(f,3)+d(f,3);for(;b--;)j.push(parseInt(d(f,1+b*2,2),16))}else return a;
for(;b--;){h=~~(j[b+3]+(j[b]-j[b+3])*c);t.push(h<0?0:h>255?255:h)}return"rgb("+t.join(",")+")"}function d(r,a,c){return r.substr(a,c||1)}var n=g.DOM,l=g.Easing,e=parseFloat,k=n.create("<div>"),o="backgroundColor borderBottomColor borderBottomWidth borderBottomStyle borderLeftColor borderLeftWidth borderLeftStyle borderRightColor borderRightWidth borderRightStyle borderSpacing borderTopColor borderTopWidth borderTopStyle bottom color font fontFamily fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex".split(" "),
v="complete",x={duration:1,easing:l.easeNone};g.augment(q,g.EventTarget,{run:function(){var r=this,a=r.config,c=r.domEl,h=a.duration*1E3,b=a.easing,f=g.now(),j=f+h,t=r.props,p={},y;for(y in t)p[y]=s(n.css(c,y));if(r.fire("start")!==false){r.stop();r.timer=g.later(a=function(){var C=g.now(),z=C>j?1:(C-f)/h,A,B,D;for(y in t){A=p[y];B=t[y];if(B.v==0)B.u=A.u;if(A.u!==B.u)A.v=0;n.css(c,y,B.f(A.v,B.v,b(z))+B.u)}if(r.fire("step")===false||(D=C>j)){r.stop();D&&r.fire(v)}},13,true);a();return r}},stop:function(r){var a=
this.domEl,c=this.targetStyle;if(this.timer){this.timer.cancel();this.timer=w}if(r){g.UA.ie&&c.indexOf("opacity")>-1&&n.css(a,"opacity",this.props.opacity.v);a.style.cssText+=";"+c;this.fire(v)}return this}});g.Anim=q});KISSY.add("anim-node-plugin",function(g,w){var q=g.Anim;g.each([g.Node.prototype,g.NodeList.prototype],function(u){u.animate=function(){var s=g.makeArray(arguments);g.each(this,function(m){q.apply(w,[m].concat(s)).run()});return this}})});
KISSY.add("datalazyload",function(g,w){function q(e,k){if(!(this instanceof q))return new q(e,k);if(k===w){k=e;e=[i]}g.isArray(e)||(e=[g.get(e)||i]);this.containers=e;this.config=g.merge(l,k);this._init()}var u=g.DOM,s=g.Event,m=window,i=document,d="scroll",n="resize",l={mod:"manual",diff:"default",placeholder:"none"};g.augment(q,{_init:function(){this.threshold=this._getThreshold();this._filterItems();this._getItemsLength()&&this._initLoadEvent()},_filterItems:function(){var e=this.containers,k,
o,v,x=[],r=[];k=0;for(o=e.length;k<o;++k){v=g.query("img",e[k]);x=x.concat(g.filter(v,this._filterImg,this));v=g.query("textarea",e[k]);r=r.concat(g.filter(v,this._filterArea,this))}this.images=x;this.areas=r},_filterImg:function(e){var k=e.getAttribute("data-ks-lazyload"),o=this.threshold,v=this.config.placeholder;if(this.config.mod==="manual"){if(k){if(v!=="none")e.src=v;return true}}else if(u.offset(e).top>o&&!k){u.attr(e,"data-ks-lazyload",e.src);if(v!=="none")e.src=v;else e.removeAttribute("src");
return true}},_filterArea:function(e){return u.hasClass(e,"ks-datalazyload")},_initLoadEvent:function(){function e(){o||(o=g.later(function(){k();o=null},100))}function k(){v._loadItems();if(v._getItemsLength()===0){s.remove(m,d,e);s.remove(m,n,e)}}var o,v=this;s.on(m,d,e);s.on(m,n,function(){v.threshold=v._getThreshold();e()});v._getItemsLength()&&g.ready(function(){k()})},_loadItems:function(){this._loadImgs();this._loadAreas()},_loadImgs:function(){this.images=g.filter(this.images,this._loadImg,
this)},_loadImg:function(e){var k=this.threshold+u.scrollTop();if(u.offset(e).top<=k)this._loadImgSrc(e);else return true},_loadImgSrc:function(e,k){k=k||"data-ks-lazyload";var o=e.getAttribute(k);if(o&&e.src!=o){e.src=o;e.removeAttribute(k)}},_loadAreas:function(){this.areas=g.filter(this.areas,this._loadArea,this)},_loadArea:function(e){var k=u.css(e,"display")==="none";if(u.offset(k?e.parentNode:e).top<=this.threshold+u.scrollTop())this._loadAreaData(e.parentNode,e);else return true},_loadAreaData:function(e,
k){k.style.display="none";k.className="";var o=u.create("<div>");e.insertBefore(o,k);u.html(o,k.value,true)},_getThreshold:function(){var e=this.config.diff,k=u.viewportHeight();return e==="default"?2*k:k+e},_getItemsLength:function(){return this.images.length+this.areas.length},loadCustomLazyData:function(e,k){var o=this,v,x;g.isArray(e)||(e=[g.get(e)]);g.each(e,function(r){switch(k){case "img-src":x=r.nodeName==="IMG"?[r]:g.query("img",r);g.each(x,function(a){o._loadImgSrc(a,"data-ks-lazyload-custom")});
break;default:(v=g.get("textarea",r))&&u.hasClass(v,"ks-datalazyload-custom")&&o._loadAreaData(r,v)}})}});g.mix(q,q.prototype,true,["loadCustomLazyData","_loadImgSrc","_loadAreaData"]);g.DataLazyload=q});
KISSY.add("flash-ua",function(g){function w(){var l;if(navigator.plugins&&navigator.mimeTypes.length)l=(navigator.plugins["Shockwave Flash"]||0).description;else if(window.ActiveXObject)try{l=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(e){}if(l)return q(l)}function q(l){return l.match(/(\d)+/g)}function u(l){var e=g.isString(l)?q(l):l;l=l;if(g.isArray(e))l=parseFloat(e[0]+"."+s(e[1],3)+s(e[2],5));return l||0}function s(l,e){for(var k=(l+"").length;k++<e;)l="0"+
l;return l}var m=g.UA,i,d,n=true;m.fpv=function(l){if(l||n){n=false;i=w();d=u(i)}return i};m.fpvGEQ=function(l,e){n&&m.fpv(e);return!!d&&d>=u(l)}});KISSY.add("flash",function(g){g.Flash={swfs:{},length:0}});
KISSY.add("flash-embed",function(g){function w(l,e,k){var o=u.create("<param>");u.attr(o,{name:e,value:k});l.appendChild(o)}var q=g.UA,u=g.DOM,s=g.Flash,m=/object|embed/i,i=encodeURIComponent,d={wmode:"",allowscriptaccess:"",allownetworking:"",allowfullscreen:"",play:"false",loop:"",menu:"",quality:"",scale:"",salign:"",bgcolor:"",devicefont:"",base:"",swliveconnect:"",seamlesstabbing:""},n={params:{},attrs:{width:215,height:138},version:9};g.mix(s,{fpv:q.fpv,fpvGEQ:q.fpvGEQ,add:function(l,e,k){var o,
v;e=s._normalize(e);e=g.merge(n,e);e.attrs=g.merge(n.attrs,e.attrs);if(l=g.get(l)){if(!l.id)l.id=g.guid("ks-flash-");v=e.attrs.id=l.id;if(q.fpv()){if(!q.fpvGEQ(e.version)){this._callback(k,0,v,l);if(!((o=e.xi)&&g.isString(o)))return;e.src=o}if(m.test(l.nodeName))this._register(l,e,k);else e.src?this._embed(l,e,k):this._callback(k,-3,v,l)}else this._callback(k,-1,v,l)}else this._callback(k,-2)},get:function(l){return s.swfs[l]},remove:function(l){if(l=s.get("#"+l)){u.remove(l);delete s.swfs[l.id];
s.length-=1}},contains:function(l){var e=s.swfs,k,o=false;if(g.isString(l))o=l in e;else for(k in e)if(e[k]===l){o=true;break}return o},_register:function(l,e,k){e=e.attrs.id;s._addSWF(e,l);s._callback(k,1,e,l)},_embed:function(l,e,k){var o=s._createSWF(e.src,e.attrs,e.params);if(q.ie)l.outerHTML=o.outerHTML;else l.parentNode.replaceChild(o,l);s._register(l,e,k)},_callback:function(l,e,k,o){e&&g.isFunction(l)&&l({status:e,id:k,swf:o})},_addSWF:function(l,e){if(l&&e){s.swfs[l]=e;s.length+=1}},_createSWF:function(l,
e,k){var o=u.create("<object>"),v;u.attr(o,e);if(q.ie){u.attr(o,"classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");w(o,"movie",l)}else u.attr(o,{type:"application/x-shockwave-flash",data:l,name:e.id});for(v in k)v in d&&w(o,v,k[v]);k.flashvars&&w(o,"flashvars",s.toFlashVars(k.flashvars));return o},_normalize:function(l){var e,k,o,v=l;if(g.isPlainObject(l)){v={};for(o in l){e=o.toLowerCase();k=l[o];if(e!=="flashvars")k=s._normalize(k);v[e]=k}}return v},toFlashVars:function(l){if(!g.isPlainObject(l))return"";
var e,k,o=[];for(e in l){k=l[e];if(g.isString(k))k=i(k);else{k=g.JSON.stringify(k);if(!k)continue;k=k.replace(/:"([^"]+)/g,function(v,x){return':"'+i(x)})}o.push(e+"="+k)}return o.join("&")}})});
KISSY.add("switchable",function(g,w){function q(m,i){i=i||{};if(!("markupType"in i))if(i.panelCls)i.markupType=1;else if(i.panels)i.markupType=2;i=g.merge(q.Config,i);this.container=g.get(m);this.config=i;this.activeIndex=i.activeIndex;this._init()}var u=g.DOM,s=g.Event;q.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,
activeTriggerCls:"ks-active",steps:1,viewSize:[]};q.Plugins=[];g.augment(q,g.EventTarget,{_init:function(){var m=this,i=m.config;if(m.fire("beforeInit")!==false){m._parseMarkup();i.hasTriggers&&m._bindTriggers();g.each(q.Plugins,function(d){d.init&&d.init(m)});m.fire("init")}},_parseMarkup:function(){var m=this.container,i=this.config,d,n=[],l=[];switch(i.markupType){case 0:if(d=g.get("."+i.navCls,m))n=u.children(d);d=g.get("."+i.contentCls,m);l=u.children(d);break;case 1:n=g.query("."+i.triggerCls,
m);l=g.query("."+i.panelCls,m);break;case 2:n=i.triggers;l=i.panels;break}m=l.length;this.length=m/i.steps;if(i.hasTriggers&&m>0&&n.length===0)n=this._generateTriggersMarkup(this.length);this.triggers=g.makeArray(n);this.panels=g.makeArray(l);this.content=d||l[0].parentNode},_generateTriggersMarkup:function(m){var i=this.config,d=u.create("<ul>"),n,l;d.className=i.navCls;for(l=0;l<m;l++){n=u.create("<li>");if(l===this.activeIndex)n.className=i.activeTriggerCls;n.innerHTML=l+1;d.appendChild(n)}this.container.appendChild(d);
return u.children(d)},_bindTriggers:function(){var m=this,i=m.config,d=m.triggers,n,l,e=d.length;for(l=0;l<e;l++)(function(k){n=d[k];s.on(n,"click focus",function(){m._onFocusTrigger(k)});if(i.triggerType==="mouse"){s.on(n,"mouseenter",function(){m._onMouseEnterTrigger(k)});s.on(n,"mouseleave",function(){m._onMouseLeaveTrigger(k)})}})(l)},_onFocusTrigger:function(m){if(this._triggerIsValid()){this._cancelSwitchTimer();this.switchTo(m)}},_onMouseEnterTrigger:function(m){var i=this;if(i._triggerIsValid())i.switchTimer=
g.later(function(){i.switchTo(m)},i.config.delay*1E3)},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(m){return this.activeIndex!==m},_cancelSwitchTimer:function(){if(this.switchTimer){this.switchTimer.cancel();this.switchTimer=w}},switchTo:function(m,i){var d=this.config,n=this.triggers,l=this.panels,e=this.activeIndex,k=d.steps,o=e*k,v=m*k;if(!this._triggerIsValid())return this;if(this.fire("beforeSwitch",{toIndex:m})===false)return this;if(d.hasTriggers)this._switchTrigger(e>
-1?n[e]:null,n[m]);if(i===w)i=m>e?"forward":"backward";this._switchView(l.slice(o,o+k),l.slice(v,v+k),m,i);this.activeIndex=m;return this},_switchTrigger:function(m,i){var d=this.config.activeTriggerCls;m&&u.removeClass(m,d);u.addClass(i,d)},_switchView:function(m,i,d){u.css(m,"display","none");u.css(i,"display","block");this._fireOnSwitch(d)},_fireOnSwitch:function(m){this.fire("switch",{currentIndex:m})},prev:function(){var m=this.activeIndex;this.switchTo(m>0?m-1:this.length-1,"backward")},next:function(){var m=
this.activeIndex;this.switchTo(m<this.length-1?m+1:0,"forward")}});g.Switchable=q});
KISSY.add("switchable-autoplay",function(g,w){var q=g.Event,u=g.Switchable;g.mix(u.Config,{autoplay:false,interval:5,pauseOnHover:true});u.Plugins.push({name:"autoplay",init:function(s){function m(){n=g.later(function(){s.paused||s.switchTo(s.activeIndex<s.length-1?s.activeIndex+1:0,"forward")},d,true)}var i=s.config,d=i.interval*1E3,n;if(i.autoplay){if(i.pauseOnHover){q.on(s.container,"mouseenter",function(){if(n){n.cancel();n=w}s.paused=true});q.on(s.container,"mouseleave",function(){s.paused=false;
m()})}m()}}})});
KISSY.add("switchable-effect",function(g,w){var q=g.DOM,u=g.Anim,s=g.Switchable,m;g.mix(s.Config,{effect:"none",duration:0.5,easing:"easeNone"});s.Effects={none:function(i,d,n){q.css(i,"display","none");q.css(d,"display","block");n()},fade:function(i,d,n){i.length!==1&&g.error("fade effect only supports steps == 1.");var l=this,e=l.config,k=i[0],o=d[0];l.anim&&l.anim.stop(true);q.css(o,"opacity",1);l.anim=(new u(k,{opacity:0},e.duration,e.easing,function(){l.anim=w;q.css(o,"z-index",9);q.css(k,"z-index",
1);n()})).run()},scroll:function(i,d,n,l){var e=this;i=e.config;d=i.effect==="scrollx";var k={};k[d?"left":"top"]=-(e.viewSize[d?0:1]*l)+"px";e.anim&&e.anim.stop();e.anim=(new u(e.content,k,i.duration,i.easing,function(){e.anim=w;n()})).run()}};m=s.Effects;m.scrollx=m.scrolly=m.scroll;s.Plugins.push({name:"effect",init:function(i){var d=i.config,n=d.effect,l=i.panels,e=i.content,k=d.steps,o=i.activeIndex,v=l.length;i.viewSize=[d.viewSize[0]||l[0].offsetWidth*k,d.viewSize[1]||l[0].offsetHeight*k];
if(n!=="none"){g.each(l,function(c){q.css(c,"display","block")});switch(n){case "scrollx":case "scrolly":q.css(e,"position","absolute");q.css(e.parentNode,"position","relative");if(n==="scrollx"){q.css(l,"float","left");q.width(e,i.viewSize[0]*(v/k))}break;case "fade":var x=o*k,r=x+k-1,a;g.each(l,function(c,h){a=h>=x&&h<=r;q.css(c,{opacity:a?1:0,position:"absolute",zIndex:a?9:1})});break}}}});g.augment(s,{_switchView:function(i,d,n,l){var e=this,k=e.config.effect;(g.isFunction(k)?k:m[k]).call(e,i,
d,function(){e._fireOnSwitch(n)},n,l)}})});
KISSY.add("switchable-circular",function(g,w){function q(a,c,h,b,f){var j=this;a=j.config;c=j.length;var t=j.activeIndex,p=a.scrollType===x,y=p?n:l,C=j.viewSize[p?0:1];p=-C*b;var z={},A,B=f===v;if(A=B&&t===0&&b===c-1||f===o&&t===c-1&&b===0)p=u.call(j,j.panels,b,B,y,C);z[y]=p+k;j.anim&&j.anim.stop();j.anim=(new g.Anim(j.content,z,a.duration,a.easing,function(){A&&s.call(j,j.panels,b,B,y,C);j.anim=w;h()})).run()}function u(a,c,h,b,f){var j=this.config.steps;c=this.length;var t=h?c-1:0,p=(t+1)*j;for(j=
t*j;j<p;j++){m.css(a[j],i,d);m.css(a[j],b,(h?-1:1)*f*c)}return h?f:-f*c}function s(a,c,h,b,f){var j=this.config.steps;c=this.length;var t=h?c-1:0,p=(t+1)*j;for(j=t*j;j<p;j++){m.css(a[j],i,e);m.css(a[j],b,e)}m.css(this.content,b,h?-f*(c-1):e)}var m=g.DOM,i="position",d="relative",n="left",l="top",e="",k="px",o="forward",v="backward",x="scrollx",r=g.Switchable;g.mix(r.Config,{circular:false});r.Plugins.push({name:"circular",init:function(a){a=a.config;if(a.circular&&(a.effect===x||a.effect==="scrolly")){a.scrollType=
a.effect;a.effect=q}}})});
KISSY.add("switchable-lazyload",function(g){var w=g.DOM,q="beforeSwitch",u="img-src",s="area-data",m={},i=g.Switchable;m[u]="data-ks-lazyload-custom";m[s]="ks-datalazyload-custom";g.mix(i.Config,{lazyDataType:s});i.Plugins.push({name:"lazyload",init:function(d){function n(x){var r=k.steps;x=x.toIndex*r;e.loadCustomLazyData(d.panels.slice(x,x+r),o);l()&&d.detach(q,n)}function l(){var x,r,a,c=o===u;if(x=c?"img":o===s?"textarea":""){x=g.query(x,d.container);r=0;for(a=x.length;r<a;r++)if(c?w.attr(x[r],
v):w.hasClass(x[r],v))return false}return true}var e=g.DataLazyload,k=d.config,o=k.lazyDataType,v=m[o];!e||!o||!v||d.on(q,n)}})});
KISSY.add("switchable-countdown",function(g,w){var q=g.DOM,u=g.Event,s=g.Anim,m=g.Switchable;g.mix(m.Config,{countdown:false,countdownFromStyle:"",countdownToStyle:"width: 0"});m.Plugins.push({name:"countdown",init:function(i){function d(){n();x=(new s(k[i.activeIndex],v,e-0.5)).run()}function n(){if(x){x.stop();x=w}}var l=i.config,e=l.interval,k=[],o=l.countdownFromStyle,v=l.countdownToStyle,x;if(!(!l.autoplay||!l.hasTriggers||!l.countdown)){g.each(i.triggers,function(r,a){r.innerHTML='<div class="ks-switchable-trigger-mask"></div><div class="ks-switchable-trigger-content">'+
r.innerHTML+"</div>";k[a]=r.firstChild});if(l.pauseOnHover){u.on(i.container,"mouseenter",function(){n();var r=k[i.activeIndex];if(o)x=(new s(r,o,0.2,"easeOut")).run();else q.removeAttr(r,"style")});u.on(i.container,"mouseleave",function(){n();q.removeAttr(k[i.activeIndex],"style");g.later(d,200)})}i.on("beforeSwitch",function(){n();q.removeAttr(k[i.activeIndex],"style")});i.on("switch",function(){i.paused||d()});d(i.activeIndex)}}})});
KISSY.add("switchable-autorender",function(g){g.Switchable.autoRender=function(w,q,u){q="."+(q||"KS_");u=u||"data-ks-switchable";g.each(["Switchable","Tabs","Slide","Carousel","Accordion"],function(s){g.each(g.query(q+s,w),function(m){try{var i=m.getAttribute(u);if(i)i=i.replace(/'/g,'"');new g[s](m,g.JSON.parse(i))}catch(d){g.log("Switchable.autoRender: "+d,"warn")}})})}});
KISSY.add("tabs",function(g){function w(q,u){if(!(this instanceof w))return new w(q,u);w.superclass.constructor.call(this,q,u)}g.extend(w,g.Switchable);g.Tabs=w});KISSY.add("slide",function(g){function w(u,s){if(!(this instanceof w))return new w(u,s);w.superclass.constructor.call(this,u,g.merge(q,s))}var q={autoplay:true,circular:true};g.extend(w,g.Switchable);g.Slide=w});
KISSY.add("carousel",function(g,w){function q(e,k){var o=this;if(!(o instanceof q))return new q(e,k);o.on("init",function(){u(o)});q.superclass.constructor.call(o,e,g.merge(l,k))}function u(e){var k=e.config,o=k.disableBtnCls;g.each(["prev","next"],function(v){var x=e[v+"Btn"]=g.get(i+k[v+"BtnCls"],e.container);m.on(x,"click",function(r){r.preventDefault();s.hasClass(x,o)||e[v]()})});k.circular||e.on("switch",function(v){v=v.currentIndex;v=v===0?e[d]:v===e.length-1?e[n]:w;s.removeClass([e[d],e[n]],
o);v&&s.addClass(v,o)});m.on(e.panels,"click focus",function(){e.fire("itemSelected",{item:this})})}var s=g.DOM,m=g.Event,i=".",d="prevBtn",n="nextBtn",l={circular:true,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};g.extend(q,g.Switchable);g.Carousel=q});
KISSY.add("accordion",function(g){function w(s,m){if(!(this instanceof w))return new w(s,m);w.superclass.constructor.call(this,s,g.merge(u,m))}var q=g.DOM,u={markupType:1,triggerType:"click",multiple:false};g.extend(w,g.Switchable);g.Accordion=w;g.augment(w,{_triggerIsValid:function(s){return this.activeIndex!==s||this.config.multiple},_switchView:function(s,m,i){var d=this.config,n=m[0];if(d.multiple){q.toggleClass(this.triggers[i],d.activeTriggerCls);q.css(n,"display",n.style.display=="none"?"block":
"none");this._fireOnSwitch(i)}else w.superclass._switchView.call(this,s,m,i)}})});
KISSY.add("suggest",function(g,w){function q(b,f,j){if(!(this instanceof q))return new q(b,f,j);this.textInput=g.get(b);f+=f.indexOf("?")===-1?"?":"&";this.dataSource=f+"code=utf-8&callback="+v;this.config=g.merge(h,j);this.queryParams=this.query=x;this._dataCache={};this._init()}function u(b){b.style.visibility=x}function s(b){b.style.visibility=r}function m(b,f){if(f.nodeType===1){i.html(b,x);b.appendChild(f)}else i.html(b,f)}var i=g.DOM,d=g.Event,n=window,l=document,e,k=g.get("head"),o=g.UA.ie,
v="g_ks_suggest_callback",x="",r="hidden",a=parseInt,c=/input|button|a/i,h={containerCls:x,resultFormat:"%result%",closeBtnText:"\u5173\u95ed",shim:o===6,submitOnSelect:true};g.augment(q,g.EventTarget,{_init:function(){e=l.body;this._initTextInput();this._initContainer();this.config.shim&&this._initShim();this._initStyle();this._initEvent()},_initTextInput:function(){var b=this,f=b.textInput,j=false,t=0;i.attr(f,"autocomplete","off");b.config.autoFocus&&f.focus();d.on(f,"keydown",function(p){p=p.keyCode;
if(p===27){b.hide();f.value=b.query}else if(p>32&&p<41)if(f.value){if(p===40||p===38)if(t++===0){b._isRunning&&b.stop();j=true;b._selectItem(p===40)}else if(t==3)t=0}else f.blur();else if(p===13){f.blur();if(j)if(f.value==b._getSelectedItemKey())if(b.fire("itemSelect")===false)return;b._submitForm()}else{b._isRunning||b.start();j=false}});d.on(f,"keyup",function(){t=0});d.on(f,"blur",function(){b.stop();g.later(function(){b._focusing||b.hide()},0)})},_initContainer:function(){var b=i.create("<div>",
{"class":"ks-suggest-container "+this.config.containerCls,style:"position:absolute;visibility:hidden"}),f=i.create("<div>",{"class":"ks-suggest-content"}),j=i.create("<div>",{"class":"ks-suggest-footer"});b.appendChild(f);b.appendChild(j);e.insertBefore(b,e.firstChild);this.container=b;this.content=f;this.footer=j;this._initContainerEvent()},_setContainerRegion:function(){var b=this.textInput,f=i.offset(b),j=this.container;i.offset(j,{left:f.left,top:f.top+b.offsetHeight-1});i.width(j,this.config.containerWidth||
b.offsetWidth-2)},_initContainerEvent:function(){var b=this,f=b.textInput,j=b.container,t=b.content,p=b.footer,y,C;d.on(t,"mousemove",function(z){z=z.target;if(z.nodeName!=="LI")z=i.parent(z,"li");if(i.contains(t,z))if(z!==b.selectedItem){b._removeSelectedItem();b._setSelectedItem(z)}});d.on(t,"mousedown",function(z){z=z.target;if(z.nodeName!=="LI")z=i.parent(z,"li");y=z});d.on(j,"mousedown",function(z){if(!c.test(z.target.nodeName)){f.onbeforedeactivate=function(){n.event.returnValue=false;f.onbeforedeactivate=
null};z.preventDefault()}});d.on(t,"mouseup",function(z){var A=z.target;if(!(z.which>2)){if(A.nodeName!=="LI")A=i.parent(A,"li");if(A==y)if(i.contains(t,A)){b._updateInputFromSelectItem(A);if(b.fire("itemSelect")!==false){f.blur();b._submitForm()}}}});d.on(p,"focusin",function(){b._focusing=true;b._removeSelectedItem();C=false});d.on(p,"focusout",function(){b._focusing=false;g.later(function(){if(C)b.hide();else b._focusing||b.textInput.focus()},0)});d.on(b.container,"mouseleave",function(){C=true});
d.on(p,"click",function(z){i.hasClass(z.target,"ks-suggest-closebtn")&&b.hide()})},_submitForm:function(){if(this.config.submitOnSelect){var b=this.textInput.form;if(b)if(this.fire("beforeSubmit",{form:b})!==false){if(l.createEvent){var f=l.createEvent("MouseEvents");f.initEvent("submit",true,false);b.dispatchEvent(f)}else l.createEventObject&&b.fireEvent("onsubmit");b.submit()}}},_initShim:function(){var b=i.create("<iframe>",{src:"about:blank","class":"ks-suggest-shim",style:"position:absolute;visibility:hidden;border:none"});
this.container.shim=b;e.insertBefore(b,e.firstChild)},_setShimRegion:function(){var b=this.container,f=b.style,j=b.shim;j&&i.css(j,{left:a(f.left)-2,top:f.top,width:a(f.width)+2,height:i.height(b)-2})},_initStyle:function(){g.get("#ks-suggest-style")||i.addStyleSheet(".ks-suggest-container{background:white;border:1px solid #999;z-index:99999}.ks-suggest-shim{z-index:99998}.ks-suggest-container li{color:#404040;padding:1px 0 2px;font-size:12px;line-height:18px;float:left;width:100%}.ks-suggest-container .ks-selected{background-color:#39F;cursor:default}.ks-suggest-key{float:left;text-align:left;padding-left:5px}.ks-suggest-result{float:right;text-align:right;padding-right:5px;color:green}.ks-suggest-container .ks-selected span{color:#FFF;cursor:default}.ks-suggest-footer{padding:0 5px 5px}.ks-suggest-closebtn{float:right}.ks-suggest-container li,.ks-suggest-footer{overflow:hidden;zoom:1;clear:both}.ks-suggest-container{*margin-left:2px;_margin-left:-2px;_margin-top:-3px}",
"ks-suggest-style")},_initEvent:function(){var b=this;d.on(n,"resize",function(){b._setContainerRegion();b._setShimRegion()})},start:function(){var b=this;if(b.fire("beforeStart")!==false){q.focusInstance=b;b._timer=g.later(function(){b._updateContent();b._timer=g.later(arguments.callee,200)},200);b._isRunning=true}},stop:function(){q.focusInstance=w;this._timer&&this._timer.cancel();this._isRunning=false},show:function(){if(!this.isVisible()){var b=this.container,f=b.shim;this._setContainerRegion();
u(b);if(f){this._setShimRegion();u(f)}}},hide:function(){if(this.isVisible()){var b=this.container,f=b.shim;f&&s(f);s(b)}},isVisible:function(){return this.container.style.visibility!=r},_updateContent:function(){var b=this.textInput;if(b.value!=this.query){b=this.query=b.value;if(g.trim(b))if(this._dataCache[b]!==w){this._fillContainer(this._dataCache[b]);this._displayContainer()}else this._requestData();else{this._fillContainer();this.hide()}}},_requestData:function(){var b=this,f;if(!o)b.dataScript=
w;if(!b.dataScript){f=l.createElement("script");f.charset="utf-8";f.async=true;k.insertBefore(f,k.firstChild);b.dataScript=f;if(!o){var j=g.now();b._latestScriptTime=j;i.attr(f,"data-time",j);d.on(f,"load",function(){b._scriptDataIsOut=i.attr(f,"data-time")!=b._latestScriptTime})}}b.queryParams="q="+encodeURIComponent(b.query);if(b.fire("beforeDataRequest")!==false)b.dataScript.src=b.dataSource+"&"+b.queryParams},_handleResponse:function(b){var f=x,j,t,p,y;if(!this._scriptDataIsOut){this.returnedData=
b;if(this.fire("dataReturn",{data:b})!==false){b=this._formatData(this.returnedData);if((j=b.length)>0){t=i.create("<ol>");for(f=0;f<j;++f){p=b[f];p=this._formatItem(y=p.key,p.result);i.attr(p,"key",y);i.addClass(p,f%2?"ks-even":"ks-odd");t.appendChild(p)}f=t}this._fillContainer(f);if(this.fire("beforeShow")!==false){this._dataCache[this.query]=i.html(this.content);this._displayContainer()}}}},_formatData:function(b){var f=[],j,t,p,y=0;if(!b)return f;if(g.isArray(b.result))b=b.result;if(!(j=b.length))return f;
for(p=0;p<j;++p){t=b[p];if(g.isString(t))f[y++]={key:t};else if(g.isArray(t)&&t.length>1)f[y++]={key:t[0],result:t[1]}}return f},_formatItem:function(b,f){var j=i.create("<li>"),t=i.create("<span>",{"class":"ks-suggest-key"});i.html(t,b);j.appendChild(t);if(f){b=this.config.resultFormat.replace("%result%",f);if(g.trim(b)){f=i.create("<span>",{"class":"ks-suggest-result"});i.html(f,b);j.appendChild(f)}}return j},_fillContainer:function(b,f){this._fillContent(b||x);this._fillFooter(f||x)},_fillContent:function(b){m(this.content,
b);this.selectedItem=w},_fillFooter:function(b){var f=this.config,j=this.footer;m(j,b);if(f.closeBtn){b=i.create("<a>",{"class":"ks-suggest-closebtn",href:"javascript: void(0)",target:"_self"});i.html(b,f.closeBtnText);j.appendChild(b)}this.fire("updateFooter",{footer:j,query:this.query});i.css(j,"display",i.text(j)?x:"none")},_displayContainer:function(){g.trim(i.text(this.container))?this.show():this.hide()},_selectItem:function(b){var f=g.query("li",this.container);if(f.length!==0)if(this.isVisible()){if(this.selectedItem){b=
i[b?"next":"prev"](this.selectedItem);if(!b)this.textInput.value=this.query}else b=f[b?0:f.length-1];this._removeSelectedItem();if(b){this._setSelectedItem(b);this._updateInputFromSelectItem()}}else this.show()},_removeSelectedItem:function(){i.removeClass(this.selectedItem,"ks-selected");this.selectedItem=w},_setSelectedItem:function(b){i.addClass(b,"ks-selected");this.selectedItem=b;this.textInput.focus()},_getSelectedItemKey:function(){if(!this.selectedItem)return x;return i.attr(this.selectedItem,
"key")},_updateInputFromSelectItem:function(){this.textInput.value=this._getSelectedItemKey(this.selectedItem)||this.query}});n[v]=function(b){q.focusInstance&&g.later(function(){q.focusInstance._handleResponse(b)},0)};q.version=1.1;g.Suggest=q});
