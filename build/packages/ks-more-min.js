/*
Copyright 2010, KISSY UI Library v1.1.1dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("json",function(f){function x(e){return e<10?"0"+e:e}function p(e){h.lastIndex=0;return h.test(e)?'"'+e.replace(h,function(i){var o=n[i];return typeof o==="string"?o:"\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function t(e,i){var o,s,y=l,q,b=i[e];if(b&&typeof b==="object"&&typeof b.toJSON==="function")b=b.toJSON(e);if(typeof j==="function")b=j.call(i,e,b);switch(typeof b){case "string":return p(b);case "number":return isFinite(b)?String(b):"null";case "boolean":case "null":return String(b);
case "object":if(!b)return"null";l+=d;q=[];if(Object.prototype.toString.apply(b)==="[object Array]"){s=b.length;for(e=0;e<s;e+=1)q[e]=t(e,b)||"null";i=q.length===0?"[]":l?"[\n"+l+q.join(",\n"+l)+"\n"+y+"]":"["+q.join(",")+"]";l=y;return i}if(j&&typeof j==="object"){s=j.length;for(e=0;e<s;e+=1){o=j[e];if(typeof o==="string")if(i=t(o,b))q.push(p(o)+(l?": ":":")+i)}}else for(o in b)if(Object.hasOwnProperty.call(b,o))if(i=t(o,b))q.push(p(o)+(l?": ":":")+i);i=q.length===0?"{}":l?"{\n"+l+q.join(",\n"+l)+
"\n"+y+"}":"{"+q.join(",")+"}";l=y;return i}}f=f.JSON=window.JSON||{};if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+x(this.getUTCMonth()+1)+"-"+x(this.getUTCDate())+"T"+x(this.getUTCHours())+":"+x(this.getUTCMinutes())+":"+x(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var r=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l,d,n={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof f.stringify!=="function")f.stringify=function(e,i,o){var s;d=l="";if(typeof o==="number")for(s=0;s<o;s+=1)d+=" ";else if(typeof o==="string")d=o;if((j=i)&&typeof i!=="function"&&(typeof i!=="object"||typeof i.length!=="number"))throw new Error("JSON.stringify");return t("",
{"":e})};if(typeof f.parse!=="function")f.parse=function(e,i){function o(s,y){var q,b,a=s[y];if(a&&typeof a==="object")for(q in a)if(Object.hasOwnProperty.call(a,q)){b=o(a,q);if(b!==undefined)a[q]=b;else delete a[q]}return i.call(s,y,a)}e=String(e);r.lastIndex=0;if(r.test(e))e=e.replace(r,function(s){return"\\u"+("0000"+s.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=eval("("+e+")");return typeof i==="function"?o({"":e},""):e}throw new SyntaxError("JSON.parse");}});
(function(){function f(b,a,c,g,m,k){m=0;for(var v=g.length;m<v;m++){var w=g[m];if(w){w=w[b];for(var u=false;w;){if(w.sizcache===c){u=g[w.sizset];break}if(w.nodeType===1&&!k){w.sizcache=c;w.sizset=m}if(w.nodeName.toLowerCase()===a){u=w;break}w=w[b]}g[m]=u}}}function x(b,a,c,g,m,k){m=0;for(var v=g.length;m<v;m++){var w=g[m];if(w){w=w[b];for(var u=false;w;){if(w.sizcache===c){u=g[w.sizset];break}if(w.nodeType===1){if(!k){w.sizcache=c;w.sizset=m}if(typeof a!=="string"){if(w===a){u=true;break}}else if(d.filter(a,
[w]).length>0){u=w;break}}w=w[b]}g[m]=u}}}var p=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,t=0,r=Object.prototype.toString,h=false,l=true;[0,0].sort(function(){l=false;return 0});var d=function(b,a,c,g){c=c||[];var m=a=a||document;if(a.nodeType!==1&&a.nodeType!==9)return[];if(!b||typeof b!=="string")return c;var k=[],v,w,u,C,D=true,B=d.isXML(a),z=b,A;do{p.exec("");if(v=p.exec(z)){z=v[3];k.push(v[1]);if(v[2]){C=
v[3];break}}}while(v);if(k.length>1&&j.exec(b))if(k.length===2&&n.relative[k[0]])w=q(k[0]+k[1],a);else for(w=n.relative[k[0]]?[a]:d(k.shift(),a);k.length;){b=k.shift();if(n.relative[b])b+=k.shift();w=q(b,w)}else{if(!g&&k.length>1&&a.nodeType===9&&!B&&n.match.ID.test(k[0])&&!n.match.ID.test(k[k.length-1])){v=d.find(k.shift(),a,B);a=v.expr?d.filter(v.expr,v.set)[0]:v.set[0]}if(a){v=g?{expr:k.pop(),set:o(g)}:d.find(k.pop(),k.length===1&&(k[0]==="~"||k[0]==="+")&&a.parentNode?a.parentNode:a,B);w=v.expr?
d.filter(v.expr,v.set):v.set;if(k.length>0)u=o(w);else D=false;for(;k.length;){v=A=k.pop();if(n.relative[A])v=k.pop();else A="";if(v==null)v=a;n.relative[A](u,v,B)}}else u=[]}u||(u=w);u||d.error(A||b);if(r.call(u)==="[object Array]")if(D)if(a&&a.nodeType===1)for(b=0;u[b]!=null;b++){if(u[b]&&(u[b]===true||u[b].nodeType===1&&d.contains(a,u[b])))c.push(w[b])}else for(b=0;u[b]!=null;b++)u[b]&&u[b].nodeType===1&&c.push(w[b]);else c.push.apply(c,u);else o(u,c);if(C){d(C,m,c,g);d.uniqueSort(c)}return c};
d.uniqueSort=function(b){if(y){h=l;b.sort(y);if(h)for(var a=1;a<b.length;a++)b[a]===b[a-1]&&b.splice(a--,1)}return b};d.matches=function(b,a){return d(b,null,null,a)};d.find=function(b,a,c){var g;if(!b)return[];for(var m=0,k=n.order.length;m<k;m++){var v=n.order[m],w;if(w=n.leftMatch[v].exec(b)){var u=w[1];w.splice(1,1);if(u.substr(u.length-1)!=="\\"){w[1]=(w[1]||"").replace(/\\/g,"");g=n.find[v](w,a,c);if(g!=null){b=b.replace(n.match[v],"");break}}}}g||(g=a.getElementsByTagName("*"));return{set:g,
expr:b}};d.filter=function(b,a,c,g){for(var m=b,k=[],v=a,w,u,C=a&&a[0]&&d.isXML(a[0]);b&&a.length;){for(var D in n.filter)if((w=n.leftMatch[D].exec(b))!=null&&w[2]){var B=n.filter[D],z,A;A=w[1];u=false;w.splice(1,1);if(A.substr(A.length-1)!=="\\"){if(v===k)k=[];if(n.preFilter[D])if(w=n.preFilter[D](w,v,c,k,g,C)){if(w===true)continue}else u=z=true;if(w)for(var E=0;(A=v[E])!=null;E++)if(A){z=B(A,w,E,v);var F=g^!!z;if(c&&z!=null)if(F)u=true;else v[E]=false;else if(F){k.push(A);u=true}}if(z!==undefined){c||
(v=k);b=b.replace(n.match[D],"");if(!u)return[];break}}}if(b===m)if(u==null)d.error(b);else break;m=b}return v};d.error=function(b){throw"Syntax error, unrecognized expression: "+b;};var n=d.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,
POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(b){return b.getAttribute("href")}},relative:{"+":function(b,a){var c=typeof a==="string",g=c&&!/\W/.test(a);c=c&&!g;if(g)a=a.toLowerCase();g=0;for(var m=b.length,k;g<m;g++)if(k=b[g]){for(;(k=k.previousSibling)&&k.nodeType!==1;);b[g]=c||k&&k.nodeName.toLowerCase()===
a?k||false:k===a}c&&d.filter(a,b,true)},">":function(b,a){var c=typeof a==="string",g,m=0,k=b.length;if(c&&!/\W/.test(a))for(a=a.toLowerCase();m<k;m++){if(g=b[m]){c=g.parentNode;b[m]=c.nodeName.toLowerCase()===a?c:false}}else{for(;m<k;m++)if(g=b[m])b[m]=c?g.parentNode:g.parentNode===a;c&&d.filter(a,b,true)}},"":function(b,a,c){var g=t++,m=x,k;if(typeof a==="string"&&!/\W/.test(a)){k=a=a.toLowerCase();m=f}m("parentNode",a,g,b,k,c)},"~":function(b,a,c){var g=t++,m=x,k;if(typeof a==="string"&&!/\W/.test(a)){k=
a=a.toLowerCase();m=f}m("previousSibling",a,g,b,k,c)}},find:{ID:function(b,a,c){if(typeof a.getElementById!=="undefined"&&!c)return(b=a.getElementById(b[1]))?[b]:[]},NAME:function(b,a){if(typeof a.getElementsByName!=="undefined"){var c=[];a=a.getElementsByName(b[1]);for(var g=0,m=a.length;g<m;g++)a[g].getAttribute("name")===b[1]&&c.push(a[g]);return c.length===0?null:c}},TAG:function(b,a){return a.getElementsByTagName(b[1])}},preFilter:{CLASS:function(b,a,c,g,m,k){b=" "+b[1].replace(/\\/g,"")+" ";
if(k)return b;k=0;for(var v;(v=a[k])!=null;k++)if(v)if(m^(v.className&&(" "+v.className+" ").replace(/[\t\n]/g," ").indexOf(b)>=0))c||g.push(v);else if(c)a[k]=false;return false},ID:function(b){return b[1].replace(/\\/g,"")},TAG:function(b){return b[1].toLowerCase()},CHILD:function(b){if(b[1]==="nth"){var a=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(b[2]==="even"&&"2n"||b[2]==="odd"&&"2n+1"||!/\D/.test(b[2])&&"0n+"+b[2]||b[2]);b[2]=a[1]+(a[2]||1)-0;b[3]=a[3]-0}b[0]=t++;return b},ATTR:function(b,a,c,g,m,k){a=
b[1].replace(/\\/g,"");if(!k&&n.attrMap[a])b[1]=n.attrMap[a];if(b[2]==="~=")b[4]=" "+b[4]+" ";return b},PSEUDO:function(b,a,c,g,m){if(b[1]==="not")if((p.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=d(b[3],null,null,a);else{b=d.filter(b[3],a,c,true^m);c||g.push.apply(g,b);return false}else if(n.match.POS.test(b[0])||n.match.CHILD.test(b[0]))return true;return b},POS:function(b){b.unshift(true);return b}},filters:{enabled:function(b){return b.disabled===false&&b.type!=="hidden"},disabled:function(b){return b.disabled===
true},checked:function(b){return b.checked===true},selected:function(b){return b.selected===true},parent:function(b){return!!b.firstChild},empty:function(b){return!b.firstChild},has:function(b,a,c){return!!d(c[3],b).length},header:function(b){return/h\d/i.test(b.nodeName)},text:function(b){return"text"===b.type},radio:function(b){return"radio"===b.type},checkbox:function(b){return"checkbox"===b.type},file:function(b){return"file"===b.type},password:function(b){return"password"===b.type},submit:function(b){return"submit"===
b.type},image:function(b){return"image"===b.type},reset:function(b){return"reset"===b.type},button:function(b){return"button"===b.type||b.nodeName.toLowerCase()==="button"},input:function(b){return/input|select|textarea|button/i.test(b.nodeName)}},setFilters:{first:function(b,a){return a===0},last:function(b,a,c,g){return a===g.length-1},even:function(b,a){return a%2===0},odd:function(b,a){return a%2===1},lt:function(b,a,c){return a<c[3]-0},gt:function(b,a,c){return a>c[3]-0},nth:function(b,a,c){return c[3]-
0===a},eq:function(b,a,c){return c[3]-0===a}},filter:{PSEUDO:function(b,a,c,g){var m=a[1],k=n.filters[m];if(k)return k(b,c,a,g);else if(m==="contains")return(b.textContent||b.innerText||d.getText([b])||"").indexOf(a[3])>=0;else if(m==="not"){a=a[3];c=0;for(g=a.length;c<g;c++)if(a[c]===b)return false;return true}else d.error("Syntax error, unrecognized expression: "+m)},CHILD:function(b,a){var c=a[1],g=b;switch(c){case "only":case "first":for(;g=g.previousSibling;)if(g.nodeType===1)return false;if(c===
"first")return true;g=b;case "last":for(;g=g.nextSibling;)if(g.nodeType===1)return false;return true;case "nth":c=a[2];var m=a[3];if(c===1&&m===0)return true;a=a[0];var k=b.parentNode;if(k&&(k.sizcache!==a||!b.nodeIndex)){var v=0;for(g=k.firstChild;g;g=g.nextSibling)if(g.nodeType===1)g.nodeIndex=++v;k.sizcache=a}b=b.nodeIndex-m;return c===0?b===0:b%c===0&&b/c>=0}},ID:function(b,a){return b.nodeType===1&&b.getAttribute("id")===a},TAG:function(b,a){return a==="*"&&b.nodeType===1||b.nodeName.toLowerCase()===
a},CLASS:function(b,a){return(" "+(b.className||b.getAttribute("class"))+" ").indexOf(a)>-1},ATTR:function(b,a){var c=a[1];b=n.attrHandle[c]?n.attrHandle[c](b):b[c]!=null?b[c]:b.getAttribute(c);c=b+"";var g=a[2];a=a[4];return b==null?g==="!=":g==="="?c===a:g==="*="?c.indexOf(a)>=0:g==="~="?(" "+c+" ").indexOf(a)>=0:!a?c&&b!==false:g==="!="?c!==a:g==="^="?c.indexOf(a)===0:g==="$="?c.substr(c.length-a.length)===a:g==="|="?c===a||c.substr(0,a.length+1)===a+"-":false},POS:function(b,a,c,g){var m=n.setFilters[a[2]];
if(m)return m(b,c,a,g)}}},j=n.match.POS,e=function(b,a){return"\\"+(a-0+1)};for(var i in n.match){n.match[i]=new RegExp(n.match[i].source+/(?![^\[]*\])(?![^\(]*\))/.source);n.leftMatch[i]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[i].source.replace(/\\(\d+)/g,e))}var o=function(b,a){b=Array.prototype.slice.call(b,0);if(a){a.push.apply(a,b);return a}return b};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(s){o=function(b,a){a=a||[];var c=0;if(r.call(b)==="[object Array]")Array.prototype.push.apply(a,
b);else if(typeof b.length==="number")for(var g=b.length;c<g;c++)a.push(b[c]);else for(;b[c];c++)a.push(b[c]);return a}}var y;if(document.documentElement.compareDocumentPosition)y=function(b,a){if(!b.compareDocumentPosition||!a.compareDocumentPosition){if(b==a)h=true;return b.compareDocumentPosition?-1:1}b=b.compareDocumentPosition(a)&4?-1:b===a?0:1;if(b===0)h=true;return b};else if("sourceIndex"in document.documentElement)y=function(b,a){if(!b.sourceIndex||!a.sourceIndex){if(b==a)h=true;return b.sourceIndex?
-1:1}b=b.sourceIndex-a.sourceIndex;if(b===0)h=true;return b};else if(document.createRange)y=function(b,a){if(!b.ownerDocument||!a.ownerDocument){if(b==a)h=true;return b.ownerDocument?-1:1}var c=b.ownerDocument.createRange(),g=a.ownerDocument.createRange();c.setStart(b,0);c.setEnd(b,0);g.setStart(a,0);g.setEnd(a,0);b=c.compareBoundaryPoints(Range.START_TO_END,g);if(b===0)h=true;return b};d.getText=function(b){for(var a="",c,g=0;b[g];g++){c=b[g];if(c.nodeType===3||c.nodeType===4)a+=c.nodeValue;else if(c.nodeType!==
8)a+=d.getText(c.childNodes)}return a};(function(){var b=document.createElement("div"),a="script"+(new Date).getTime();b.innerHTML="<a name='"+a+"'/>";var c=document.documentElement;c.insertBefore(b,c.firstChild);if(document.getElementById(a)){n.find.ID=function(g,m,k){if(typeof m.getElementById!=="undefined"&&!k)return(m=m.getElementById(g[1]))?m.id===g[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===g[1]?[m]:undefined:[]};n.filter.ID=function(g,m){var k=typeof g.getAttributeNode!==
"undefined"&&g.getAttributeNode("id");return g.nodeType===1&&k&&k.nodeValue===m}}c.removeChild(b);c=b=null})();(function(){var b=document.createElement("div");b.appendChild(document.createComment(""));if(b.getElementsByTagName("*").length>0)n.find.TAG=function(a,c){c=c.getElementsByTagName(a[1]);if(a[1]==="*"){a=[];for(var g=0;c[g];g++)c[g].nodeType===1&&a.push(c[g]);c=a}return c};b.innerHTML="<a href='#'></a>";if(b.firstChild&&typeof b.firstChild.getAttribute!=="undefined"&&b.firstChild.getAttribute("href")!==
"#")n.attrHandle.href=function(a){return a.getAttribute("href",2)};b=null})();document.querySelectorAll&&function(){var b=d,a=document.createElement("div");a.innerHTML="<p class='TEST'></p>";if(!(a.querySelectorAll&&a.querySelectorAll(".TEST").length===0)){d=function(g,m,k,v){m=m||document;if(!v&&m.nodeType===9&&!d.isXML(m))try{return o(m.querySelectorAll(g),k)}catch(w){}return b(g,m,k,v)};for(var c in b)d[c]=b[c];a=null}}();(function(){var b=document.createElement("div");b.innerHTML="<div class='test e'></div><div class='test'></div>";
if(!(!b.getElementsByClassName||b.getElementsByClassName("e").length===0)){b.lastChild.className="e";if(b.getElementsByClassName("e").length!==1){n.order.splice(1,0,"CLASS");n.find.CLASS=function(a,c,g){if(typeof c.getElementsByClassName!=="undefined"&&!g)return c.getElementsByClassName(a[1])};b=null}}})();d.contains=document.compareDocumentPosition?function(b,a){return!!(b.compareDocumentPosition(a)&16)}:function(b,a){return b!==a&&(b.contains?b.contains(a):true)};d.isXML=function(b){return(b=(b?
b.ownerDocument||b:0).documentElement)?b.nodeName!=="HTML":false};var q=function(b,a){var c=[],g="",m;for(a=a.nodeType?[a]:a;m=n.match.PSEUDO.exec(b);){g+=m[0];b=b.replace(n.match.PSEUDO,"")}b=n.relative[b]?b+"*":b;m=0;for(var k=a.length;m<k;m++)d(b,a[m],c);return d.filter(g,c)};KISSY.ExternalSelector=d;KISSY.ExternalSelector._filter=function(b,a){return d.matches(a,KISSY.query(b))}})();
KISSY.add("anim-easing",function(f){var x=Math,p=x.PI,t=x.pow,r=x.sin,h=1.70158,l={easeNone:function(d){return d},easeIn:function(d){return d*d},easeOut:function(d){return(2-d)*d},easeBoth:function(d){return(d*=2)<1?0.5*d*d:0.5*(1- --d*(d-2))},easeInStrong:function(d){return d*d*d*d},easeOutStrong:function(d){return 1- --d*d*d*d},easeBothStrong:function(d){return(d*=2)<1?0.5*d*d*d*d:0.5*(2-(d-=2)*d*d*d)},elasticIn:function(d){if(d===0||d===1)return d;return-(t(2,10*(d-=1))*r((d-0.075)*2*p/0.3))},
elasticOut:function(d){if(d===0||d===1)return d;return t(2,-10*d)*r((d-0.075)*2*p/0.3)+1},elasticBoth:function(d){if(d===0||(d*=2)===2)return d;if(d<1)return-0.5*t(2,10*(d-=1))*r((d-0.1125)*2*p/0.45);return t(2,-10*(d-=1))*r((d-0.1125)*2*p/0.45)*0.5+1},backIn:function(d){if(d===1)d-=0.0010;return d*d*((h+1)*d-h)},backOut:function(d){return(d-=1)*d*((h+1)*d+h)+1},backBoth:function(d){if((d*=2)<1)return 0.5*d*d*(((h*=1.525)+1)*d-h);return 0.5*((d-=2)*d*(((h*=1.525)+1)*d+h)+2)},bounceIn:function(d){return 1-
l.bounceOut(1-d)},bounceOut:function(d){return d<1/2.75?7.5625*d*d:d<2/2.75?7.5625*(d-=1.5/2.75)*d+0.75:d<2.5/2.75?7.5625*(d-=2.25/2.75)*d+0.9375:7.5625*(d-=2.625/2.75)*d+0.984375},bounceBoth:function(d){if(d<0.5)return l.bounceIn(d*2)*0.5;return l.bounceOut(d*2-1)*0.5+0.5}};f.Easing=l});
KISSY.add("anim",function(f,x){function p(q,b,a,c,g){if(q=f.get(q)){if(!(this instanceof p))return new p(q,b,a,c,g);var m=f.isPlainObject(a);b=b;this.domEl=q;if(f.isPlainObject(b))b=f.param(b,";").replace(/=/g,":");this.props=t(b);this.targetStyle=b;if(m)q=f.merge(y,a);else{q=f.clone(y);a&&(q.duration=e(a,10)||1);f.isString(c)&&(c=j[c]);f.isFunction(c)&&(q.easing=c);f.isFunction(g)&&(q.complete=g)}this.config=q;f.isFunction(g)&&this.on(s,g)}}function t(q){var b={},a=o.length,c;i.innerHTML='<div style="'+
q+'"></div>';for(q=i.firstChild.style;a--;)if(c=q[o[a]])b[o[a]]=r(c);return b}function r(q){var b=e(q);q=(q+"").replace(/^[-\d\.]+/,"");return isNaN(b)?{v:q,u:"",f:l}:{v:b,u:q,f:h}}function h(q,b,a){return(q+(b-q)*a).toFixed(3)}function l(q,b,a){for(var c=2,g,m,k=[],v=[];g=3,m=arguments[c-1],c--;)if(d(m,0,4)==="rgb(")for(m=m.match(/\d+/g);g--;)k.push(~~m[g]);else if(d(m,0)==="#"){if(m.length===4)m="#"+d(m,1)+d(m,1)+d(m,2)+d(m,2)+d(m,3)+d(m,3);for(;g--;)k.push(parseInt(d(m,1+g*2,2),16))}else return b;
for(;g--;){c=~~(k[g+3]+(k[g]-k[g+3])*a);v.push(c<0?0:c>255?255:c)}return"rgb("+v.join(",")+")"}function d(q,b,a){return q.substr(b,a||1)}var n=f.DOM,j=f.Easing,e=parseFloat,i=n.create("<div>"),o="backgroundColor borderBottomColor borderBottomWidth borderBottomStyle borderLeftColor borderLeftWidth borderLeftStyle borderRightColor borderRightWidth borderRightStyle borderSpacing borderTopColor borderTopWidth borderTopStyle bottom color font fontFamily fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex".split(" "),
s="complete",y={duration:1,easing:j.easeNone};f.augment(p,f.EventTarget,{run:function(){var q=this,b=q.config,a=q.domEl,c=b.duration*1E3,g=b.easing,m=f.now(),k=m+c,v=q.props,w={},u;for(u in v)w[u]=r(n.css(a,u));if(q.fire("start")!==false){q.stop();q.timer=f.later(b=function(){var C=f.now(),D=C>k?1:(C-m)/c,B,z,A;for(u in v){B=w[u];z=v[u];if(z.v==0)z.u=B.u;if(B.u!==z.u)B.v=0;n.css(a,u,z.f(B.v,z.v,g(D))+z.u)}if(q.fire("step")===false||(A=C>k)){q.stop();A&&q.fire(s)}},13,true);b();return q}},stop:function(q){var b=
this.domEl,a=this.targetStyle;if(this.timer){this.timer.cancel();this.timer=x}if(q){f.UA.ie&&a.indexOf("opacity")>-1&&n.css(b,"opacity",this.props.opacity.v);b.style.cssText+=";"+a;this.fire(s)}return this}});f.Anim=p});KISSY.add("anim-node-plugin",function(f,x){var p=f.Anim;f.each([f.Node.prototype,f.NodeList.prototype],function(t){t.animate=function(){var r=f.makeArray(arguments);f.each(this,function(h){p.apply(x,[h].concat(r)).run()});return this}})});
KISSY.add("datalazyload",function(f,x){function p(e,i){if(!(this instanceof p))return new p(e,i);if(i===x){i=e;e=[l]}f.isArray(e)||(e=[f.get(e)||l]);this.containers=e;this.config=f.merge(j,i);this._init()}var t=f.DOM,r=f.Event,h=window,l=document,d="scroll",n="resize",j={mod:"manual",diff:"default",placeholder:"none"};f.augment(p,{_init:function(){this.threshold=this._getThreshold();this._filterItems();this._getItemsLength()&&this._initLoadEvent()},_filterItems:function(){var e=this.containers,i,
o,s,y=[],q=[];i=0;for(o=e.length;i<o;++i){s=f.query("img",e[i]);y=y.concat(f.filter(s,this._filterImg,this));s=f.query("textarea",e[i]);q=q.concat(f.filter(s,this._filterArea,this))}this.images=y;this.areas=q},_filterImg:function(e){var i=e.getAttribute("data-ks-lazyload"),o=this.threshold,s=this.config.placeholder;if(this.config.mod==="manual"){if(i){if(s!=="none")e.src=s;return true}}else if(t.offset(e).top>o&&!i){t.attr(e,"data-ks-lazyload",e.src);if(s!=="none")e.src=s;else e.removeAttribute("src");
return true}},_filterArea:function(e){return t.hasClass(e,"ks-datalazyload")},_initLoadEvent:function(){function e(){o||(o=setTimeout(function(){i();o=null},100))}function i(){s._loadItems();if(s._getItemsLength()===0){r.remove(h,d,e);r.remove(h,n,e)}}var o,s=this;r.on(h,d,e);r.on(h,n,function(){s.threshold=s._getThreshold();e()});s._getItemsLength()&&f.ready(function(){i()})},_loadItems:function(){this._loadImgs();this._loadAreas()},_loadImgs:function(){this.images=f.filter(this.images,this._loadImg,
this)},_loadImg:function(e){var i=this.threshold+t.scrollTop();if(t.offset(e).top<=i)this._loadImgSrc(e);else return true},_loadImgSrc:function(e,i){i=i||"data-ks-lazyload";var o=e.getAttribute(i);if(o&&e.src!=o){e.src=o;e.removeAttribute(i)}},_loadAreas:function(){this.areas=f.filter(this.areas,this._loadArea,this)},_loadArea:function(e){var i=t.css(e,"display")==="none";if(t.offset(i?e.parentNode:e).top<=this.threshold+t.scrollTop())this._loadAreaData(e.parentNode,e);else return true},_loadAreaData:function(e,
i){i.style.display="none";i.className="";var o=t.create("<div>");e.insertBefore(o,i);t.html(o,i.value,true)},_getThreshold:function(){var e=this.config.diff,i=t.viewportHeight();return e==="default"?2*i:i+e},_getItemsLength:function(){return this.images.length+this.areas.length},loadCustomLazyData:function(e,i){var o=this,s,y;f.isArray(e)||(e=[f.get(e)]);f.each(e,function(q){switch(i){case "img-src":y=q.nodeName==="IMG"?[q]:f.query("img",q);f.each(y,function(b){o._loadImgSrc(b,"data-ks-lazyload-custom")});
break;default:(s=f.get("textarea",q))&&t.hasClass(s,"ks-datalazyload-custom")&&o._loadAreaData(q,s)}})}});f.mix(p,p.prototype,true,["loadCustomLazyData","_loadImgSrc","_loadAreaData"]);f.DataLazyload=p});
KISSY.add("flash-ua",function(f){function x(){var j;if(navigator.plugins&&navigator.mimeTypes.length)j=(navigator.plugins["Shockwave Flash"]||0).description;else if(window.ActiveXObject)try{j=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(e){}if(j)return p(j)}function p(j){return j.match(/(\d)+/g)}function t(j){var e=f.isString(j)?p(j):j;j=j;if(f.isArray(e))j=parseFloat(e[0]+"."+r(e[1],3)+r(e[2],5));return j||0}function r(j,e){for(var i=(j+"").length;i++<e;)j="0"+
j;return j}var h=f.UA,l,d,n=true;h.fpv=function(j){if(j||n){n=false;l=x();d=t(l)}return l};h.fpvGEQ=function(j,e){n&&h.fpv(e);return!!d&&d>=t(j)}});KISSY.add("flash",function(f){f.Flash={swfs:{length:0}}});
KISSY.add("flash-embed",function(f){function x(j,e,i){var o=t.create("<param>");t.attr(o,{name:e,value:i});j.appendChild(o)}var p=f.UA,t=f.DOM,r=f.Flash,h=/object|embed/i,l=encodeURIComponent,d={wmode:"",allowscriptaccess:"",allownetworking:"",allowfullscreen:"",play:"false",loop:"",menu:"",quality:"",scale:"",salign:"",bgcolor:"",devicefont:"",base:"",swliveconnect:"",seamlesstabbing:""},n={params:{},attrs:{width:215,height:138},version:9};f.mix(r,{fpv:p.fpv,fpvGEQ:p.fpvGEQ,len:function(){return r.swfs.length},
add:function(j,e,i){var o,s;e=r._normalize(e);e=f.merge(n,e);e.attrs=f.merge(n.attrs,e.attrs);if(j=f.get(j)){if(!j.id)j.id=f.guid("ks-flash-");s=e.attrs.id="#"+j.id;if(p.fpv()){if(!p.fpvGEQ(e.version)){this._callback(i,0,s,j);if(!((o=e.xi)&&f.isString(o)))return;e.src=o}if(h.test(j.nodeName))this._register(j,e,i);else e.src?this._embed(j,e,i):this._callback(i,-3,s,j)}else this._callback(i,-1,s,j)}else this._callback(i,-2)},get:function(j){return r.swfs[j]},remove:function(j){if(j=r.get(j)){t.remove(j);
delete r.swfs["#"+j.id];r.swfs.length-=1}},contains:function(j){var e=r.swfs,i,o=false;if(f.isString(j))o=j in e;else for(i in e)if(e[i]===j){o=true;break}return o},_register:function(j,e,i){e=e.attrs.id;r._addSWF(e,j);r._callback(i,1,e,j)},_embed:function(j,e,i){var o=r._createSWF(e.src,e.attrs,e.params);if(p.ie)j.outerHTML=o.outerHTML;else j.parentNode.replaceChild(o,j);r._register(j,e,i)},_callback:function(j,e,i,o){e&&f.isFunction(j)&&j({status:e,id:i,swf:o})},_addSWF:function(j,e){if(j&&e){r.swfs[j]=
e;r.swfs.length+=1}},_createSWF:function(j,e,i){var o=t.create("<object>"),s;t.attr(o,e);if(p.ie){t.attr(o,"classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");x(o,"movie",j)}else t.attr(o,{type:"application/x-shockwave-flash",data:j,name:e.id});for(s in i)s in d&&x(o,s,i[s]);i.flashvars&&x(o,"flashvars",r.toFlashVars(i.flashvars));return o},_normalize:function(j){var e,i,o,s=j;if(f.isPlainObject(j)){s={};for(o in j){e=o.toLowerCase();i=j[o];if(e!=="flashvars")i=r._normalize(i);s[e]=i}}return s},
toFlashVars:function(j){if(!f.isPlainObject(j))return"";var e,i,o=[];for(e in j){i=j[e];if(f.isString(i))i='"'+l(i)+'"';else{i=f.JSON.stringify(i);if(!i)continue;i=i.replace(/:"([^"]+)/g,function(s,y){return':"'+l(y)})}o.push(e+"="+i)}return o.join("&")}})});
KISSY.add("switchable",function(f,x){function p(h,l){l=l||{};if(!("markupType"in l))if(l.panelCls)l.markupType=1;else if(l.panels)l.markupType=2;l=f.merge(p.Config,l);this.container=f.get(h);this.config=l;this.activeIndex=l.activeIndex;this._init()}var t=f.DOM,r=f.Event;p.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,
activeTriggerCls:"ks-active",steps:1,viewSize:[]};p.Plugins=[];f.augment(p,f.EventTarget,{_init:function(){var h=this,l=h.config;if(h.fire("beforeInit")!==false){h._parseMarkup();l.hasTriggers&&h._bindTriggers();f.each(p.Plugins,function(d){d.init&&d.init(h)});h.fire("init")}},_parseMarkup:function(){var h=this.container,l=this.config,d,n=[],j=[];switch(l.markupType){case 0:if(d=f.get("."+l.navCls,h))n=t.children(d);d=f.get("."+l.contentCls,h);j=t.children(d);break;case 1:n=f.query("."+l.triggerCls,
h);j=f.query("."+l.panelCls,h);break;case 2:n=l.triggers;j=l.panels;break}h=j.length;this.length=h/l.steps;if(l.hasTriggers&&h>0&&n.length===0)n=this._generateTriggersMarkup(this.length);this.triggers=f.makeArray(n);this.panels=f.makeArray(j);this.content=d||j[0].parentNode},_generateTriggersMarkup:function(h){var l=this.config,d=t.create("<ul>"),n,j;d.className=l.navCls;for(j=0;j<h;j++){n=t.create("<li>");if(j===this.activeIndex)n.className=l.activeTriggerCls;n.innerHTML=j+1;d.appendChild(n)}this.container.appendChild(d);
return t.children(d)},_bindTriggers:function(){var h=this,l=h.config,d=h.triggers,n,j,e=d.length;for(j=0;j<e;j++)(function(i){n=d[i];r.on(n,"click focus",function(){h._onFocusTrigger(i)});if(l.triggerType==="mouse"){r.on(n,"mouseenter",function(){h._onMouseEnterTrigger(i)});r.on(n,"mouseleave",function(){h._onMouseLeaveTrigger(i)})}})(j)},_onFocusTrigger:function(h){if(this._triggerIsValid()){this._cancelSwitchTimer();this.switchTo(h)}},_onMouseEnterTrigger:function(h){var l=this;if(l._triggerIsValid())l.switchTimer=
f.later(function(){l.switchTo(h)},l.config.delay*1E3)},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(h){return this.activeIndex!==h},_cancelSwitchTimer:function(){if(this.switchTimer){this.switchTimer.cancel();this.switchTimer=x}},switchTo:function(h,l){var d=this.config,n=this.triggers,j=this.panels,e=this.activeIndex,i=d.steps,o=e*i,s=h*i;if(!this._triggerIsValid())return this;if(this.fire("beforeSwitch",{toIndex:h})===false)return this;if(d.hasTriggers)this._switchTrigger(e>
-1?n[e]:null,n[h]);if(l===x)l=h>e?"forward":"backward";this._switchView(j.slice(o,o+i),j.slice(s,s+i),h,l);this.activeIndex=h;return this},_switchTrigger:function(h,l){var d=this.config.activeTriggerCls;h&&t.removeClass(h,d);t.addClass(l,d)},_switchView:function(h,l,d){t.css(h,"display","none");t.css(l,"display","block");this._fireOnSwitch(d)},_fireOnSwitch:function(h){this.fire("switch",{currentIndex:h})},prev:function(){var h=this.activeIndex;this.switchTo(h>0?h-1:this.length-1,"backward")},next:function(){var h=
this.activeIndex;this.switchTo(h<this.length-1?h+1:0,"forward")}});f.Switchable=p});
KISSY.add("switchable-autoplay",function(f,x){var p=f.Event,t=f.Switchable;f.mix(t.Config,{autoplay:false,interval:5,pauseOnHover:true});t.Plugins.push({name:"autoplay",init:function(r){function h(){n=f.later(function(){r.paused||r.switchTo(r.activeIndex<r.length-1?r.activeIndex+1:0,"forward")},d,true)}var l=r.config,d=l.interval*1E3,n;if(l.autoplay){if(l.pauseOnHover){p.on(r.container,"mouseenter",function(){if(n){n.cancel();n=x}r.paused=true});p.on(r.container,"mouseleave",function(){r.paused=false;
h()})}h()}}})});
KISSY.add("switchable-effect",function(f,x){var p=f.DOM,t=f.Anim,r=f.Switchable,h;f.mix(r.Config,{effect:"none",duration:0.5,easing:"easeNone"});r.Effects={none:function(l,d,n){p.css(l,"display","none");p.css(d,"display","block");n()},fade:function(l,d,n){l.length!==1&&f.error("fade effect only supports steps == 1.");var j=this,e=j.config,i=l[0],o=d[0];j.anim&&j.anim.stop(true);p.css(o,"opacity",1);j.anim=(new t(i,{opacity:0},e.duration,e.easing,function(){j.anim=x;p.css(o,"z-index",9);p.css(i,"z-index",
1);n()})).run()},scroll:function(l,d,n,j){var e=this;l=e.config;d=l.effect==="scrollx";var i={};i[d?"left":"top"]=-(e.viewSize[d?0:1]*j)+"px";e.anim&&e.anim.stop();e.anim=(new t(e.content,i,l.duration,l.easing,function(){e.anim=x;n()})).run()}};h=r.Effects;h.scrollx=h.scrolly=h.scroll;r.Plugins.push({name:"effect",init:function(l){var d=l.config,n=d.effect,j=l.panels,e=l.content,i=d.steps,o=l.activeIndex,s=j.length;l.viewSize=[d.viewSize[0]||j[0].offsetWidth*i,d.viewSize[1]||j[0].offsetHeight*i];
if(n!=="none"){f.each(j,function(a){p.css(a,"display","block")});switch(n){case "scrollx":case "scrolly":p.css(e,"position","absolute");p.css(e.parentNode,"position","relative");if(n==="scrollx"){p.css(j,"float","left");p.width(e,l.viewSize[0]*(s/i))}break;case "fade":var y=o*i,q=y+i-1,b;f.each(j,function(a,c){b=c>=y&&c<=q;p.css(a,{opacity:b?1:0,position:"absolute",zIndex:b?9:1})});break}}}});f.augment(r,{_switchView:function(l,d,n,j){var e=this,i=e.config.effect;(f.isFunction(i)?i:h[i]).call(e,l,
d,function(){e._fireOnSwitch(n)},n,j)}})});
KISSY.add("switchable-circular",function(f,x){function p(b,a,c,g,m){var k=this;b=k.config;a=k.length;var v=k.activeIndex,w=b.scrollType===y,u=w?n:j,C=k.viewSize[w?0:1];w=-C*g;var D={},B,z=m===s;if(B=z&&v===0&&g===a-1||m===o&&v===a-1&&g===0)w=t.call(k,k.panels,g,z,u,C);D[u]=w+i;k.anim&&k.anim.stop();k.anim=(new f.Anim(k.content,D,b.duration,b.easing,function(){B&&r.call(k,k.panels,g,z,u,C);k.anim=x;c()})).run()}function t(b,a,c,g,m){var k=this.config.steps;a=this.length;var v=c?a-1:0,w=(v+1)*k;for(k=
v*k;k<w;k++){h.css(b[k],l,d);h.css(b[k],g,(c?-1:1)*m*a)}return c?m:-m*a}function r(b,a,c,g,m){var k=this.config.steps;a=this.length;var v=c?a-1:0,w=(v+1)*k;for(k=v*k;k<w;k++){h.css(b[k],l,e);h.css(b[k],g,e)}h.css(this.content,g,c?-m*(a-1):e)}var h=f.DOM,l="position",d="relative",n="left",j="top",e="",i="px",o="forward",s="backward",y="scrollx",q=f.Switchable;f.mix(q.Config,{circular:false});q.Plugins.push({name:"circular",init:function(b){b=b.config;if(b.circular&&(b.effect===y||b.effect==="scrolly")){b.scrollType=
b.effect;b.effect=p}}})});
KISSY.add("switchable-lazyload",function(f){var x=f.DOM,p="beforeSwitch",t="img-src",r="area-data",h={},l=f.Switchable;h[t]="data-ks-lazyload-custom";h[r]="ks-datalazyload-custom";f.mix(l.Config,{lazyDataType:r});l.Plugins.push({name:"lazyload",init:function(d){function n(y){var q=i.steps;y=y.toIndex*q;e.loadCustomLazyData(d.panels.slice(y,y+q),o);j()&&d.detach(p,n)}function j(){var y,q,b,a=o===t;if(y=a?"img":o===r?"textarea":""){y=f.query(y,d.container);q=0;for(b=y.length;q<b;q++)if(a?x.attr(y[q],
s):x.hasClass(y[q],s))return false}return true}var e=f.DataLazyload,i=d.config,o=i.lazyDataType,s=h[o];!e||!o||!s||d.on(p,n)}})});
KISSY.add("switchable-countdown",function(f,x){var p=f.DOM,t=f.Event,r=f.Anim,h=f.Switchable;f.mix(h.Config,{countdown:false,countdownFromStyle:"",countdownToStyle:"width: 0"});h.Plugins.push({name:"countdown",init:function(l){function d(){n();y=(new r(i[l.activeIndex],s,e-0.5)).run()}function n(){if(y){y.stop();y=x}}var j=l.config,e=j.interval,i=[],o=j.countdownFromStyle,s=j.countdownToStyle,y;if(!(!j.autoplay||!j.hasTriggers||!j.countdown)){f.each(l.triggers,function(q,b){q.innerHTML='<div class="ks-switchable-trigger-mask"></div><div class="ks-switchable-trigger-content">'+
q.innerHTML+"</div>";i[b]=q.firstChild});if(j.pauseOnHover){t.on(l.container,"mouseenter",function(){n();var q=i[l.activeIndex];if(o)y=(new r(q,o,0.2,"easeOut")).run();else p.removeAttr(q,"style")});t.on(l.container,"mouseleave",function(){n();p.removeAttr(i[l.activeIndex],"style");setTimeout(d,200)})}l.on("beforeSwitch",function(){n();p.removeAttr(i[l.activeIndex],"style")});l.on("switch",function(){l.paused||d()});d(l.activeIndex)}}})});
KISSY.add("switchable-autorender",function(f){f.Switchable.autoRender=function(x,p,t){p="."+(p||"KS_");t=t||"data-ks-switchable";f.each(["Switchable","Tabs","Slide","Carousel","Accordion"],function(r){f.each(f.query(p+r,x),function(h){try{var l=h.getAttribute(t);if(l)l=l.replace(/'/g,'"');new f[r](h,f.JSON.parse(l))}catch(d){f.log("Switchable.autoRender: "+d,"warn")}})})}});
KISSY.add("tabs",function(f){function x(p,t){if(!(this instanceof x))return new x(p,t);x.superclass.constructor.call(this,p,t)}f.extend(x,f.Switchable);f.Tabs=x});KISSY.add("slide",function(f){function x(t,r){if(!(this instanceof x))return new x(t,r);x.superclass.constructor.call(this,t,f.merge(p,r))}var p={autoplay:true,circular:true};f.extend(x,f.Switchable);f.Slide=x});
KISSY.add("carousel",function(f,x){function p(e,i){var o=this;if(!(o instanceof p))return new p(e,i);o.on("init",function(){t(o)});p.superclass.constructor.call(o,e,f.merge(j,i))}function t(e){var i=e.config,o=i.disableBtnCls;f.each(["prev","next"],function(s){var y=e[s+"Btn"]=f.get(l+i[s+"BtnCls"],e.container);h.on(y,"click",function(q){q.preventDefault();r.hasClass(y,o)||e[s]()})});i.circular||e.on("switch",function(s){s=s.currentIndex;s=s===0?e[d]:s===e.length-1?e[n]:x;r.removeClass([e[d],e[n]],
o);s&&r.addClass(s,o)});h.on(e.panels,"click focus",function(){e.fire("itemSelected",{item:this})})}var r=f.DOM,h=f.Event,l=".",d="prevBtn",n="nextBtn",j={circular:true,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};f.extend(p,f.Switchable);f.Carousel=p});
KISSY.add("accordion",function(f){function x(r,h){if(!(this instanceof x))return new x(r,h);x.superclass.constructor.call(this,r,f.merge(t,h))}var p=f.DOM,t={markupType:1,triggerType:"click",multiple:false};f.extend(x,f.Switchable);f.Accordion=x;f.augment(x,{_triggerIsValid:function(r){return this.activeIndex!==r||this.config.multiple},_switchView:function(r,h,l){var d=this.config,n=h[0];if(d.multiple){p.toggleClass(this.triggers[l],d.activeTriggerCls);p.css(n,"display",n.style.display=="none"?"block":
"none");this._fireOnSwitch(l)}else x.superclass._switchView.call(this,r,h,l)}})});
KISSY.add("suggest",function(f,x){function p(a,c,g){if(!(this instanceof p))return new p(a,c,g);this.textInput=f.get(a);c+=c.indexOf("?")===-1?"?":"&";this.dataSource=c+"code=utf-8&callback="+o;this.config=f.merge(b,g);this.queryParams=this.query=s;this._dataCache={};this._init()}function t(a){a.style.visibility=s}function r(a){a.style.visibility=y}var h=f.DOM,l=f.Event,d=window,n=document,j,e=f.get("head"),i=f.UA.ie,o="g_ks_suggest_callback",s="",y="hidden",q=parseInt,b={containerCls:s,resultFormat:"\u7ea6%result%\u6761\u7ed3\u679c",
closeBtnText:"\u5173\u95ed",shim:i===6,submitOnSelect:true};f.augment(p,f.EventTarget,{_init:function(){j=n.body;this._initTextInput();this._initContainer();this.config.shim&&this._initShim();this._initStyle();this._initEvent()},_initTextInput:function(){var a=this,c=a.textInput,g=false,m=0;h.attr(c,"autocomplete","off");a.config.autoFocus&&c.focus();l.on(c,"keydown",function(k){k=k.keyCode;if(k===27){a.hide();c.value=a.query}else if(k>32&&k<41)if(c.value){if(k===40||k===38)if(m++===0){a._isRunning&&
a.stop();g=true;a._selectItem(k===40)}else if(m==3)m=0}else c.blur();else if(k===13){c.blur();if(g)if(c.value==a._getSelectedItemKey())if(a.fire("itemSelect")===false)return;a._submitForm()}else{a._isRunning||a.start();g=false}});l.on(c,"keyup",function(){m=0});l.on(c,"blur",function(){a.stop();f.later(function(){a._focusing||a.hide()},0)})},_initContainer:function(){var a=h.create("<div>",{"class":"ks-suggest-container "+this.config.containerCls,style:"position: absolute; visibility: hidden"}),c=
h.create("<div>",{"class":"ks-suggest-content"}),g=h.create("<div>",{"class":"ks-suggest-footer"});a.appendChild(c);a.appendChild(g);j.insertBefore(a,j.firstChild);this.container=a;this.content=c;this.footer=g;this._setContainerRegion();this._initContainerEvent()},_setContainerRegion:function(){var a=this.textInput,c=h.offset(a),g=this.container;h.offset(g,{left:c.left,top:c.top+a.offsetHeight-1});h.width(g,this.config.containerWidth||a.offsetWidth-2)},_initContainerEvent:function(){var a=this,c=
a.textInput,g=a.container,m=a.content,k=a.footer,v,w;l.on(m,"mousemove",function(u){u=u.target;if(u.nodeName!=="LI")u=h.parent(u,"li");if(h.contains(m,u))if(u!==a.selectedItem){a._removeSelectedItem();a._setSelectedItem(u)}});l.on(m,"mousedown",function(u){u=u.target;if(u.nodeName!=="LI")u=h.parent(u,"li");v=u});l.on(g,"mousedown",function(u){if(u.target.nodeName!=="INPUT"){c.onbeforedeactivate=function(){d.event.returnValue=false;c.onbeforedeactivate=null};u.preventDefault()}});l.on(m,"mouseup",
function(u){u=u.target;if(h.parent(u,".ks-suggest-content")){if(u.nodeName!=="LI")u=h.parent(u,"li");if(u==v)if(h.contains(m,u)){a._updateInputFromSelectItem(u);if(a.fire("itemSelect")!==false){c.blur();a._submitForm()}}}});l.on(k,"focusin",function(){a._focusing=true;a._removeSelectedItem();w=false});l.on(k,"focusout",function(){a._focusing=false;f.later(function(){if(w)a.hide();else a._focusing||a.textInput.focus()},0)});l.on(a.container,"mouseleave",function(){w=true});l.on(k,"click",function(u){h.hasClass(u.target,
"ks-suggest-closebtn")&&a.hide()})},_submitForm:function(){if(this.config.submitOnSelect){var a=this.textInput.form;if(a)if(this.fire("beforeSubmit",{form:a})!==false){if(n.createEvent){var c=n.createEvent("MouseEvents");c.initEvent("submit",true,false);a.dispatchEvent(c)}else n.createEventObject&&a.fireEvent("onsubmit");a.submit()}}},_initShim:function(){var a=h.create("<iframe>",{src:"about:blank","class":"ks-suggest-shim",style:"position:absolute;visibility:hidden;border:none"});this.container.shim=
a;this._setShimRegion();j.insertBefore(a,j.firstChild)},_setShimRegion:function(){var a=this.container.style,c=this.container.shim;c&&h.css(c,{left:q(a.left)-2,top:a.top,width:q(a.width)+2})},_initStyle:function(){f.get("#ks-suggest-style")||h.addStyleSheet(".ks-suggest-container{background:white;border:1px solid #999;z-index:99999}.ks-suggest-shim{z-index:99998}.ks-suggest-container li{color:#404040;padding:1px 0 2px;font-size:12px;line-height:18px;float:left;width:100%}.ks-suggest-container .ks-selected{background-color:#39F;cursor:default}.ks-suggest-key{float:left;text-align:left;padding-left:5px}.ks-suggest-result{float:right;text-align:right;padding-right:5px;color:green}.ks-suggest-container .ks-selected span{color:#FFF;cursor:default}.ks-suggest-footer{padding:0 5px 5px}.ks-suggest-closebtn{float:right}.ks-suggest-container li,.ks-suggest-footer{overflow:hidden;zoom:1;clear:both}.ks-suggest-container{*margin-left:2px;_margin-left:-2px;_margin-top:-3px}",
"ks-suggest-style")},_initEvent:function(){var a=this;l.on(d,"resize",function(){a._setContainerRegion();a._setShimRegion()})},start:function(){var a=this;if(a.fire("beforeStart")!==false){p.focusInstance=a;a._timer=f.later(function(){a._updateContent();a._timer=f.later(arguments.callee,200)},200);a._isRunning=true}},stop:function(){p.focusInstance=x;this._timer&&this._timer.cancel();this._isRunning=false},show:function(){if(!this.isVisible()){var a=this.container,c=a.shim;t(a);if(c){c.style.height||
h.height(c,a.offsetHeight-2);t(c)}}},hide:function(){if(this.isVisible()){var a=this.container,c=a.shim;c&&r(c);r(a)}},isVisible:function(){return this.container.style.visibility!=y},_updateContent:function(){var a=this.textInput;if(a.value!=this.query){a=this.query=a.value;if(f.trim(a))if(this._dataCache[a]!==x){this._fillContent(this._dataCache[a]);this._displayContainer()}else this._requestData();else{this._fillContent(s);this.hide()}}},_requestData:function(){var a=this,c;if(!i)a.dataScript=x;
if(!a.dataScript){c=n.createElement("script");c.charset="utf-8";c.async=true;e.insertBefore(c,e.firstChild);a.dataScript=c;if(!i){var g=f.now();a._latestScriptTime=g;h.attr(c,"data-time",g);l.on(c,"load",function(){a._scriptDataIsOut=h.attr(c,"data-time")!=a._latestScriptTime})}}a.queryParams="q="+encodeURIComponent(a.query);if(a.fire("beforeDataRequest")!==false)a.dataScript.src=a.dataSource+"&"+a.queryParams},_handleResponse:function(a){var c=s,g,m,k,v;if(!this._scriptDataIsOut){this.returnedData=
a;if(this.fire("dataReturn",{data:a})!==false){a=this._formatData(this.returnedData);if((g=a.length)>0){m=h.create("<ol>");for(c=0;c<g;++c){k=a[c];k=this._formatItem(v=k.key,k.result);h.attr(k,"key",v);h.addClass(k,c%2?"ks-even":"ks-odd");m.appendChild(k)}c=m}this._fillContent(c);this._fillFooter();if(this.fire("beforeShow")!==false){this._dataCache[this.query]=c;this._displayContainer()}}}},_formatData:function(a){var c=[],g,m,k,v=0;if(!a)return c;if(f.isArray(a.result))a=a.result;if(!(g=a.length))return c;
for(k=0;k<g;++k){m=a[k];if(f.isString(m))c[v++]={key:m};else if(f.isArray(m)&&m.length>1)c[v++]={key:m[0],result:m[1]}}return c},_formatItem:function(a,c){var g=h.create("<li>"),m=h.create("<span>",{"class":"ks-suggest-key"});h.html(m,a);g.appendChild(m);if(c){a=this.config.resultFormat.replace("%result%",c);if(f.trim(a)){c=h.create("<span>",{"class":"ks-suggest-result"});h.html(c,a);g.appendChild(c)}}return g},_fillFooter:function(){var a=this.config,c=this.footer,g;if(a.closeBtn){g=h.create("<a>",
{"class":"ks-suggest-closebtn",href:"javascript: void(0)",target:"_self"});h.html(g,a.closeBtnText);c.appendChild(g)}this.fire("updateFooter")},_fillContent:function(a){var c=this.content;if(a.nodeType===1){h.html(c,s);c.appendChild(a)}else h.html(c,a);this.selectedItem=x},_displayContainer:function(){f.trim(h.html(this.container))?this.show():this.hide()},_selectItem:function(a){var c=f.query("li",this.container);if(c.length!==0)if(this.isVisible()){if(this.selectedItem){a=h[a?"next":"prev"](this.selectedItem);
if(!a)this.textInput.value=this.query}else a=c[a?0:c.length-1];this._removeSelectedItem();if(a){this._setSelectedItem(a);this._updateInputFromSelectItem()}}else this.show()},_removeSelectedItem:function(){h.removeClass(this.selectedItem,"ks-selected");this.selectedItem=x},_setSelectedItem:function(a){h.addClass(a,"ks-selected");this.selectedItem=a;this.textInput.focus()},_getSelectedItemKey:function(){if(!this.selectedItem)return s;return h.attr(this.selectedItem,"key")},_updateInputFromSelectItem:function(){this.textInput.value=
this._getSelectedItemKey(this.selectedItem)||this.query}});d[o]=function(a){p.focusInstance&&f.later(function(){p.focusInstance._handleResponse(a)},0)};p.version=1.1;f.Suggest=p});
