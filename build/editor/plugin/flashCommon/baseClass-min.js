/*
Copyright 2012, KISSY UI Library v1.30dev
MIT Licensed
build time: May 30 12:21
*/
KISSY.add("editor/plugin/flashCommon/baseClass",function(e,i,f,g,h,j){function a(){a.superclass.constructor.apply(this,arguments);this._init()}var k=e.Node;a.ATTRS={cls:{},type:{},label:{value:"在新窗口查看"},contextMenuHandlers:{}};e.extend(a,e.Base,{_init:function(){var c=this,b=c.get("cls"),d=c.get("editor"),a=c.get("contextMenuHandlers");f.register({editor:d,filter:"."+b,width:"120px",handlers:a});g.register({filter:function(c){return c.hasClass(b,void 0)&&c},editor:d,init:function(){var b=this,a=b.get("contentEl");
a.html(e.substitute(' <a class="ke-bubbleview-url" target="_blank" href="#">{label}</a>   |    <span class="ke-bubbleview-link ke-bubbleview-change">编辑</span>   |    <span class="ke-bubbleview-link ke-bubbleview-remove">删除</span>',{label:c.get("label")}));var f=a.one(".ke-bubbleview-url"),g=a.one(".ke-bubbleview-change"),h=a.one(".ke-bubbleview-remove");i.Utils.preventFocus(a);g.on("click",function(a){c.show(b.selectedEl);a.halt()});h.on("click",function(c){if(e.UA.webkit){var a=d.getSelection().getRanges();
if(a=a&&a[0])a.collapse(!0),a.select()}b.selectedEl.remove();b.hide();d.notifySelectionChange();c.halt()});b.on("show",function(){var a=b.selectedEl;a&&c._updateTip(f,a)})}});d.docReady(function(){d.get("document").on("dblclick",c._dbClick,c)})},_getFlashUrl:function(a){return j.getUrl(a)},_updateTip:function(a,b){var d=this.get("editor").restoreRealElement(b);d&&(d=this._getFlashUrl(d),a.attr("href",d))},_dbClick:function(a){var b=new k(a.target);"img"===b.nodeName()&&b.hasClass(this.get("cls"),
void 0)&&(this.show(b),a.halt())},show:function(a){var b=this.get("editor");h.useDialog(b,this.get("type")+"/dialog",a)}});return a},{requires:["editor","../contextmenu/","../bubbleview/","../dialogLoader/","./utils"]});
